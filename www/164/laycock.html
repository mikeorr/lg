<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="utf-8" xml:lang="utf-8">
<head>
<title>Building the GNOME Desktop from Source LG #164</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../lg.css" type="text/css" media="screen, projection"  />
<link rel="alternate" type="application/rss+xml" title="LG RSS" href="lg.rss" />
<link rel="alternate" type="application/rdf+xml" title="LG RDF" href="lg.rdf" />
<!-- link rel="alternate" type="application/atom+xml" title="LG Atom" href="lg.atom.xml" / -->
<link rel="shortcut icon" href="../favicon.ico" />

<style type="text/css" media="screen, projection">
<!--

-->
</style>

</head>
<body>

<a href="../">
<img src="../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
</a>
<p id="fun">...making Linux just a little more fun!</p>

<div id="navigation">
<table summary="masthead" width="100%">
<tr>
<td align="center" colspan="3" style="font-size: 10px; font-weight: bold">
<a href="../index.html">Home</a>
<a href="http://linuxgazette.net">Main Site</a>
<a href="../faq/index.html">FAQ</a>

<a href="../lg_index.html">Site Map</a>
<a href="../mirrors.html">Mirrors</a>
<a href="../mirrors.html">Translations</a>
<a href="../search.html">Search</a>
<a href="../archives.html">Archives</a>
<a href="../authors/index.html">Authors</a>
<a href="http://lists.linuxgazette.net/mailman/listinfo/">Mailing Lists</a>
<a href="../jobs.html">Join Us!</a>
<a href="../contact.html">Contact Us</a>

<hr width="99%" style="border: 1px inset #000033">
</td>
</tr>
<tr>
<td width="40%" align="left" style="font-size: 10px; font-weight: bold">
The Free International Online Linux Monthly
</td>
<td width="20%" align="center" style="font-size: 10px; font-weight: bold">
ISSN: 1934-371X
</td>
<td width="40%" align="right" style="font-size: 10px; font-weight: bold">
Main site: <a href="http://linuxgazette.net">http://linuxgazette.net</a> 
</td>
</table>
</div>


<div id="breadcrumbs1">

<a href="../index.html">Home</a> &gt; 
<a href="index.html">July 2009 (#164)</a> &gt; 
Article

</div>

<div class="articlecontent1">
<div class="content">

<div id="previousnexttop">
<A HREF="kachold.html" >&lt;-- prev</A> | <A HREF="prestia.html" >next --&gt;</A>
</div>

<h1>Building the GNOME Desktop from Source</h1>
<p id="by"><b>By <a href="../authors/laycock.html">Oscar Laycock</a></b></p>

<P>First, I must say that the <A HREF="http://www.gnome.org/">GNOME</A>
documentation &quot;strongly recommends&quot; against building from
source files. If you do, it suggests using the GARNOME scripted
system. Even GARNOME it says, is only for the &quot;brave and
patient&quot;. 
</P>
<P>I started building programs from source as I wanted to upgrade a
very old distribution and did not have enough disk space to install a
Fedora or Ubuntu. The memory on my old PC is probably a bit low too,
at 128 Meg Also, it is fun to run the latest versions, be on the
leading edge, and get ahead of the major distributions. You could not
run Windows Vista (tm) on my old PC! 
</P>
<P>I took the files from the latest GNOME release I could find, being
version 2.25. This was probably a mistake. I later found out that odd
numbered minor releases like 25 are development releases and may be
unstable. The stable 2.26 series should have come out in March. In
fact, when I built the file manager &quot;Nautilus&quot;, I could not
find a dependency, &quot;libunique&quot;, so I went back to version
2.24. The GNOME sources are at 
<A HREF="http://ftp.gnome.org/pub/gnome">http://ftp.gnome.org/pub/gnome</A>.
</P>
<P>I used the Beyond Linux from Scratch (BLFS) guide to know where to
find packages and in what order to build them. You can find it at
<A HREF="http://www.linuxfromscratch.org/">http://www.linuxfromscratch.org</A>
(LFS). Unfortunately the BLFS guide uses versions from the summer of
2007, GNOME version 2.18. Also, I installed the libraries and
programs in the default location /usr/local, but looking back it
would have been better to have put them in their own directory and
give a --prefix option to &quot;configure&quot;, as the BLFS project
recommends. 
</P>
<P>It took me about a month to build a basic GNOME desktop in my
spare time. Disappointingly, you don't see anything until the last
piece, &quot;gnome-session&quot;, is in place. 
</P>
<P>When I ran my first applications like the image-viewer
&quot;eye-of-gnome&quot;, some appeared on the desktop and then
core-dumped. The core file said the last function called was in GTK,
in the libgtk-x11 library. I had had to upgrade my GTK when building
gnome-panel. I had chosen the latest version 2.15.2. This is probably
a development releases too. When I switched back to my year-old GTK,
everything was fine. I finally settled for the stable version
recommended by GARNOME. It took me a few days to sort this out! 
</P>
<P>There is a free book on programming GNOME, &quot;GTK+ / Gnome
Application Development&quot; by Havoc Pennington available at
<A HREF="http://developer.gnome.org/doc/GGAD">http://developer.gnome.org/doc/GGAD</A>.
This is somewhat old. 
</P>
<P>Overall, I like GNOME because it is truly free and lighter than
KDE. 
</P>
<H3 CLASS="western">GNOME versus KDE</H3>
<P>Last year (2008), I built the 4.0 release of <A HREF="http://www.kde.org/">KDE</A>
from the source files. GNOME is made up of around sixty packages, KDE
about twenty. <A HREF="http://www.qtsoftware.com/">Qt</A> (the user
interface framework) and KDE are much larger than GNOME. The
compressed source of Qt is about three times the size of the
equivalent GTK+, GLib, Cairo and Pango put together. But, of course,
KDE includes the web browser Konqueror. GNOME needs the Gecko layout
engine from Mozilla.org that you see in Firefox. 
</P>
<P>Qt and KDE's C++ code is slower to compile than GNOME's C, at
least on my old laptop - a Pentium III with only 128 Meg RAM! KDE
uses <A HREF="http://www.cmake.org/">CMake</A> rather than
&quot;configure&quot; to generate the makefiles. It took a while to
learn how to use CMake, but its files are much clearer. 
</P>
<P>The BLFS instructions only covered KDE 3.5, so I had to adjust
things for KDE 4.0. In GNOME, if you wanted to find out where to find
some unusual packages, you could look at the makefiles of the GARNOME
project. Its website is at 
<A HREF="http://projects.gnome.org/garnome">http://projects.gnome.org/garnome</A>.
GARNOME automatically fetches and builds a given GNOME release. 
</P>
<P>For KDE, I had to change a little code when building the 
<A HREF="http://en.wikipedia.org/wiki/Strigi_(KDE)">&quot;strigi&quot;</A>
library. (It searches through files for the semantic desktop). To be
exact, I had to add definitions for &quot;__ctype_b&quot; and
&quot;wstring&quot;. For GNOME, it was easier. I mostly had to go off
and find required libraries that were not in the BLFS notes. 
</P>
<P>KDE has trouble starting up on my laptop, although it is all right
on my PC. There is a lot of swapping in and out and thrashing with my
low memory. In fact, both computers have 128 Megabytes. The laptop
even has a faster processor. It has a Pentium III processor whereas
than the PC has a Pentium II. The disks even seem about the same
speed in simple tests. It is a puzzle. Anyway, KDE takes over ten
minutes to start on my laptop! GNOME takes one minute. (KDE takes
just over a minute on my PC.) 
</P>
<H3 CLASS="western">Browsers</H3>
<P>On KDE, I could get the Konqueror browser running fairly easily.
But I had to add about 250 Meg of swap space to get the WebKit
library to link with the low memory on my PC. WebKit is the rendering
engine. I like the way Konqueror uses many of the same libraries as
other parts of KDE. It makes Konqueror a bit lighter when running
inside of KDE. (I have put the commands I use to add swap at the
<A HREF="#scmds">end</A>). 
</P>
<P>With <A HREF="http://www.mozilla.com/firefox">Firefox 3</A>, I had
to turn the compiler optimization off with the &quot;-O0&quot; switch
to avoid thrashing with the small memory on my old laptop. I also had
to leave out a lot of the components in &quot;libxul&quot;. Otherwise
the link of libxul ends up just swapping in and out as well. (I
understand XUL is the toolkit used to build the user interface of
Mozilla). Firefox does not work without a real libxul though. 
</P>
<P>I thought I would try building GNOME's own browser - 
<A HREF="http://projects.gnome.org/epiphany">Epiphany</A>.
But I had trouble configuring it to use the Gecko rendering libraries
in the Mozilla Firefox 3 browser I had just built. Epiphany offers a
simpler interface than Firefox and concentrates just on web browsing,
taking features like mail from other GNOME applications.
Unfortunately Epiphany seems to expect &quot;pkg-config&quot; entries
for Gecko, which Firefox 3 had not generated. (When you install a
library, a file in /usr/lib/pkgconfig is created, listing the
compiler flags (-L, -l and -I) needed by a program using the
library.)  I manually added in all the Firefox shared libraries I
could find. But there seemed to be some core Firefox functions that
Epiphany still could not access. However, Epiphany does really
recommend Firefox 2. But Firefox 2 uses a lot of deprecated functions
in my more modern version of Cairo. I got lost in all the errors. 
</P>
<P>Then I noticed that Epiphany's web page mentions an 
<A HREF="http://live.gnome.org/WebKitGtk">experimental
version</A> using <A HREF="http://www.webkit.org/">WebKit</A> as the
browser engine. But the configuration seemed to have incomplete
autoconf/automake files and use the Apple xcodebuild tool. It was too
difficult for me. You can begin to see there is some skill required
to build a complete distribution! 
</P>
<P>I later learnt from a GNOME 
<A HREF="http://blogs.gnome.org/otte/2009/03/03/browsing-in-gnome">blog</A>
that the Mozilla version of Epiphany is not actively developed any
more, because about a year ago GNOME started to switch to WebKit. But
the switch has not been completed. It was originally scheduled to be
delivered with GNOME 2.26, but has been postponed to GNOME 2.28. I
remembered that WebKit is a fork of KDE's KHTML browser engine used
by Konqueror. It was made by Apple for their Safari browser, and more
recently used by Google in its Chrome browser. 
</P>
<P>In the end, I built the <A HREF="http://www.dillo.org/">Dillo</A>
browser. It used to use GTK and Glib. But it now uses the 
<A HREF="http://www.fltk.org/">FLTK</A>
(Fast Light Tool Kit) - a C++ GUI toolkit. Of course, it does not
support Javascript or Java. 
</P>
<P>Strangely enough, Konqueror runs quite well within GNOME! I think
I will use it when developing complicated web pages which use
Javascript and AJAX. 
</P>
<H3 CLASS="western">Problems compiling packages</H3>
<P>Would you enjoy building programs from the source tarballs?  I
think you probably need some knowledge of C.  Not too much, as I
didn't know a lot about C++ when I built KDE.  There always seem to
be a few problem with compiling packages.  Here are a few to give you
an idea. 
</P>
<P>A simple problem occurred when I was building the
&quot;dbus-glib-bindings&quot; package: 
</P>
<PRE class="code">DBUS_TOP_BUILDDIR=.. dbus-send --system --print-reply=literal --dest=org.freedesktop.DBus /org/freedesktop/DBus org.freedesktop.DBus.Introspectable.Introspect &gt; dbus-bus-introspect.xml.tmp &amp;&amp; mv dbus-bus-introspect.xml.tmp dbus-bus-introspect.xml
Failed to open connection to system message bus: Failed to connect to socket /usr/local/var/run/dbus/system_bus_socket: Connection refused</PRE><P>
I guessed it wanted the dbus system bus running. I remembered
something from building D-Bus last year, had a look around, and ran
&quot;dbus-daemon --system&quot;. 
</P>
<P>A typical problem was with gnome-terminal. It included the
&quot;dbus-glib-bindings.h&quot; header file which itself included
the glib header &quot;glib-2.0/glib/gtypes.h&quot;. But glib did not
want its header file directly included and had put a &quot;#error&quot;
statement in to give a warning. I solved this by crudely commenting
out the #error. 
</P>
<P>The strangest problem I got was when running GStreamer's configure
script: 
</P>
<PRE class="code">    ./configure: line 32275: syntax error near unexpected token `('
    ./configure: line 32275: `  for ac_var in `(set) 2&gt;&amp;1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do'</PRE><P>
I tried narrowing it down by putting in some simple echo statements
and then I changed some back ticks to the more modern &quot;$()&quot;.
But, I had the same problem with the GStreamer Plugins package. So I
decided to upgrade my version of Bash, which was a year old. The LFS
project suggests using the &quot;malloc&quot; (memory allocation)
from the libc library rather than that bundled with Bash, so I also
ran configure with the option &quot;--without-bash-malloc&quot;. All
this luckily fixed the problem. 
</P>
<P>Out of interest, I have added the commands I typed (over sixty
times) to build the packages, at the <A HREF="#bcmds">end</A> of this
article. 
</P>
<H3 CLASS="western">GNOME libraries</H3>
<P>I enjoy reading about the libraries as I build them. I also wanted
to draw a diagram showing which packages needed to be built first. 
</P>
<P>The libraries are, in fact, described very well in the GNOME
documentation at 
<A HREF="http://library.gnome.org/devel/platform-overview">http://library.gnome.org/devel/platform-overview</A>.
</P>
<P>The libraries shown below are used in various combinations by the
GNOME applications you see on the desktop. 
</P>
<P>My diagrams show the dependencies between packages. For example
GTK requires Pango and Cairo. A package usually generates many
libraries, so it is nice to think at the package level. I believe you
can generate graphs of dependencies automatically from the GNOME
build systems. 
</P>
<P>I have included some notes that I found in the README file or
documentation that came with the packages. 
</P>
<P>I did not build most of the audio or video libraries, as I don't
play music or watch videos on my laptop! It also keeps things simple.
</P>
<H4 CLASS="western">Base libraries</H4>
<PRE>       /|\                 /|\
        +-------------------+
        |       pygtk       |
        |      pycairo      |
        |     pygobject     |                        /|\            /| |\
        | (python bindings) |          +---- gail ----+  +-----------+ +------+
        +-------------------+          |    (GNOME    |  | dbus-glib | |libxml|
/|\                                    |accessibility)|  | bindings  | |      |
 +----------------------- gtk+ -----------------------+  +-----------+ +------+
 |     (GIMP Tool Kit - graphical user interfaces)    |  |   D-Bus   |
 |-- pango --+--------+                +---- atk -----+  | (message  |
 |(rendering)| libpng |      +---------+(accessibility|  |  passing  |
 | of text)  | libjpeg|      | libtiff |  interfaces) |  |  system)  |
 +----------------------- cairo ----------------------+  +-----------+
 |  (2D graphics library for multiple output devices) |
 +------------------+------------ pixman -------------+
                    |         (low level pixel        |
                    | manipulation, e.g. compositing) |
                    +----------------------------------
                                                     /|\
                              +-------- gvfs ---------+ 
                              |   (backends include   |
/|\                           | sftp, smb, http, dav) | 
 +----------------------- glib -----------------------+ 
 |(data structures, portability wrappers, event loop, |
 |threads, dynamic loading, algorithms, object system,|
 |GIO - the virtual file system replacing gnome-vfs)  |
 +----------------------------------------------------+   
 </PRE><H5 CLASS="western">
Notes</H5>
<P>The GIO library in <A HREF="http://library.gnome.org/devel/glib/stable">GLib</A>
tries not to clone the POSIX API like the older gnome-vfs package,
but instead provides higher-level, document-centric interfaces. The
GVFS backends for GIO are run in separate processes, which minimizes
dependencies and makes the system more robust. The GVFS package
contains the GVFS daemon, which spawns further mount daemons for each
individual connection. 
</P>
<P>The core <A HREF="http://www.pango.org/">Pango</A> layout engine
can be used with different font and drawing backends. GNOME uses
FreeType, fontconfig, and Cairo. But on Microsoft Windows, Pango can
use the native Uniscribe fonts and render with the Win32 API. 
</P>
<P>The <A HREF="http://cairographics.org/">Cairo</A> documentation
says it is &quot;<I>designed to produce consistent output on all
output media while taking advantage of display hardware acceleration
when available (for example, through the X Render Extension) ... The
cairo API provides operations similar to the drawing operators of
PostScript and PDF. Operations in cairo include stroking and filling
cubic Bezier splines, transforming and compositing translucent
images, and antialiased text rendering. All drawing operations can be
transformed by any affine transformation (scale, rotation, shear,
etc.</I>&quot; 
</P>
<P><A HREF="http://www.gtk.org/">GTK+</A> was first developed as a
widget set for the GIMP (GNU Image Manipulation Program). The FAQ
mentions one of the original authors, Peter Mattis, saying &quot;<I>I
originally wrote GTK which included the three libraries, libglib,
libgdk and libgtk. It featured a flat widget hierarchy. That is, you
couldn't derive a new widget from an existing one. And it contained a
more standard callback mechanism instead of the signal mechanism now
present in GTK+. The + was added to distinguish between the original
version of GTK and the new version. You can think of it as being an
enhancement to the original GTK that adds object oriented features.</I>&quot;
The GTK+ package contains GDK, the GTK+ Drawing Kit, an easy to use
wrapper around the standard Xlib function calls for graphics and
input devices. GDK provides the same API on MS Windows. 
</P>
<P>The <A HREF="http://projects.gnome.org/accessibility">GAIL</A>
documentation says &quot;<I>GAIL provides an implementation of the
ATK interfaces for GTK+ and GNOME libraries, allowing accessibility
tools to interact with applications written using these libraries ...
ATK provides the set of accessibility interfaces that are implemented
by other toolkits and applications. Using the ATK interfaces,
accessibility tools have full access to view and control running
applications.</I>&quot; GAIL stands for GNOME Accessibility
Implementation Layer. It has just been moved into GTK. 
</P>
<P><A HREF="http://dbus.freedesktop.org/">D-BUS</A> is a simple inter
process communication (IPC) library based on messages. The
documentation says &quot;<I>a core concept of the D-BUS
implementation is that 'libdbus' is intended to be a low-level API,
similar to Xlib. Most programmers are intended to use the bindings to
GLib, Qt, Python, Mono, Java, or whatever. These bindings have
varying levels of completeness.</I>&quot; 
</P>
<P>PyGObject allows you to use GLib, GObject and GIO from Python
programs. 
</P>
<H4 CLASS="western">Platform libraries</H4>
<PRE>                                                      gnome-icon-theme
                                                            /|\
                                                      icon-naming-utils
                                               (xml to translate old icon names)
                  libgnomeui* 
    (a few extra gui widgets, many now in gtk)
                      /|\
                       +---------------------------+
                       |                           |
                  libbonoboui*                gnome-keyring
           (user interface controls     (password and secrets daemon 
            for component framework)     and library interface)
                      /|\                          |
                       |                        libtasn1
                       |               (Abstract Syntax Notation One)
                       |
                       +--------------------------------------+
                       |                                      |
                    libgnome*                          libgnomecanvas*
    (initialising applications, starting programs,    (structured graphics:
     accessing configuration parameters, activating  polygons, beziers, text
     files and URI's, displaying help)               pixbufs, etc. Rendered
                      /|\                             by Xlib or libart)
  +--------------------+----------+                           |
  |                               |                          /|\
  |  gnome-vfs monikers           |                           |
  |   /|\       /|\               |                           |
  |    |         +-------- gnome-vfs* (virtual file system)   +----------+
  |    |                 (consistent API for local and        |          |
  |    |               remote files, cameras, WebDAV, etc)    |          |
  |    |                         /|\                          |          |
  |    |             +------------+--------+               libglade    libart*
  |    |             |                     |            (dynamically   (fast 2d
  |    |          Gconf             gnome-mime-data      load glade    graphic
  |    |      (configuration           (classify         user        primitives)
 libbonobo*     database -            file contents)     interface 
 (component      daemon &amp;                                description
 system, e.g.    library)                                files)
 multimedia         /|\
 in word processor)  | 
 /|\                 |
  +------------------+ 
  |
 ORBit2+ * (fast and light CORBA object broker)
   +--- libIDL (parses interface definitions for CORBA)     
    

Note: * indicates library is depreciated</PRE><H5 CLASS="western">
Notes</H5>
<P>Many of the libraries on the left hand side of the diagram are not
used in newly written code and references to them have been removed
in some old code. But the API's are still supported, at least for the
current GNOME 2.x series. GNOME is moving to using D-Bus for
communication between processes. GNOME Panel applets use Bonobo to
communicate with the panel. GnomeVFS has been replaced by GIO, and
the GVFS library which supplies the network and local protocols. 
</P>
<P>According to the documentation, &quot;
<A HREF="http://library.gnome.org/devel/libglade/stable"><I>Libglade</I></A><I>
is an alternative to using </I><A HREF="http://glade.gnome.org/"><I>Glade's</I></A><I>
code generation. Instead of generating code from the XML interface
description, libglade loads and parses the description at runtime. It
also provides functions that can be used to connect signal handlers
to parts of the interface.</I>&quot; 
</P>
<P><A HREF="http://www.gnome.org/~mathieu/libart/libart.html">Libart</A>
is, in its own words, a &quot;sophisticated, antialiased,
alpha-compositing engine.&quot; 
</P>
<P>The &quot;gnome-keyring&quot; README says it can &quot;<I>manage
several keyrings, each with its own master password, and there is
also a session keyring which is never stored to disk, but forgotten
when the session ends.</I>&quot; 
</P>
<P>According to the Wikipedia, 
<A HREF="http://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One">Abstract
Syntax Notation One</A> (ASN.1), is used &quot;<I>in telecoms and
computer networking... [and] is a standard and flexible notation that
describes data structures for representing, encoding, transmitting
and decoding data</I>&quot;. 
</P>
<P>You can read the reference documentation for libbonobo at
<A HREF="http://library.gnome.org/devel/libbonobo/stable">http://library.gnome.org/devel/libbonobo/stable</A>.
Maybe it is worth a skim through to get an overview. There are
similar API references for <A HREF="http://library.gnome.org/devel/gconf/stable">GConf</A>,
<A HREF="http://library.gnome.org/devel/gnome-vfs/stable">gnome-vfs</A>,
<A HREF="http://library.gnome.org/devel/libgnome/stable">libgnome</A>,
<A HREF="http://library.gnome.org/devel/libgnomecanvas/stable">libgnomecanvas</A>,
<A HREF="http://library.gnome.org/devel/libbonoboui/stable">libbonoboui</A>
and <A HREF="http://library.gnome.org/devel/libgnomeui/stable">libgnomeui</A>.
</P>
<H4 CLASS="western">Desktop libraries</H4>
<PRE>gnome-themes   gnome-user-docs   gnome-backgrounds   gnome-terminal
     |          (user, admin                        (just the shell:   
    /|\            guides)                           menubar, prefs dialog)
     |               |                                     /|\
gtk-engines    gnome-doc-utils                              |  
 (themes)     (xslt for Docbook                            vte 
               and translations)                    (terminal emulator
                                                 widget implemented in GTK)

                                   gnome-session
                                         | 
                                   control-center
                                        /|\
 +----+----------------+-----------------+------------+------------+ 
 |    |                |                 |            |            |
 | gnome-applets  metacity  nautilus (file manager)   |        gstreamer
 |   (for panel)  (window         |      |       |    |         plugins 
 |    |     |     manager)       /|\  libexif librsvg |            |
 |   /|\ libgtop       |          |  (digital  (fast  |     +------+------+     
 |    |  (portable     zenity     |   cameras)  SVG)  |     |             | 
 |    | performance   (dialogs    |              |    |    gstreamer   liboil 
 |    |  statistics    in         |      +-------+   /|\  (sound &amp;    (optimized
 |    |  library       scripts)   | libcroco  libgsf  |    video)    inner loops
/|\   |  and server)              | (CSS2     (structured                  using
 |    |                           | parser)    files) |                 assembly
 |    |                           |                   +--+-------+     MMX, SSE)
 |    |                           |                      |       |
 | gnome-panel        eel (nautilus widgets, extensions) |  libgnomekdb
 |    |     |           /|\                        |     |      /|\
 |    |     +-------+----+                      gnome-menus      |
 |    |             |                           (engine)    libxklavier
 | libwnck          |                                   (accessing &amp; setting
 | (library for window management e.g. workspace          keyboard layouts)     
 |                  |       pagers and tasklists)               /|\
 +--------+---------+                                            | 
          |                                                   isocodes 
    gnome-desktop                                     (list of country, language
(functions for background, monitor, thumbnails,           and currency names)
 desktop items, and gnome-about. Icon files)</PRE><H5 CLASS="western">
Notes</H5>
<P>Remember the diagram shows the dependencies. For example, some of
the features in the GNOME control panel are implemented in Metacity,
such as changing the window border theme, or window navigation
shortcuts. 
</P>
<P>Libgnome-desktop contains APIs that really belong in libgnome(ui)
or GTK+ but are limited in their use. It provides support for desktop
backgrounds, monitor configuration, thumbnails, and desktop items. 
</P>
<P><A HREF="http://live.gnome.org/RoadMap/Libwnck">Libwnck</A> is the
Window Navigator Construction Kit. It uses the Extended Window
Manager Hints specification (EWMH). 
</P>
<P>The documentation for &quot;eel&quot; says &quot;<I>The Eazel
Extensions Library is a collection of widgets and extensions to many
modules of the GNOME platform. These widgets and extensions were
developed by hackers working on Nautilus.</I>&quot; 
</P>
<P>The &quot;gnome-menus&quot; package contains an implementation of
the draft &quot;Desktop Menu Specification&quot; from
freedesktop.org. 
</P>
<P>The README for <A HREF="http://sourceforge.net/projects/libexif">&quot;libexif&quot;</A>
says it &quot;contains a library for parsing, editing, and saving
EXIF data. Most digital cameras produce EXIF files, which are JPEG
files with extra tags that contain information about the image ... It
is intended to replace lots of redundant implementations in
command-line utilities and programs with GUIs.&quot; 
</P>
<P><A HREF="http://librsvg.sourceforge.net/">Librsvg</A> is a high
performance SVG rendering. It can draw a SVG to a Cairo surface or
render SVGs into GDK pixbufs for easy use in GTK+ applications.
Librsvg is not used by the very latest Nautilus code, but is part of
other GNOME applications. 
</P>
<P>The README file for 
<A HREF="http://www.freespiders.org/projects/libcroco">&quot;libcroco&quot;</A>
says it is a &quot;<I>standalone css2 parsing and manipulation
library. The parser provides a low level event driven SAC (Simple Api
for CSS) like api and a css object model like api. Libcroco provides
a CSS2 selection engine and an experimental xml/css rendering
engine.</I>&quot; 
</P>
<P>The documentation for <A HREF="http://directory.fsf.org/project/libgsf">&quot;libgsf&quot;</A>
says the &quot;<I>GNOME Structured File Library (GSF) is an I/O
abstraction for reading/writing compound files... GSF was written as
part of the Gnumeric project. It started in 2002 as a replacement for
libole2 which Gnumeric was using to handle the Microsoft Excel</I>&quot;.
It reads gzip, bz2, zip, XML and OASIS Open Document formats amongst
others. 
</P>
<P>According to its home page, <A HREF="http://www.schleef.org/liboil">&quot;Liboil&quot;</A>
“<I>is a library of simple functions that are optimized for various
CPUs. These functions are generally loops implementing simple
algorithms, such as converting an array of N integers to
floating-point numbers or multiplying and summing an array of N
numbers ... The goal of this project is to consolidate some of the
code used by various multimedia projects, and also make optimizations
easier to use by a broader range of applications.</I>&quot; 
</P>
<P>The &quot;gnome-applets&quot; package includes the libpanel-applet
library which allows you to develop small applications which can be
embedded in the panel. 
</P>
<P>On systems like BSD and Solaris, 
<A HREF="http://library.gnome.org/devel/libgtop/stable">&quot;libgtop&quot;</A>
provides a setgid/setuid server for graphical tools. On Linux,
libgtop has a library that gives performance information in a generic
way to the differents tools that use it such as &quot;gtop&quot; and
panel applets. 
</P>
<P>In the <A HREF="http://projects.gnome.org/nautilus">Nautilus</A>
architecture document it says &quot;<I>Nautilus is a general-purpose
shell application for browsing arbitrary content. It is implemented
as `nautilus', a container application which exercises overall
control and provides chrome, and a number of nautilus view
components. These view components may use the `libnautilus' library
to ease implementation.</I>&quot; 
</P>
<P><A HREF="http://gstreamer.freedesktop.org/">Gstreamer</A>, of
course, is a framework for streaming media. According to the
documentation, &quot;<I> It's based on plug-ins that will provide the
various codec and other functionality ... Is GStreamer a media player
? No, GStreamer is a development framework for creating applications
like media players, video editors, streaming media broadcasters and
so on. That said, very good media players can easily be built on top
of GStreamer</I>&quot;. 
</P>
<P><A HREF="http://library.gnome.org/devel/vte/stable">VTE</A> can
also be used to embed a console/terminal in games, editors, IDEs,
etc. VTE supports Unicode and character set conversion, as well as
emulating any terminal known to the system's terminfo database. 
</P>
<P>The author of <A HREF="http://en.wikipedia.org/wiki/Metacity">Metacity</A>
says it is a &quot;<I>boring window manager for the adult in you.
Many window managers are like Marshmallow Froot Loops; Metacity is
like Cheerios ... includes only the window manager; does not try to
be a desktop environment. The pager, configuration, etc. are all
separate and modular.</I>&quot; According to Wikipedia, GNOME used
the Enlightenment window manager and then Sawfish before choosing
Metacity. Apparently, it is aimed at new computer users that do not
need the extreme configurability offered by its predecessors. 
</P>
<H3 CLASS="western"><A NAME="bcmds"></A>Build commands</H3>
<P>First I look at the README file in the package directory. Then I
check if the INSTALL file is anything but the standard one, using
&quot;head&quot;. 
</P>
<PRE class="code">set -b     # so bash tells me when jobs finish

configure --help=short 2&gt;&amp;1 | less    # shows options specific to package

configure &gt;myconf01.lst 2&gt;&amp;1 &amp;        # usually installs into /usr/local -
                                      # unless you add a --prefix=/mydir option
# have a look at the log file, -
# especially the end

make &gt;mymake01.lst 2&gt;&amp;1 &amp;
# at the start, &quot;tail -f&quot; the log file -
# to make sure the compiler options are OK

make install &gt;mymakeinst01.lst 2&gt;&amp;1 &amp; # you may need to be root, of course.
# look at the log file to see where the binaries are put, what are the actual
# names of the libraries installed, and where to find the documentation</PRE><H3 CLASS="western">
<A NAME="scmds"></A>Commands to add swap</H3>
<P>Adding swap lets you pretend you have more memory. I did not know
how to do this when I started! 
</P>
<PRE class="code"># run as root
dd if=/dev/zero of=swap1 bs=1024 count=100k   # 100 Meg
mkswap swap1
swapon swap1</PRE><P>
Sometimes the program really is too big and the PC will just swap
files in and out all the time. I can see the laptop is &quot;thrashing&quot;
simply by the hard-disk light staying on! I also use the &quot;<CODE>vmstat
5</CODE>&quot; command. It reports every five seconds. The CPU will
be waiting for IO to finish most of the time. The &quot;cpu wa&quot;
column will be high, say 97%. The program will not have much time to
run, with a low &quot;user time&quot; for my non-kernel code. The
&quot;cpu us&quot; column might say 3%. You can see the amount of
blocks read and written rising in the &quot;IO bi bo&quot; columns.
(The first line produced by <CODE>vmstat</CODE> gives averages since
the system booted.) 
</P>
<P>Good luck! 
</P>

<br clear="all" />

<script type='text/javascript'>
digg_url = 'http://linuxgazette.net/164/laycock.html';
digg_title = 'Building the GNOME Desktop from Source';
digg_bodytext = '<P>First, I must say that the <A HREF="http://www.gnome.org/">GNOME</A> documentation &quot;strongly recommends&quot; against building from source files. If you do, it suggests using the GARNOME scripted system. Even GARNOME it says, is only for the &quot;brave and patient&quot;.  </P> ';
digg_topic = 'linux_unix';
</script>
<script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>


<p class="talkback">
Talkback: <a
href="mailto:tag@lists.linuxgazette.net?subject=Talkback:164/laycock.html">Discuss this article with The Answer Gang</a>
</p>

<!-- *** BEGIN author bio *** -->
<hr>
<p>
<img align="left" alt="[BIO]" src="../gx/authors/laycock.jpg" class="bio">
</p>

<em>
<p>
I live by the River Thames in the suburbs of London, England. I play
 with Linux in my spare time on a ten year old PC. I was a C and Oracle
 programmer when I was younger.
</p>



</em>

<br clear="all">


<!-- *** END author bio *** -->

<div id="articlefooter">

<p>
Copyright &copy; 2009, Oscar Laycock. Released under the <a
href="http://linuxgazette.net/copying.html">Open Publication License</a>
unless otherwise noted in the body of the article. Linux Gazette is not
produced, sponsored, or endorsed by its prior host, SSC, Inc.
</p>

<p>
Published in Issue 164 of Linux Gazette, July 2009
</p>

</div>

<div id="previousnextbottom">
<A HREF="kachold.html" >&lt;-- prev</A> | <A HREF="prestia.html" >next --&gt;</A>
</div>

</div>
</div>

<script src="http://www.google-analytics.com/urchin.js"
type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1204316-1";
urchinTracker();
</script>







<img src="../gx/tux_86x95_indexed.png" id="tux" alt="Tux"/>

</body>
</html>

