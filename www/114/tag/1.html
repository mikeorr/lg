<html>
<head>
<link href="../../lg.css" rel="stylesheet" type="text/css" media="screen, projection"  />
<title>The Answer Gang: LG 114: How do I get a non-US keyboard mapping in Xnest?</title>

<style type="text/css" media="screen, projection">
<!--
.articlecontent {
        position:absolute;
        top:143px;
}
-->
</style>
</head>
<body>
<img src="../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
<p id="fun">...making Linux just a little more fun!</p>


<div class="content articlecontent">

<div id="previousnexttop">
<A HREF="../lg_tips.html" >&lt;-- 2c Tips</A> 
| <A HREF="../lg_answer.html">TAG Index</a> 
| <A HREF="1.html">1</a> | <A HREF="2.html">2</a> | <A HREF="3.html">3</a>
| <A HREF="4.html">4</a>
| <a href="../../tag/kb.html">Knowledge Base</a>
| <A HREF="../lg_bytes.html" >News Bytes --&gt;</A>
</div>



<h1 align="center"><IMG SRC="../../gx/dennis/qbubble.gif" align="left"> The Answer Gang <IMG SRC="../../gx/dennis/bbubble.gif" align="right"></h1>

<p align="center">By Jim Dennis, Jason Creighton, Chris G, Karl-Heinz, and... 
	(<A HREF="../../tag/bios.html">meet the Gang</A>) ... 
	the Editors of <I>Linux Gazette</I>... and 
	<a href="../../tag/members-faq.html">You</a>!</p>
<br clear="both">
<HR>
<!-- begin 1 -->
<H3 align="left"><img src="../../gx/dennis/qbubble.gif" 
	height="50" width="60" alt="(?) " border="0"
	>How do I get a non-US keyboard mapping in Xnest?</H3>


<p><strong>From Matthias Arndt 
</strong></p> 
<p></strong></p>

<p align="right"><strong>Answered By:  Thomas Adam
</strong></p>
<P><STRONG>
Dear Answer gang,
</STRONG></P>
<P><STRONG>
it has been more than 4 years that I am reading (and sometimes
publishing in) the Linux Gazette with real pleasure. I always did find
most answers to my questions here but this time I'm really stuck.
</STRONG></P>
<P><STRONG>
From time to time I use the Xnest command to connect to remote boxes
with graphical login.
</STRONG></P>
<P><STRONG>
This works much as expected except for one thing: I'm used to a german
keyboard layout and my local X server is configured to use it. But Xnest
does not use it - I always get US keyboard layout inside Xnest.
For example I tried:
</STRONG></P>

<pre><strong>$ Xnest :1 -broadcast -xkbmap de -geometry 980x680
Cannot open "keymap/de" for reading
(EE) Error opening keymap file de, reverting to defaults
</strong></pre>
<P><STRONG>
for example but I got above error and still only got a US keyboard
inside. The rest was working as expected.
Another try was something like this:
</STRONG></P>

<pre><strong>$ Xnest :1 -broadcast -xkbmap /etc/X11/xkb/keymap/xfree86 -geometry 980x680

Cannot open "keymap/etc/X11/xkb/keymap/xfree86" for reading
The XKEYBOARD keymap compiler (xkbcomp) reports:
 &gt; Error:            Cannot open
"/var/tmp/etc/X11/xkb/keymap/xfree86.xkm" to write keyboard description
 &gt;                   Exiting
(EE) Couldn't load XKB keymap, falling back to pre-XKB keymap
(EE) Error opening keymap file /etc/X11/xkb/keymap/xfree86, reverting to
defaults
</strong></pre>
<P><STRONG>
The main question is: how do I need to call/configure Xnest that it will
use my german keyboard setup <em>  inside  </em> the Xnest window so that I can use
remote applications with my german keyboard?
</STRONG></P>
<P><STRONG>
I'm using <A HREF="http://www.suse.com/">SuSE</A> Linux 9.1 with XFree86 Version 4.3.99.902 (4.4.0 RC 2)
and the according version of Xnest.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Thomas] 
The problem you have, Matthias, is that Xnest does not support the
-xkbmap inherently.  Yes, although Xnest will emulate a server, at
present Xnest is only capable of using its own default keyboard
extension map.
</blockQuote>
<blockQuote>
You have to remember that Xnest is a complex program.  To the Xserver
and indeed any other Xclient, it looks and behaves as such (it looks
like an Xserver to the underlying real Xserver, and as an Xclient to the
windows mapped to it) [1]. The reason why the -xkbmap is ignored is
because when Xnest loads, it changes the keyboard layout procedures of
the real server to its own defaults [2].  Currently there is no pure
workaround, other than you <EM>might</EM> be able to use Xmodmap from within
Xnest to change it (or possibly Xkeycaps).
</blockQuote>
<blockQuote>
I realise I've been vague about some points, but this is a really
complex issue that I might (if the interest is high enough) turn into an
article or TAG entry.
</blockQuote>

<blockQuote><ol>
<LI>This has several inherent problems, that I'll skip.


<LI>To many people, this is complex to work around -- but think about.  Xnest is both an Xclient and an Xserver (in this sense).  The kdb extensions are inherently supplied and then dropped by the real Xserver.  It's a transparent process only.

</ol></blockQuote>

<!-- end 1 -->
<hr>
<p><CENTER><Font face="Helvetica"><STRONG>
This page edited and maintained by the Editors of <I>Linux Gazette</I>
<br>HTML script maintained by
        <A HREF="mailto:star@starshine.org">Heather Stern</a> of
        Starshine Technical Services,
<A HREF="http://www.starshine.org/">http://www.starshine.org/</A></STRONG></Font></CENTER></p>
<hr>

<div id="articlefooter">
<p>
Each TAG thread <a href="http://linuxgazette.net/copying.html"
        >Copyright &copy;</a> its authors, 2005
</p>
<p>
Published in issue 114 of <I>Linux Gazette</I> May 2005
</p>
</div>


<div id="previousnextbottom">
<A HREF="../lg_tips.html" >&lt;-- 2c Tips</A> 
| <A HREF="../lg_answer.html">TAG Index</a>
 | <A HREF="1.html">1</a> | <A HREF="2.html">2</a> | <A HREF="3.html">3</a> | <A HREF="4.html">4</a>
| <a href="../../tag/kb.html">Knowledge Base</a>
| <A HREF="../lg_bytes.html" >News Bytes --&gt;</A>
</div>
</div>

<div id="navigation">
<a href="../../index.html">Home</a>
<a href="../../faq/index.html">FAQ</a>
<a href="../../lg_index.html">Site Map</a>
<a href="../../mirrors.html">Mirrors</a>
<a href="../../mirrors.html">Translations</a>
<a href="http://linuxgazette.net/search.html">Search</a>
<a href="../../archives.html">Archives</a>
<a href="../../authors/index.html">Authors</a>
<a href="../../contact.html">Contact Us</a>
</div>

<div id="breadcrumbs">
<a href="../../index.html">Home</a> &gt; 
<a href="../index.html">May 2005 (114)</a> &gt; 
<a href="../lg_answer.html">The Answer Gang</a> &gt; 
Thread
</div>

<img src="../../gx/2003/sit3-shine.7-2.gif" id="tux" alt="Tux"/>

</body>
</html>
