<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="utf-8" xml:lang="utf-8">
<head>
<title>Layer 8 Linux Security: OPSEC for Linux Common Users, Developers and Systems Administrators LG #164</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../lg.css" type="text/css" media="screen, projection"  />
<link rel="alternate" type="application/rss+xml" title="LG RSS" href="lg.rss" />
<link rel="alternate" type="application/rdf+xml" title="LG RDF" href="lg.rdf" />
<!-- link rel="alternate" type="application/atom+xml" title="LG Atom" href="lg.atom.xml" / -->
<link rel="shortcut icon" href="../favicon.ico" />

<style type="text/css" media="screen, projection">
<!--

-->
</style>

</head>
<body>

<a href="../">
<img src="../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
</a>
<p id="fun">...making Linux just a little more fun!</p>

<div id="navigation">
<table summary="masthead" width="100%">
<tr>
<td align="center" colspan="3" style="font-size: 10px; font-weight: bold">
<a href="../index.html">Home</a>
<a href="http://linuxgazette.net">Main Site</a>
<a href="../faq/index.html">FAQ</a>

<a href="../lg_index.html">Site Map</a>
<a href="../mirrors.html">Mirrors</a>
<a href="../mirrors.html">Translations</a>
<a href="../search.html">Search</a>
<a href="../archives.html">Archives</a>
<a href="../authors/index.html">Authors</a>
<a href="http://lists.linuxgazette.net/mailman/listinfo/">Mailing Lists</a>
<a href="../jobs.html">Join Us!</a>
<a href="../contact.html">Contact Us</a>

<hr width="99%" style="border: 1px inset #000033">
</td>
</tr>
<tr>
<td width="40%" align="left" style="font-size: 10px; font-weight: bold">
The Free International Online Linux Monthly
</td>
<td width="20%" align="center" style="font-size: 10px; font-weight: bold">
ISSN: 1934-371X
</td>
<td width="40%" align="right" style="font-size: 10px; font-weight: bold">
Main site: <a href="http://linuxgazette.net">http://linuxgazette.net</a> 
</td>
</table>
</div>


<div id="breadcrumbs1">

<a href="../index.html">Home</a> &gt; 
<a href="index.html">July 2009 (#164)</a> &gt; 
Article

</div>

<div class="articlecontent1">
<div class="content">

<div id="previousnexttop">
<A HREF="lg_bytes.html" >&lt;-- prev</A> | <A HREF="laycock.html" >next --&gt;</A>
</div>

<h1>Layer 8 Linux Security: OPSEC for Linux Common Users, Developers and Systems Administrators</h1>
<p id="by"><b>By <a href="../authors/kachold.html">Lisa Kachold</a></b></p>

<img src="../gx/minilogos/layer8.jpg" align="left" hspace="40" vspace="20">

<p>
As users of Linux each of us is in a unique position with a powerful tool.  
Use of any tool without regard for security is dangerous.  Developers 
likewise carry a great responsibility to the community to maintain systems 
in a secure way.  Systems Administrators are often placed in the 
uncomfortable role of holding a bastion between insecurity or pwnership and 
uptime.
</p>

<p>
Let's evaluate just one standard security methodology against our use of 
Linux as a tool: OPSEC.
</p>

<p>
Operations security (OPSEC) is a process that identifies critical information
to determine if friendly actions can be observed by adversary intelligence 
systems, determines if information obtained by adversaries could be 
interpreted to be useful to them, and then executes selected measures that 
eliminate or reduce adversary exploitation of friendly critical information.
</p>

<br clear="all" />

<pre>
  "If I am able to determine the enemy's dispositions while at the same time 
  I conceal my own, then I can concentrate and he must divide." - Sun Tzu
</pre>


<p>
While we might not realize it, because we are firmly rooted
intellectually in the "linux security matrix", a great many
international, national and local "enemies" exist who are happily
exploiting the linux TCP/IP stack while laughing maniacally.  If you
don't believe me, on what basis do you argue your case? Have you ever
tested or applied OPSEC Assessment methodologies to your (select one):
</p>

<pre>
a) Laptop SSH
b) Application Code or db2/mysql/JDBC
c) Server (SMTP, DNS, WEB, LDAP, SSH, VPN)
</pre>

<p>
OPSEC as a methodology was developed during the Vietnam War, when Admiral 
Ulysses Sharp, Commander-in-chief, Pacific, established the "Purple Dragon" 
team after realizing that current counterintelligence and security measures 
alone were insufficient. They conceived of and utilized the methodology of 
"Thinking like the wolf", or looking at your own organization from an 
adversarial viewpoint. When developing and recommending corrective actions 
to their command, they then coined the term "Operations Security".
</p>

<p>
OPSEC is also a very good critical assessment skill to teach those who are 
learning to trust appropriately and live in this big "dog eat dog" world.  
A psychologist once suggested to me that "thinking of all the things you 
could do (but wouldn't)" was a technique invaluable to understanding human 
nature, personal motivations and chaos/order in natural systems.  Since linux 
people tend to be interested in powerful computing, glazed eye techno-sheik, 
and s-hexy solutions that just work - they also are generally extremely 
ethical and take reasonable responsibility for computer security, once they 
know where to start.  
</p>

<p>
Now, we all know that computer security is a layered process, wherein we, as 
users, developers and administrators form one of the layers. 
</p>

<p>
The OSI model is a 7-layer abstract model that describes an architecture of 
data communications for networked computers. The layers build upon each other, 
allowing for abstraction of specific functions in each one. The top (7th) 
layer is the Application Layer describing methods and protocols of software 
applications. 
</p>

<p>
Layer 8 is Internet jargon used to refer to the "user" or "political"
layer as an extension of the OSI model of computer networking.
</p>

<p>
Since the OSI layer numbers are commonly used to discuss networking topics, 
a troubleshooter may describe an issue caused by a user to be a layer 8 issue,
similar to the PEBKAC acronym and the ID-Ten-T Error.
</p> 

<p>
We can see that SSH keys (or a lack of them) alone is not any big
security issue.  However add root users, fully routable internet
addressing (rather than NAT), no iptables or other firewall, no
password management or security policy and a curiously Ettercap armed
angry underpaid antisocial personality disorder user, and well, there
might be a problem?
</p>

<p>
The OPSEC Assessment Steps are:
</p>

<h3> 1. Identify critical information</h3>
<p>
Identify information critically important to the organization, mission, 
project or home [intellectual property, mission details, plans, R&amp;D, 
capabilities, degradations, key personnel deployment data, medical records, 
contracts, network schematics, etc.]
</p>
   
<p>
But "Wait", you say, "I am just a kid with a laptop computer!" Do you frequent 
the coffee shop?  Do you use shared networking?  Do you allow others to watch 
you login to your bank information from over your shoulder.  If so, OPSEC is 
certainly for you.  
</p>

<p>
While this step is a great deal more dire to a systems administrator,
who clearly knows how easy it is to crash a system and lose all of the
work from 30 or more professionals with a single command, or one who
realizes that pwnership means never being able to define stable
uptime, each and every computer user knows what it's like not to be
able to depend on any data stability.  Security = stability in every
venue.
</p>  

<h3>2. Identify potential adversaries</h3>
<p>
Identify the relevant adversaries, competitors or criminals with both 
intent and capability to acquire your critical information.
</p>

<p>
If you have not taken a moment to look at your logs to see all the
attempts to gain access via SSH or ftp, or sat seriously
in a coffee shop evaluating wireless traffic or watched tcpdump to see
what is occuring on a University network, this might be the time to
start.  It's not just people from China and Russia (scripts including
netcat, nmap, and MetaSploit can be trivially configured to spoof
these addresses).  Wake up and look around at conferences and ask
yourself seriously, who is a competitor, who is a criminal.  This is a
required step in OPSEC.  In the 1990's in the Pacific Northwest,
adversarial contract Linux Systems Administrators regulary attacked each
other's web servers.
</p>  
   
<p>
But, you say, "why would they want to get into my little laptop?". You have 
24x7 uptime, correct?  Your system can be configured via Anacron, as a vague 
untraceable BOT net and you would never even know it?  That BOT net can hog 
your bandwidth and steal your processing power and eventually be used to 
take down servers.
</p>

<h3>3. Identify potential vulnerabilities</h3>
<p>
From the adversary's, competitor's, or thief's perspective, identify 
potential vulnerabilities and means to gain access to the results of step 1. 
Interview a representative sample of individuals.
</p>

<p>
If you have not googled to ensure that the version of Firefox you are running 
is secure from known exploits, you have not completed this step.  If you don't 
know the current vulnerabilites of the version of OpenSSH and Apache or Java 
or other mydriad of binary source code installed with your Ubuntu or Fedora, 
you have no basis for using linux technology wisely.  
</p>     

<p>
While I don't recommend that everyone attend DefCon, reading their
public website might be sufficient to impress you with the importance
of OPSEC. Better yet, burn yourself a BackTrack4 LiveCD and run some
of the tools against your own systems.
</p>

<p>   
There are two basic ways to get into Linux using the OSI stack models: 
"top down" or "bottom up".
</p>
<p>
From:  <a href="http://en.wikipedia.org/wiki/OSI_model">OSI Model</a>
</p>

Layer:
   <ol>
    <li> Physical Layer</li>
    <li> Data Link Layer
	  <ul>
          <li>WAN Protocol architecture</li>
          <li>IEEE 802 LAN architecture</li>
          <li>IEEE 802.11 architecture</li>
	  </ul>
    <li> Network Layer</li>
    <li> Transport Layer</li>
    <li> Session Layer</li>
    <li> Presentation Layer</li>
    <li> Application Layer</li>
    <li> Human Layer</li> 
</ol>
  

<p>
Most issues are due to Layer 8!
</p>   

<h3>4. Assess risk</h3>
<p>
Assess the risk of each vulnerability by its respective impact to mission 
accomplishment / performance if obtained.
</p>   

<p>   After testing your SSH via an outside network or scanning your J2EE 
application cluster from a Trial IBM WatchFire AppScan key, or fuzzing your 
Apache 1.33/LDAP from the shared (no VLAN public network) or accessing/cracking 
your own WEP key in five minutes, you will clearly see that you essentially own 
nothing, can verify no stability, and as soon as your systems are encroached 
all bets are off.
</p>
   
<p>
This is, for instance, the point where the iPhone/Blackberry user/server 
Administrator realizes that his phone is perhaps doing more than he planned 
and wonders at the unchecked, unscanned pdf attachment inclusion policy set 
in Layer 8/9, but without OPSEC, this point always occurs too late.  Phones 
potentially integrate with everything, have IP addresses and are generally 
ignored!
</p>
  
<p>
Again, leaving off printers, for instance, is folly, since many HP printers 
and IPP protocol could be trivially encroached or spoofed via something 
unleashed from an innocous attachment.
</p>
  
<p>
This step must be all inclusive including every adjacent technology that 
each system interfaces with.
</p> 

<h3>5. Define counter measures</h3> 
<p>
Generate / recommend specific measures that counter identified 
vulnerabilities. Prioritize and enact relevant protection measures.
</p>
  
<p>
Now before you all go kicking and screaming, running from this process
due to the pain of "limitations" on your computing freedom, be assured
that there are "solutions".
</p>  

<h3>6. Evaluate Effectiveness</h3>
<p>
Evaluate and measure effectiveness, adjust accordingly.
</p>

<p>
These solutions can be as simple as a wrapper for SSH, upgrading to OpenVPN 
(which is really trivial to implement), using NoScript on a browser, or never 
using a browser via root from a production server.  They can include a server 
based IPTABLE implemented once, or be as all inclusive as a Layer 7 application 
switch (which can be cheaper in a "house of cards" development shop than a 
complete code review (for PCI compliance) or rewrite.  For Tomcat fuzzing for 
instance, an inline IDS or mod_security or mod_proxy architectural change will 
save months of DoS.  
</p>	

<p>
If you must engage in social networking or surfing to warez sites accepting 
javascript, doing so from a designated semi insecure system might be a good 
measure.  
</p>	

<p>
Thinking outside of the box at layered solutions is key, and at the
very least, quit immediately continuing the Layer 8 behavior
identified as dangerous. Turn off SSH at the coffee shop; you aren't
using it anyway.  In fact, turn off Bluetooth as well, which is
probably still on from your build?
</p>	

<p>
A great deal of data will be uncovered through this investigation, so an 
organized documented approach will allow you to sort it out.  You will 
find that it might be simpler to replace or upgrade, rather than 
attempt to protect.  It's not unrealistic to expect to have to upgrade at 
least every four years, considering that you are applying standard patches, 
based on the past 10+ years of Linux history.
</p>	
	
<p>
If (when) you identify dangerous Layer 9 (management) policies, document and 
escalate, so that your responsibility as an ethical technology user has been 
passed along or up.  Apathy and attitudes such as "security reporting is 
unpopular" or "everyone ignored it this long, if I say something they will 
think I am silly" are destructive to all.  Use references if you must; 
security is everyone's responsibility.    
</p>

<p>
The single most dangerous Layer 8/9 policy is one of computer security 
compartmentalization. Prime examples of compartmentalization include: 
<ul>
<li>Ubuntu is a secure distro right out of the box</li>
<li>Linux is more secure than Windows, so I don't have to worry</li>
<li>Our security guy is Ted; it's not my job</li>
<li>Our firewall department watches all security issues, it's not a webmaster 
function</li>
</ul>
<p>
While in a healthy corporate enviroment responsibility travels up, 
in a healthy open source environment responsibility is an organized process; 
and everywhere security cannot be ignored.
</p>
    
<p>
<b>Zero vulnerabilities are completely unrealistic.</b> If
you are working in a shop that functions as if there is complete
systems security without OPSEC or catching yourself thinking that
there are no security risks, this is a serious red flag.  100%
awareness is the only realistic approach.  As a general rule, those
aware of what to protect have a better chance of protecting sensitive
information as opposed to those unaware of its value.
</p> 
   
<p>
<b>Obtain threat data from the experts</b>, don't try to perform all
the analysis on your own.
</p>
   
<p>
This can be as simple as getting a list of the data from CERT related to your
technologies, be it Cisco IOS for your Pix or simply OpenWRT.  
</p>
    
<p>
And much as you are not going to want to believe it, usually there will still 
be 8% of computer security exploit experts who can, after you have mitigated 
all known risks, still get into your systems.  Feature this truth into your 
analysis.
</p>   

<p>
<b>Focus on what can be protected versus what has been revealed.</b>
</p>  
 
<p>
For instance, you might realize, after playing with BackTrack3 SMB4K that all 
this time your SAMBA was allowing Wireless file sharing to Windows neighbors 
and your private information including your personal photos were available to 
all.  Simply close the door.  Paranoia in security is optional and certainly 
not recommended. 
</p>

<p>
<b>Observations, findings and proposed counter measures</b> are best
formatted in a plan of action with milestones to mitigate
vulnerabilities.  In a production environment, this plan would be
forwarded in a complete brief to decision makers, adjacent team users
and anyone with a stake in uptime.
</p>  
  
<p>
<b>Integrate OPSEC into planning and decision processes from the
beginning.</b>  Waiting until the last minute before taking a product to
market (or from market) to conduct an assessment may be too late and
costly.
</p> 
   
<p>
"What QA department?" you might ask.  "We are the QA department and we don't 
have time to scan".  It's simple to run a Wikto/Nikto or evaluation scanner 
against your application.  
</p>    

<p>
Put up a nice php/Mysql CMS or another sharing portal?  Using SVN? You might 
have just opened a nice encrypted tunnel directly into your systems.  If you 
don't test it, you won't know!  Did you evaluate that SugarCRM version before 
building?  Did you look into the known exploits of that open source tool before 
adopting it?
</p>    

<p>
<b>Regular assessments ensure your best protection.</b>
</p>    

<p>
Like disaster recovery, systems OPSEC Assessments are built upon. Revealed 
information is retained as a resource; regularly scheduled assessments 
continue as a group team coordinated event. 
</p>    

<p>
Systems security is not a secret; OPSEC reminds us that all systems are only 
as sick as their secrets.
</p>


<p class="talkback">
Talkback: <a
href="mailto:tag@lists.linuxgazette.net?subject=Talkback:164/kachold.html">Discuss this article with The Answer Gang</a>
</p>

<!-- *** BEGIN author bio *** -->
<hr>
<p>
<img align="left" alt="[BIO]" src="../gx/authors/kachold.jpg" class="bio">
</p>

<em>
<p>
Lisa Kachold is a Linux Security/Systems Administrator, Webmistress,
 inactive CCNA, and Code Monkey with over 20 years Unix/Linux production
 experience. Lisa is a past teacher from FreeGeek.org, a presenter at
 DesertCodeCamp, Wikipedia user and avid LinuxChix member. She organized
 and promotes Linux Security education through the Phoenix Linux Users
 Group HackFEST Series labs, held second Saturday of every month at The
 Foundation for Blind Children in Phoenix, Arizona. Obnosis.com, a play
 on a words coined by LRHubbard, was registered in the 1990's, as a "word
 hack" from the Church of Scientology, after 6 solid years of UseNet news
 administration. Her biggest claim to fame is sitting in Linux Torvald's
 chair during an interview with OSDL.org in Oregon in 2002.
</p>

</em>

<br clear="all">


<!-- *** END author bio *** -->

<div id="articlefooter">

<p>
Copyright &copy; 2009, Lisa Kachold. Released under the <a
href="http://linuxgazette.net/copying.html">Open Publication License</a>
unless otherwise noted in the body of the article. Linux Gazette is not
produced, sponsored, or endorsed by its prior host, SSC, Inc.
</p>

<p>
Published in Issue 164 of Linux Gazette, July 2009
</p>

</div>

<div id="previousnextbottom">
<A HREF="lg_bytes.html" >&lt;-- prev</A> | <A HREF="laycock.html" >next --&gt;</A>
</div>

</div>
</div>

<script src="http://www.google-analytics.com/urchin.js"
type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1204316-1";
urchinTracker();
</script>







<img src="../gx/tux_86x95_indexed.png" id="tux" alt="Tux"/>

</body>
</html>

