<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
		 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' lang='utf-8' xml:lang='utf-8'>
<head>
<title>Talkback:116/herrmann.html</title>
<meta http-equiv='Content-Type; charset=utf-8' />
<link rel='stylesheet' type='text/css' href='../../../lg.css' />
</head>
<body>
<a href="../../../"><img alt="Linux Gazette" src="../../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" /></a><img alt="Tux" src="../../../gx/tux_86x95_indexed.png" id="tux" /><p id="fun">...making Linux just a little more fun!</p><div class='content articlecontent'><a name="top"></a><h3>Talkback:116/herrmann.html</h3>
<p><b>[ In reference to "<a href='../../../116/herrmann.html'>Automatic creation of an Impress presentation from a series of images</a>" in LG#116 ]</b></p><p>
<b><p>
Karl-Heinz Herrmann [kh1 at khherrmann.de]

</p>
</b><br />
<b>Wed, 2 Jul 2008 12:23:06 +0200</b>
</p>

<p>
Hi TAG,
</p>


<p>
I got an email a few days back including a patch to the
img2ooImpress.pl script in issue 116. I would like to forward the
following discussion to TAG (with permission, Rafael is CC'ed):
</p>

<p>
-------------------------------------------------------------------------
<pre>
From: Rafael Laboissiere &lt;rafael@debian.org&gt;
To: Karl-Heinz Herrmann &lt;kh1@khherrmann.de&gt;
Subject: Re: Bug in your img2ooimpress.pl script
Date: Tue, 24 Jun 2008 21:53:36 +0200
User-Agent: Mutt/1.5.17+20080114 (2008-01-14)
</pre>
* Karl-Heinz Herrmann &lt;kh1@khherrmann.de&gt; [2008-06-24 21:39]:
</p>

<pre>
&gt; thanks for the patch... actually I stumbled onto the problem myself
&gt; after an upgrade of OODoc some time back and sent a correction to LG
&gt; which got published as talkback for the article. That patch is there:
&gt; <a href="../../../132/lg_talkback.html#talkback.02">http://linuxgazette.net/132/lg_talkback.html#talkback.02</a>
&gt; 
&gt; but as #116 was before they introduced talkbacks the talkback is not
&gt; actually linked in the original article so it doesn't help people
&gt; much. As LG is mirrored in many places the original articles are not
&gt; changed usually.  
</pre>

<p>
Indeed...  Sorry for bothering you with this.  It is too bad that the LG
article does not link to the talkback.
</p>


<pre>
&gt; I hope -- apart from having to find and fix that bug -- that script
&gt; was helpful <img src="../gx/smile.png" alt=":-)">  
</pre>

<p>
Yes, it was.  I wrote another Perl script based on yours to directly
convert a PDF file into ooImpress.  Besides the OpenOffice::OODoc
module, it needs the xpdf-utils (for pdfinfo), the pdftk, and the
ImageMagick (for convert) packages.  The script is attached below.
 
[...]
</p>

<p>
and another followup by Rafael:
</p>

<p>
I am attaching below an improved version of the script.  I improved the
header material, put it under the GPL-3+ license and it now accepts a --size
option.
</p>

<p>
I also put the script in a (kind of) permanent URL:
<a href="http://alioth.debian.org/~rafael/scripts/pdf2ooimpress.pl">http://alioth.debian.org/~rafael/scripts/pdf2ooimpress.pl</a>
</p>


<p>
----------------------------------------------------------------------
</p>


<p>
Is there a possibility to "upgrade" the older TAG pages with the
talk-back links? I'm of course aware of the mirror problem. 
</p>

<p>
<p class="editorial">
[[[  FYI to Karl-Heinz (and everyone else interested) -  I manually
build the Talkback style for dicussions of articles that predate the
Talkback link. It doesn't help during the discussion, but it does make
the published version look just as spiffy! -- Kat  ]]]
</p>

</p>

<p>
In any case his improved script version might be a nice 2c tip (or mail
bag) contribution. 
</p>



<p>
K.-H.
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_116_herrmann">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Wed, 2 Jul 2008 08:59:42 -0400</b>
</p>

<p>
On Wed, Jul 02, 2008 at 12:23:06PM +0200, Karl-Heinz Herrmann wrote:
</p>

<pre>
&gt; Hi TAG,
&gt; 
&gt; I got an email a few days back including a patch to the
&gt; img2ooImpress.pl script in issue 116. I would like to forward the
&gt; following discussion to TAG (with permission, Rafael is CC'ed):
&gt; 
&gt; -------------------------------------------------------------------------
&gt; From: Rafael Laboissiere &lt;rafael@debian.org&gt;
&gt; To: Karl-Heinz Herrmann &lt;kh1@khherrmann.de&gt;
&gt; Subject: Re: Bug in your img2ooimpress.pl script
&gt; Date: Tue, 24 Jun 2008 21:53:36 +0200
&gt; User-Agent: Mutt/1.5.17+20080114 (2008-01-14)
&gt; 
&gt; * Karl-Heinz Herrmann &lt;kh1@khherrmann.de&gt; [2008-06-24 21:39]:
&gt; &gt; thanks for the patch... actually I stumbled onto the problem myself
&gt; &gt; after an upgrade of OODoc some time back and sent a correction to LG
&gt; &gt; which got published as talkback for the article. That patch is there:
&gt; &gt; <a href="../../../132/lg_talkback.html#talkback.02">http://linuxgazette.net/132/lg_talkback.html#talkback.02</a>
&gt; &gt; 
&gt; &gt; but as #116 was before they introduced talkbacks the talkback is not
&gt; &gt; actually linked in the original article so it doesn't help people
&gt; &gt; much. As LG is mirrored in many places the original articles are not
&gt; &gt; changed usually.  
</pre>

<p>
That's incorrect, actually; there are two links to the original article
right at the top of that Talkback.
 
</p>

<pre>
&gt; Indeed...  Sorry for bothering you with this.  It is too bad that the LG
&gt; article does not link to the talkback.
&gt; 
&gt; &gt; I hope -- apart from having to find and fix that bug -- that script
&gt; &gt; was helpful <img src="../gx/smile.png" alt=":-)">  
&gt; 
&gt; Yes, it was.  I wrote another Perl script based on yours to directly
&gt; convert a PDF file into ooImpress.  Besides the OpenOffice::OODoc
&gt; module, it needs the xpdf-utils (for pdfinfo), the pdftk, and the
&gt; ImageMagick (for convert) packages.  The script is attached below.
&gt;  
&gt; [...]
&gt; 
&gt; and another followup by Rafael:
&gt; 
&gt; I am attaching below an improved version of the script.  I improved the
&gt; header material, put it under the GPL-3+ license and it now accepts a --size
&gt; option.
&gt; 
&gt; I also put the script in a (kind of) permanent URL:
&gt; <a href="http://alioth.debian.org/~rafael/scripts/pdf2ooimpress.pl">http://alioth.debian.org/~rafael/scripts/pdf2ooimpress.pl</a>
</pre>

<p>
That's very nicely written, Rafael! It even survives having "use
strict;" added to it - at least once you insert "my $i;" above line 75.
The only (minor) strikes that I see against it are all the outside
dependencies; this essentially restricts it to a Linux system, or at
least a system on which "pdftk", "convert", and "tempfile" compile and
use the exact set of options that's specified. Besides, Perl already
comes with the "File::Temp" module installed; there's no need to call an
external prog for that.
</p>

<p>
There's also the somewhat odd line (73):
</p>

<pre>
print (sprintf ("Page: %4d (out of $npages)", 0));
</pre>

<p>
This would usually be written as:
</p>

<pre>
printf "Page: %4d (out of $npages)", 0;
</pre>

<p>
Other than those minor nitpicks, nicely done!
</p>


<pre>
&gt; ----------------------------------------------------------------------
&gt; 
&gt; Is there a possibility to "upgrade" the older TAG pages with the
&gt; talk-back links? I'm of course aware of the mirror problem. 
</pre>
 
I'm afraid not. <img src="../gx/frown.png" alt=":("> Our current TAG, etc. pages are built by running a
single script on the raw mailbox plus several rounds of tweaking by our
fearless TAG Editor, Kat. We'd have to dig up all the old mail archives
(which may not be available any longer), fix up all the bits that would
break formatting - at least 3-5 hours per issue, and we've only got the
one Kat to do it! - then, we'd have to rebuild the entire issue for
which we were tweaking the mbox (since there would now be new files to
add to the structure, plus the layout and the look is completely
different) and republish them.
 
Even if we had willing and eager volunteers ready to jump on the job -
which we don't - I still wouldn't want to do it. The old LG pages are
part of Linux history, and I'm hesitant to mess around with them for
almost any but extreme reasons.
</p>


<pre>
&gt; In any case his improved script version might be a nice 2c tip (or mail
&gt; bag) contribution. 
</pre>

<p>
I agree! I also think that, given the LG search page and the fact that
we get spidered by Google regularly, all of these links are easily found
for anyone who wants to find them.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href="http://LinuxGazette.NET">http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_116_herrmann">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Rafael Laboissiere [rafael at debian.org]

</p>
</b><br />
<b>Wed, 2 Jul 2008 15:57:36 +0200</b>
</p>

<p>
* Ben Okopnik &lt;ben@linuxgazette.net&gt; [2008-07-02 08:59]:
</p>


<pre>
&gt; That's very nicely written, Rafael! It even survives having "use
&gt; strict;" added to it - at least once you insert "my $i;" above line 75.
&gt; The only (minor) strikes that I see against it are all the outside
&gt; dependencies; this essentially restricts it to a Linux system, or at
&gt; least a system on which "pdftk", "convert", and "tempfile" compile and
&gt; use the exact set of options that's specified. Besides, Perl already
&gt; comes with the "File::Temp" module installed; there's no need to call an
&gt; external prog for that.
&gt; 
&gt; There's also the somewhat odd line (73):
&gt; 
&gt; ``
&gt; print (sprintf ("Page: %4d (out of $npages)", 0));
&gt; ''
&gt; 
&gt; This would usually be written as:
&gt; 
&gt; ``
&gt; printf "Page: %4d (out of $npages)", 0;
&gt; ''
&gt; 
&gt; Other than those minor nitpicks, nicely done!
&gt; 
</pre>

<p>
I will integrate your suggestions to the next version of the script.  Thanks
a lot for your feedback!
 
<pre>-- 
Rafael
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_116_herrmann">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Sat, 5 Jul 2008 11:42:55 -0400</b>
</p>

<p>
On Thu, Jul 03, 2008 at 03:03:27PM +0200, Rafael Laboissiere wrote:
</p>

<pre>
&gt; * Rafael Laboissiere &lt;rafael@debian.org&gt; [2008-07-02 15:57]:
&gt; 
&gt; It is done now.  You will find a new version (SVN rev2713): of the script at
&gt; the new URL:
&gt; 
&gt;     <a href="http://people.debian.org/~rafael/scripts/pdf2ooimpress.pl">http://people.debian.org/~rafael/scripts/pdf2ooimpress.pl</a>
&gt; 
&gt; I made all the changes that you suggested above and also dropped the
&gt; dependencies on the external programs convert, pdfinfo, and pdftk.  The
&gt; script is now pure Perl and uses the modules Image::Magick and PDF::API2.
</pre>

<p>
Actually, the 'print sprintf' line is still there. <img src="../gx/smile.png" alt=":)"> Not that it harms
anything.
</p>

<p>
I also have a general suggestion. Something I've taken to doing for
module calls in scripts that I plan to distribute, particularly if the
audience is likely to include people who don't know anything about Perl:
</p>

<p>
<pre class='code'>
eval { use Foo::Bar };
die "Foo::Bar isn't installed on your system; it's available from <a href="http://cpan.org/.\n">http://cpan.org/.\n</a>"
    if $@;
</pre>

<p>
This, I find, leads to a lot less confusion than letting a user see
</p>

<pre>
Can't locate Foo/Bar.pm in @INC (@INC contains: /etc/perl /usr/local/lib/perl/5.8.8 /usr/local/share/perl/5.8.8 /usr/lib/perl5 /usr/share/perl5 /usr/lib/perl/5.8 /usr/share/perl/5.8 /usr/local/lib/site_perl /usr/local/lib/perl/5.8.7 /usr/local/share/perl/5.8.7 .).
BEGIN failed--compilation aborted.
</pre>

<p>
Thanks for your effort, Rafael. Given that we've had a number of people
email us about it over time, I'm sure that it'll be put to good use.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href="http://LinuxGazette.NET">http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_116_herrmann">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Rafael Laboissiere [rafael at debian.org]

</p>
</b><br />
<b>Sun, 6 Jul 2008 17:31:49 +0200</b>
</p>

<p>
* Ben Okopnik &lt;ben@linuxgazette.net&gt; [2008-07-05 11:42]:
</p>


<pre>
&gt; On Thu, Jul 03, 2008 at 03:03:27PM +0200, Rafael Laboissiere wrote:
&gt; &gt; * Rafael Laboissiere &lt;rafael@debian.org&gt; [2008-07-02 15:57]:
&gt; &gt; 
&gt; &gt; It is done now.  You will find a new version (SVN rev2713): of the script at
&gt; &gt; the new URL:
&gt; &gt; 
&gt; &gt;     <a href="http://people.debian.org/~rafael/scripts/pdf2ooimpress.pl">http://people.debian.org/~rafael/scripts/pdf2ooimpress.pl</a>
&gt; &gt; 
&gt; &gt; I made all the changes that you suggested above and also dropped the
&gt; &gt; dependencies on the external programs convert, pdfinfo, and pdftk.  The
&gt; &gt; script is now pure Perl and uses the modules Image::Magick and PDF::API2.
&gt; 
&gt; Actually, the 'print sprintf' line is still there. <img src="../gx/smile.png" alt=":)"> Not that it harms
&gt; anything.
&gt; 
&gt; I also have a general suggestion. Something I've taken to doing for
&gt; module calls in scripts that I plan to distribute, particularly if the
&gt; audience is likely to include people who don't know anything about Perl:
&gt; 
&gt; ```
&gt; eval { use Foo::Bar };
&gt; die "Foo::Bar isn't installed on your system; it's available from <a href="http://cpan.org/.\n">http://cpan.org/.\n</a>"
&gt;     if $@;
&gt; '''
&gt; 
&gt; This, I find, leads to a lot less confusion than letting a user see
&gt; 
&gt; ``
&gt; Can't locate Foo/Bar.pm in @INC (@INC contains: /etc/perl /usr/local/lib/perl/5.8.8 /usr/local/share/perl/5.8.8 /usr/lib/perl5 /usr/share/perl5 /usr/lib/perl/5.8 /usr/share/perl/5.8 /usr/local/lib/site_perl /usr/local/lib/perl/5.8.7 /usr/local/share/perl/5.8.7 .).
&gt; BEGIN failed--compilation aborted.
&gt; ''
</pre>

<p>
Thanks again for the further suggestions.  I changed the script again and
put the new version in the URL above.
</p>


<pre>
&gt; Thanks for your effort, Rafael. Given that we've had a number of people
&gt; email us about it over time, I'm sure that it'll be put to good use.
</pre>

<p>
Will my script be referenced somewhere in the LN web site.
 
<pre>-- 
Rafael
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_116_herrmann">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Sun, 6 Jul 2008 11:52:27 -0400</b>
</p>

<p>
On Sun, Jul 06, 2008 at 05:31:49PM +0200, Rafael Laboissiere wrote:
</p>

<p>
[ regarding <a href="http://people.debian.org/~rafael/scripts/pdf2ooimpress.pl">http://people.debian.org/~rafael/scripts/pdf2ooimpress.pl</a> ]
</p>


<pre>
&gt; * Ben Okopnik &lt;ben@linuxgazette.net&gt; [2008-07-05 11:42]:
&gt; &gt; 
&gt; &gt; This, I find, leads to a lot less confusion than letting a user see
&gt; &gt; 
&gt; &gt; ``
&gt; &gt; Can't locate Foo/Bar.pm in @INC (@INC contains: /etc/perl /usr/local/lib/perl/5.8.8 /usr/local/share/perl/5.8.8 /usr/lib/perl5 /usr/share/perl5 /usr/lib/perl/5.8 /usr/share/perl/5.8 /usr/local/lib/site_perl /usr/local/lib/perl/5.8.7 /usr/local/share/perl/5.8.7 .).
&gt; &gt; BEGIN failed--compilation aborted.
&gt; &gt; ''
&gt; 
&gt; Thanks again for the further suggestions.  I changed the script again and
&gt; put the new version in the URL above.
&gt; 
&gt; &gt; Thanks for your effort, Rafael. Given that we've had a number of people
&gt; &gt; email us about it over time, I'm sure that it'll be put to good use.
&gt; 
&gt; Will my script be referenced somewhere in the LN web site.
</pre>

<p>
Assuming that you mean 'LG', yes - that's why I've been CCing The Answer
Gang on our exchanges. TAG is our way of getting this kind of info out
to the world.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href="http://LinuxGazette.NET">http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_116_herrmann">Back</a><hr width="50%" align="left" /><p><br /></p></div>
</body>
</html>