
<html>
<head>
<link href="../lg.css" rel="stylesheet" type="text/css" media="screen, projection"  />
<link rel="shortcut icon" href="../favicon.ico" />
<title>Are Your Servers Secure??? LG #111</title>

<style type="text/css" media="screen, projection">
<!--

-->
</style>

<link rel="alternate" type="application/rss+xml" title="LG RSS" href="lg.rss" />
<link rel="alternate" type="application/rdf+xml" title="LG RDF" href="lg.rdf" />
<link rel="alternate" type="application/atom+xml" title="LG Atom" href="lg.atom.xml" />

</head>

<body>


<img src="../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
<p id="fun">...making Linux just a little more fun!</p>


<div class="content articlecontent">

<div id="previousnexttop">
<A HREF="lg_bytes.html" >&lt;-- prev</A> | <A HREF="engel.html" >next --&gt;</A>
</div>



<h1>Are Your Servers Secure???</h1>
<p id="by"><b>By <A HREF="../authors/cherian.html">Blessen Cherian</A></b></p>

<p>
<p>In a word, <em>No</em>. No machine connected to the internet is
100% secure. This doesn't mean that you are helpless. You can take
measures to avoid hacks, but you cannot avoid them completely. This
is like a house &mdash; when the windows and doors are open then
the probability of a thief coming in is high, but if the doors and
windows are closed and locked the probability of being robbed is
less, but still not nil.</p>

<h3>1 What is Information Security?</h3>

<p>For our purposes, Information Security means the methods we use
to protect sensitive data from unauthorized users.</p>

<h3>2 Why do we need Information Security?</h3>

<p><!-- Cliche Alert - Danger, Will Robinson --> The entire world
is rapidly becoming IT enabled. Wherever you look, computer
technology has revolutionized the way things operate. Some examples
are airports, seaports, telecommunication industries, and TV
broadcasting, all of which are thriving as a result of the use of
IT. "IT is everywhere."</p>

<p>A lot of sensitive information passes through the Internet, such
as credit card data, mission critical server passwords, and
important files. There is always a chance of some one viewing
and/or modifying the data while it is in transmission. There are
countless horror stories of what happens when an outsider gets
someone's credit card or financial information. He or she can use
it in any way they like and could even destroy you and your
business by taking or destroying all your assets. As we all know
"An ounce of prevention beats a pound of cure," so to avoid such
critical situations, it is advisable to have a good security policy
and security implementation.</p>

<h3>3 Security Framework</h3>

<p>The following illustrates the framework needed to implement a 
functioning security implementation:</p>

<pre>
       [ Risk Analysis ]   [ Business Requirements ]

                         |

                [ Security Policy ]

                         |

       [ Security Service, Mechanisms, and Objects ]

                         |

[ Security Management, Monitoring, Detection and Response ]
</pre>

<p>This framework shows the basic steps in the life cycle of
securing a system. "Risk Analysis" deals with the risk associated
with the data in the server to be secured. "Business Requirements"
is the study which deals with the actual requirements for
conducting business. These two components cover the business
aspects of the security implementation.</p>

<p>The "Security Policy" covers 8 specific areas of the security 
implementation, and is discussed in more detail in section <b>4</b> 
below. "Security Service, Mechanisms and Objects" is actually the 
implementation part of security. "Security Management, Monitoring, 
Detection and Response" is the operational face of security, where 
we cover the specifics of how we find a security breach, and how we 
react if a breach is found.</p>

<h3>4 Security Policy</h3>

<p>The Security Policy is a document which addresses the following
areas:</p>

<ol>
<li>Authentication: This section deals with what methods are used
to determine if a user is real or not, which users can or cannot
access the system, the minimum length of password allowed, how long
can a user be idle before he is logged out, etc.</li>

<li>Authorization: This area deals with classifying user levels and
what each level is allowed to do on the system, which users can
become root, etc.</li>

<li>Data Protection: Data protection deals with the details like
what data should be protected and who can access which levels of
data on the system.</li>

<li>Internet Access: This area deals with the details of the users
having access to the internet and what they can do there.</li>

<li>Internet Services: This section deals with what services on the
server are accessible from the internet and which are not.</li>

<li>Security Audit: This area addresses how audit and review of
security related areas and processes will be done.</li>

<li>Incident Handling: This area addresses the steps and measures
to be taken if there is a breach of security. This also covers the
steps to find out the actual culprit and the methods to prevent
future incidents.</li>

<li>Responsibilities: This part covers who will be contacted at any
given stage of an incident and the responsibilities of the
administrator(s) during and after the incident. This is a very
important area, since the operation of the incident handling
mechanism is dependent on it.</li>
</ol>

<h3>5 Types of Information Security</h3>

<p>There are 2 types of security. (1) Physical security / Host
Security and (2) Network security. Each of these sections has 3
parts:</p>

<ol>
<li>Protection: Slow down or stop intrusions or damage</li>

<li>Detection: Alert someone if a breach (or attempted breach) of
security occurs, and quantify and qualify what sort of damage
occurred or would have occurred.</li>

<li>Recovery: Re-secure the system or data after the breach or
damage and where possible, undo whatever damage occurred</li>
</ol>

<h4>5.1 Host Security / Physical Security</h4>

<p>Host Security / Physical Security means securing the server from 
unauthorized access. For that we can password protect the box with 
such steps as setting up a bios password, placing the computer box 
in a locked room where only authorized users have access, applying 
OS security patches, and checking logs on regular basis for any 
intrusion and attacks. In Host security we check and correct the 
permissions on all OS related files.</p>

<h4>5.2 Network security</h4>

<p>Network security is one of the most important aspects of overall 
security. As I mentioned earlier, no machine connected to the 
internet is completely secure, so security administrators and server 
owners need to be alert, and make sure that they are informed of all 
new bugs and exploits that are discovered. Failure to keep up with 
these may leave you at the mercy of some script kiddy.</p>

<!-- 29 Jan 2005 dsrich - Moved this down where it made more sense to me -->
<h4>5.3 Which operating system is the most secure?</h4>

<p>Every OS has its own pros and cons. There are ways to make
Windows more secure, but the implementation is quite costly. Linux
is stable and reasonably secure, but many companies perceive it as
having little vendor support. My vote for the best OS for security
purposes goes to FreeBSD, another free Unix-like OS, but not many
people are aware of its existence.</p>

<h3>6 Is a firewall the final solution to the Network Security problem?</h3>

<p>No, a firewall is just a part of the security implementation.
Again, we will use the example of a house. In a house all the
windows and doors can be closed but if the lock on the front door
of the house is so bad that someone can put just any key-like thing
in and open it, then what is the use of the house being all closed
up? Similarly, if we have a strong firewall policy, it will
restrict unauthorized access, but if the software running on the
box is outdated or full of bugs then crackers can use it to intrude
into the server and gain root access. This shows that a firewall is
not the final solution. A planned security implementation is the
only real quality solution to this issue.</p>

<h3>7 Security is a continuous process</h3>

<p>Continuing security is a on-going process. Security
administrators can only conduct their work on the basis of the
alerts and bugfixes released up to the date of securing, so in
order to accommodate all of the fixes for the latest bugs, security
work has to be done on a regular basis.</p>

<h3>8 Does Security implementation create overhead and/or reduce
performance?</h3>

<p>Yes, Security implementation creates a small amount of overhead,
but it need not reduce overall performance drastically. In order to
take care of such things, a well done security implementation has
an optimization section where the security administration gives
priority to both performance and security. While securing any
software, we should secure it in such a way that it provides
maximum performance.</p>

<h3>9 Security Audits - What Should be Checked</h3>

<p>A security audit is a part of security implementation where we
try to find out the vulnerabilities of the system and suggest actions
to improve the security. In a normal audit, the points below should
be checked, and a report with the results of that audit should be
created.</p>

<ol>
<li>Check intrusion detection. Use chkrootkit or rkhunter for this
purpose.</li>

<li>Check for known bugs in the software installed on the server -
the kernel, openssl, openssh, etc.</li>

<li>Scan all network ports and find out which ports are open.
Report the ports that should not be open and what program is
listening on them.</li>

<li>Check whether /tmp is secured.</li>

<li>Check for hidden processes.</li>

<li>Check for bad disk blocks in all partitions. (This is just to
make sure that the system is reasonably healthy.)</li>

<li>Check for unsafe file permissions.</li>

<li>Check whether the kernel has a ptrace vulnerability.</li>

<li>Check the memory (Another system health check.)</li>

<li>Check if the server is an open e-mail relay.</li>

<li>Check if the partitions have enough free space.</li>

<li>Check the size of the log files. It's better that the log size
remains in megabytes.</li>
</ol>

<h3>10 How to know if you are being hacked?</h3>

<p>To find out if your box is compromised or not, follow these
steps. These are the steps which I used to do and will be handy in
most of the situations.</p>

<h4>10.1 Check your box to see if your performance has degraded or
if your machine is being over used.</h4>

<p>For that, use the commands</p>

<dl>
<dt><strong>vmstat</strong></dt>

<dd>Displays information about memory, cpu and disk.</dd>
</dl>

<blockquote>Ex: <em>bash#</em> <tt>vmstat 1 4</tt> (where 1 is
delay and 4 is count)</blockquote>

<dl>
<dt><strong>mpstat</strong></dt>

<dd>Displays statistics about cpu utilization. This will help us to
see if your cpu is over worked or not.</dd>
</dl>

<blockquote>Ex: <em>bash#</em> <tt>mpstat 1 4</tt> (where 1 is
delay and 4 is count)</blockquote>

<dl>
<dt><strong>iostat</strong></dt>

<dd>This command displays statistics about the disk system.</dd>
</dl>

<blockquote>Useful options:</blockquote>

<blockquote>-d - Gives the device utilization report.</blockquote>

<blockquote>-k - Display statistics in kilobytes per
second.</blockquote>

<blockquote>Ex: <em>bash#</em> <tt>iostat -dk 1 4</tt> (where 1 is
delay and 4 is count)</blockquote>

<dl>
<dt><strong>sar</strong></dt>

<dd>Displays overall system performance.</dd>
</dl>

<h3>10.2 Check to see if your server has any hidden processes
running.</h3>

<dl>
<dt><strong>ps</strong></dt>

<dd>Displays the status of all known processes.</dd>

<dt><strong>lsof</strong></dt>

<dd>List all open files. In Linux everything is considered a file,
so you will be able to see almost all of the activity on your
system with this command.</dd>
</dl>

<h3>10.3 Use Intrusion Detection Tools</h3>

<ul>
<li>rkHunter ( <a href="http://www.rootkit.nl/">http://www.rootkit.nl/</a> )</li>

<li>chkrootkit ( <a href="http://www.chkrootkit.org/">http://www.chkrootkit.org/</a> )</li>
</ul>

<h3>10.4 Check your machine's <tt>uptime</tt>.</h3>

<p>If the uptime is less than it should be, this can mean that your
machine's resources are being used by someone. Linux doesn't crash
or reboot under normal conditions because it is such a stable OS.
If your machine has been rebooted try to find out the actual reason
behind it.</p>

<h3>10.5 Determine what your unknown processes are and what they are
doing.</h3>

<h4>10.5.0.1 Use commands like the following to take apart unknown
programs</h4>

<dl>
<dt><strong>readelf</strong></dt>

<dd>This command will display what the executable's program is
performing.</dd>

<dt><strong>ldd</strong></dt>

<dd>This command will show the details of libraries used by a
executable.</dd>

<dt><strong>string</strong></dt>

<dd>This command will display the strings in the binary.</dd>

<dt><strong>strace</strong></dt>

<dd>This command will display the system calls a program makes as
it runs.</dd>
</dl>

<h3>11 Hardening Methodology</h3>

<ol>
<li>Read all security related sites and keep up to date. This is
one of the main things a security administrator or server owner
should do. Server owners should be made aware of security and its
importance. Security training is an important part of an overall
security package.</li>

<li>Create a good security policy. Conduct security audits on the
basis of this policy.</li>

<li>Keep your OS updated by applying all patches.</li>

<li>Install a custom kernel with all unwanted services removed and
patched with either grsecurity or openwall.</li>

<li>Disable all unwanted services and harden the services you leave
running; Change file and directory permissions so that security is
tightened.</li>

<li>Install a firewall and create good rule sets.</li>

<li>Test and audit the server on regular basis</li>

<li>Install an intrusion detection system, log monitor, all of the
Apache security modules, bfd, faf and tmp monitor. Make your
partitions secure.</li>

<li>Run a good backup system to recover data in case of an
intrusion, crash, or other destructive incident.</li>

<li>Install a log analyzer and check your logs for any suspicious
entries.</li>

<li>Install scripts to send out mail or enable notifications when a
security breach occurs.</li>

<li>After a security breach try to find out how, when and through
what the breach occurred. When you find a fix for it, document the
details for future reference.</li>
</ol>

<h3>12 Summary</h3>

<p>Now lets conclude by covering the main steps by which a
hosting server can be secured.</p>

<p><b>12.1 Determine the business requirements and risk factors
which are applicable to this system</b></p>

<p><b>12.2 Devise a security policy with the above data in mind.
Get management's approval and signoff on this security
policy.</b></p>

<p><b>12.3 On approval of the policy, do a security audit on any
existing systems to determine the current vulnerabilities and
submit a report regarding this to the management.</b></p>

<p> The report should also cover the methods needed to improve existing
security.
A quick checklist:</p>

<ul>
<li>Software Vulnerabilities.</li>

<li>Kernel Upgrades and vulnerabilities.</li>

<li>Check for any Trojans.</li>

<li>Run chkrootkit.</li>

<li>Check ports.</li>

<li>Check for any hidden processes.</li>

<li>Use audittools to check system.</li>

<li>Check logs.</li>

<li>Check binaries and RPMS.</li>

<li>Check for open email relays.</li>

<li>Check for malicious cron entries.</li>

<li>Check /dev /tmp /var directories.</li>

<li>Check whether backups are maintained.</li>

<li>Check for unwanted users, groups, etc. on the system.</li>

<li>Check for and disable any unneeded services.</li>

<li>Locate malicious scripts.</li>

<li>Querylog in DNS.</li>

<li>Check for the suid scripts and nouser scripts.</li>

<li>Check valid scripts in /tmp.</li>

<li>Use intrusion detection tools.</li>

<li>Check the system performance.</li>

<li>Check memory performance (run <tt>memtest</tt>).</li>
</ul>

<h4>12.4 Implement the security policy</h4>

<p><b>12.4.1 Correct all known existing software vulnerabilities
either by applying patches or by upgrading the software.</b></p>

<p><b>12.4.2 Implement host security</b></p>

<ul>
<li>Protect your systems with passwords</li>

<li>Check the file systems and set correct permissions and
ownerships on all directories and files</li>
</ul>

<blockquote><tt>chmod -R 700 /etc/rc.d/init.d/*</tt></blockquote>

<blockquote>Use <tt>rpm -Va</tt> to find out if an rpm is
modified</blockquote>

<ul>
<li>Apply security patches to vulnerable software (ie. <tt>patch
-p1 &lt; <em>patch file</em></tt>)</li>

<li>Remove all unneeded ttys and console logins by removing the
entry from /etc/securetty</li>

<li>Check system logs (eg: /var/log/messages, /var/log/secure,
etc.)</li>

<li>Set a password on the boot loader (lilo and grub both support
this)</li>

<li>Monitor the system (nagios or big brother)</li>
</ul>

<h4>12.4.3 Implement Network security</h4>

<ul>
<li>Remove all unwanted users and groups.</li>

<li>Use custom security scripts which will send out notification
when sshing as root or while creating a user with uid of 0,
etc.</li>

<li>Require passwords with 16 characters (can be done by making
changes in login.def).</li>

<li>Disable unwanted services using tcpwrapper (unwanted services
can also be disabled through xinet.d or xinetd.Conf).</li>

<li>Set up an idle timeout, so that idle users will be logged out
after a certain amount of time.</li>

<li>Disable all console program access (eg: <tt>rm -rf
/etc/security/console.app/<em>&lt;service name
&gt;</em></tt>.)</li>

<li>Enable nospoof option in /etc/host.conf.</li>

<li>Specify the order in which domain names should be resolved (eg:
order bind hosts).</li>

<li>Lock the /etc/services file so that no one can modify it.</li>

<li>Restrict direct root login (comment out the PermitRootLogin
login option in sshd_config).</li>

<li>Restrict su, so that only wheel group members are able to su.
(can use pam or disable the permission of other for the su
binary).</li>

<li>Limit users resources (using pam, specify the limits for each
user in /etc/security/limit.conf).</li>

<li>Secure /tmp (mount /tmp with noexec,nodev,nosuid).</li>

<li>Hide the server details. Remove /etc/issues and
/etc/issues.net.</li>

<li>Disable unwanted suid and sgid files (eg: <tt>find -type -perm
-04000 -o perm 02000</tt>.)</li>
</ul>

<blockquote>Examples of these: <tt>gpasswd</tt>, <tt>wall</tt>,
and <tt>traceroute</tt></blockquote>

<ul>
<li>Using iptables, allow only pings from a specific locations (for
monitoring systems to work).</li>

<li>Take preventive measures against DOS, "ping of death" attacks, etc.</li>

<li>Install a firewall (eg: apf and iptables) and only allow ports
to operate which the box needs for its normal functions; block all
other ports to prevent mischief.</li>
</ul>

<blockquote>Links: <a href=
"http://rfxnetworks.com/">http://rfxnetworks.com/</a> and <a href=
"http://yolinux.com/TUTORIALS/LinuxTutorialIptablesNetworkGateway.html">
http://yolinux.com/TUTORIALS/LinuxTutorialIptablesNetworkGateway.html</a></blockquote>

<ul>
<li>Install intrusion detection (eg: install <tt>tripwire</tt> or
<tt>aide</tt>).</li>
</ul>

<blockquote>Links: 
<a href="http://www.cs.tut.fi/rammer/aide.html">http://www.cs.tut.fi/rammer/aide.html</a> and
<a href=
"http://redhat.com/docs/manuals/linux/RHL-9-Manual/ref-guide/ch-tripwire.html">
http://redhat.com/docs/manuals/linux/RHL-9-Manual/ref-guide/ch-tripwire.html</a></blockquote>

<ul>
<li>Install <tt>sxid</tt> to keep an eye on suid and sgid
scripts.</li>
</ul>

<blockquote>Link: <a href=
"http://linux.cudeso.be/linuxdoc/sxid.php">http://linux.cudeso.be/linuxdoc/sxid.php</a></blockquote>

<ul>
<li>Restrict ssh to specific IP addresses and specific users (I
suggest key authentication using passphrase).</li>

<li>Install logcheck to check the logs.</li>

<li>Install tmpwatch to delete the unused files from /tmp
directory.</li>

<li>Install and setup portsentry and configure it to use iptables
to block IPs.</li>

<li>Install mod_security and mod_dosevasive to safe guard
apache.</li>

<li>Delete files with nouser and nogroup.</li>

<li>Deleted unwanted files/folders in htdocs, disable directory
indexing.</li>

<li>Check for unwanted scripts in /root, /usr/local,
/var/spool/mbox.</li>

<li>Install BFD and FAF for additional security.</li>

<li>Disable open email relaying.</li>

<li>Submit a status report to management detailing all discovered
vulnerabilities and fixes.</li>
</ul>

<h3>12.5 Testing phase</h3>

<p>Use tools like nessus, nikto, and nmap to do a penetration test
and see how well your server is secured. Also do a stress test.</p>

<p>Security is of utmost importance to a server, compromising
security is compromising the server itself. Hence, an understanding
of the same is a prerequisite to server ownership and
administration.</p>

<h3>About this document...</h3>

<p>This document was generated using the <a href=
"http://www.latex2html.org/"><strong>LaTeX</strong>2<tt>HTML</tt></a>
translator Version 2002 (1.62)</p>

</p>


<!-- *** BEGIN author bio *** -->
<P>&nbsp;
<P>
<img align="left" alt="[BIO]" src="../gx/authors/cherian.jpg" class="bio">

<em>

<p> My name is Blessen and I prefer people calling me Bless. I got
interested in Linux when I joined the software firm, <a
href="http://poornam.com">Poornam Info Vision Pvt Ltd</a> also known as <a
href="http://bobcares.com">Bobcares</a>. They gave me exposure to linux.

<p> I am a B.Tech in Computer Science from the College of Engineering,
Chengannur. I passed out in the year 2001 and got into the company that
year. During my work, I was passionate with Linux security and I look
forward to grow in that field.

<p> My hobbies are browsing net, learning new technologies and helping
others. In my free time I also develop open source softwares and one of
them is a scaled down version of formmail. The project is called "Smart
Mail" which is more secure than formmail.

</em>
<br clear="all">
<!-- *** END bio *** -->

<!-- *** END author bio *** -->

<div id="articlefooter">

<p>
Copyright &copy; 2005, Blessen Cherian. Released under the <a
href="http://linuxgazette.net/copying.html">Open Publication license</a>
unless otherwise noted in the body of the article. Linux Gazette is not
produced, sponsored, or endorsed by its prior host, SSC, Inc.
</p>

<p>
Published in Issue 111 of Linux Gazette, February 2005
</p>

</div>


<div id="previousnextbottom">
<A HREF="lg_bytes.html" >&lt;-- prev</A> | <A HREF="engel.html" >next --&gt;</A>
</div>


</div>






<div id="navigation">

<a href="../index.html">Home</a>
<a href="../faq/index.html">FAQ</a>
<a href="../lg_index.html">Site Map</a>
<a href="../mirrors.html">Mirrors</a>
<a href="../mirrors.html">Translations</a>
<a href="../search.html">Search</a>
<a href="../archives.html">Archives</a>
<a href="../authors/index.html">Authors</a>
<a href="../contact.html">Contact Us</a>

</div>



<div id="breadcrumbs">

<a href="../index.html">Home</a> &gt; 
<a href="index.html">February 2005 (#111)</a> &gt; 
Article

</div>





<img src="../gx/tux_86x95_indexed.png" id="tux" alt="Tux"/>




</body>
</html>

