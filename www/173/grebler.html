<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="utf-8" xml:lang="utf-8">
<head>
<title>Pixie Chronicles: Part 1 Lessons from Mistakes LG #173</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../lg.css" type="text/css" media="screen, projection"  />
<link rel="alternate" type="application/rss+xml" title="LG RSS" href="../lg.rss" />
<link rel="alternate" type="application/rdf+xml" title="LG RDF" href="../lg.rdf" />
<!-- link rel="alternate" type="application/atom+xml" title="LG Atom" href="lg.atom.xml" / -->
<link rel="shortcut icon" href="../favicon.ico" />

<style type="text/css" media="screen, projection">
<!--

-->
</style>

</head>
<body>

<a href="../">
<img src="../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
</a>
<p id="fun">...making Linux just a little more fun!</p>

<div id="navigation">
<table summary="masthead" width="100%">
<tr>
<td align="center" colspan="3" style="font-size: 10px; font-weight: bold">
<a href="../index.html">Home</a>
<a href="http://linuxgazette.net">Main Site</a>
<a href="../faq/index.html">FAQ</a>

<a href="../lg_index.html">Site Map</a>
<a href="../mirrors.html">Mirrors</a>
<a href="../mirrors.html">Translations</a>
<a href="../search.html">Search</a>
<a href="../archives.html">Archives</a>
<a href="../authors/index.html">Authors</a>
<a href="http://lists.linuxgazette.net/listinfo.cgi">Mailing Lists</a>
<a href="../jobs.html">Join Us!</a>
<a href="../contact.html">Contact Us</a>

<hr width="99%" style="border: 1px inset #000033">
</td>
</tr>
<tr>
<td width="40%" align="left" style="font-size: 10px; font-weight: bold">
The Free International Online Linux Monthly
</td>
<td width="20%" align="center" style="font-size: 10px; font-weight: bold">
ISSN: 1934-371X
</td>
<td width="40%" align="right" style="font-size: 10px; font-weight: bold">
Main site: <a href="http://linuxgazette.net">http://linuxgazette.net</a> 
</td>
</table>
</div>


<div id="breadcrumbs1">

<a href="../index.html">Home</a> &gt; 
<a href="index.html">April 2010 (#173)</a> &gt; 
Article

</div>

<div class="articlecontent1">
<div class="content">

<div id="previousnexttop">
<A HREF="dyckoff.html" >&lt;-- prev</A> | <A HREF="grebler1.html" >next --&gt;</A>
</div>

<h1>Pixie Chronicles: Part 1 Lessons from Mistakes</h1>
<p id="by"><b>By <a href="../authors/grebler.html">Henry Grebler</a></b></p>


<h3>Adam</h3>

<p>
I had a friend, Adam, who passed away far too young. Adam seemed to be
competent at an amazing number of activities, mostly self-taught. He
built himself a house almost single-handedly.
</p>

<p>
He once shared with me the secret of building. Adam would say that it
was not possible to build a house without making mistakes. The secret,
he said, was hiding your mistakes. For example, builders can never get
the floor and walls to fit together exactly. So they invented skirting
boards; for walls and ceiling: mouldings and cornices.
</p>

<p>
Subsequently, somebody must have decided to extend the concept and
they became decorative. Now that's <em>really</em> hiding your mistakes -
pretend that they are a feature!
</p>

<p>
Perhaps because I know (or think I know) more than the average bear
about Linux, I get "adventurous", particularly on my projects at home.
When I extend my activities beyond my areas of competence I frequently
make mistakes. That's not intrinsically a bad thing: you have to break
eggs to make an omelette. But it's important to be able to recover
from mistakes.
</p>

<p>
As a result, I've adapted Adam's advice to fields which interest me.
</p>

<h3>Project</h3>

<p>
My project for last week was to build a server. Sounds simple. What
could possibly go wrong? Watch and learn.
</p>

<p>
I run (the fairly old) Fedora Core 5 on my desktop, so I thought I'd
install the latest Fedora on my server. I say "server" but it's
actually a Pentium II, one of a pair a friend was throwing out. The
other one replaced my aging (12-year-old Pentium 1 100) firewall.
</p>

<p>
But my project is more about concept than commercial-strength mail and
web-serving, so grunt<a id="grebler.html_1_back"></a><a href="#grebler.html_1">[1]</a> is not important to me.
</p>

<p>
Installing from CDs holds no fascination for me: I've done it so many
times, the novelty has worn off. I decided I'd do a "Look, Ma! No
hands!" install.
</p>

<p>
The Pentium II was a Compaq which must have been quite leading edge
when it was purchased. Of particular interest was the fact that it had
on-board hardware PXE capability. I conceived a plan which would see
the machine perform a network boot, then perform a network
install driven by a kickstart file. Everything would be
automatic: partitioning, timezone, system language, configuration of 2
NICs, root password - the lot.
</p>

<p>
As an exercise in building a single server, this approach is not very
efficient. However, as an exercise in building multiple servers, it is
excellent. One of the dangers of having a human (me) perform the same
task repeatedly is that boredom sets in and the human (me) loses
concentration, leading to mistakes. It is worth investing effort into
automating the process. Although I currently have neither the hardware
nor the need to build a farm of servers, I would like to learn the
technique for the future. So for me, this is a learning exercise.
</p>

<p>
The following sections are written from the perspective of the machine
to be built, which I'll call the target machine.
</p>

<h3>Typical Install</h3>

<p>
To provide some context, here is an overview of a typical
install. Bear in mind that my old Compaq only has a CD drive (not
DVD).
</p>

<ol>
<li> Turn on the target machine.
<li> Insert the first install CD.
<ul>
	<li> Machine boots from the removable disk, loading the install environment.
</ul>
<li> Proceed through many screens answering questions about partitioning, timezone, system language, etc.
<ul>
	<li>The machine begins to install from the first CD. 
	<li>After a while, the machine asks for the second CD.
</ul>
<li> Change CDs.
<li> Repeat until all 6 install CDs have been processed.
</ol>

<p>
Note that the numbered steps involve human intervention. The indented
sentences describe the target machine's behaviour.
</p>

<h3>Intended Install</h3>

<p>
Here is my rough plan for how things were supposed to go. 
</p>

<ol>
<li> Turn on the target machine.
<ul>
	<li> Machine starts the boot process, asks the network for an IP
	address, then downloads the install environment.

	<li> The install environment uses the kickstart file to guide
	the rest of the install. It obtains the install
	files from the network. No further intervention is required.
</ul>
</ol>
</pre>

<h3>Actual First Attempt</h3>

<p>
And here's what happened the first time.
</p>

<ol>
<li> I turned on the target machine.
<ul>
	<li> The machine booted, asked the network for an IP address, then
	downloaded the install environment.

	<li> The install environment used the kickstart file to guide
	the rest of the install. 
</ul>
</ol>

<p>
However, it was here that I discovered the first of several mistakes.
</p>

<p>
I had not defined the partitioning information completely, so the
machine stopped to ask for clarification. 
</p>

<p>
I guess I could have gone back and fixed the problem and restarted,
but it occurred to me that I might have made other mistakes. I decided
to answer the partitioning questions and proceed.
</p>

<p>
Remarkably, that was the only problem. Or so it seemed. The
install proceeded. It seemed to take a very long time, but I was
not too surprised by this: the target machine is, after all, a Pentium II.
</p>

<p>
It is at this stage that a kickstart install starts to pay back. The
install may take a long time, but I don't have to stay around to
change CDs. There are always other tasks to be done, and in this case
I left the room for several hours.
</p>

<p>
On my return, the machine was again asking for clarification about
partitioning!
</p>

<p>
What had happened?!
</p>

<h3>Things Go Wrong</h3>

<p>
There is a temptation when things go wrong to start <em>doing</em>. This
is almost invariably bad. It often leads to <em>regretting</em>!
It takes some discipline and experience to stop and <em>think</em>.
</p>

<p>
"Doing" quite often leads to activities which modify the "crime scene".
One then gets to a point where one wants to know what something looked
like before the "doing" began. Too late.
</p>

<p>
"Thinking" doesn't prevent all mistakes, only some.
</p>

<p>

What had gone wrong?
</p>

<p>
How does one even begin to think in such a case? Well, every activity
typically has a beginning, a middle, and an end.
</p>

<p>
The install had started ok. I'd then had the partitioning
problem. After that, the install seemed to proceed as expected.
So beginning and middle seemed to be off the hook. I concluded that I
should look at the end. 
</p>

<p>
What should have happened after the install completed?
</p>

<p>
I remembered that one of the kickstart parameters related to this.
I had requested that the machine reboot after install.
</p>

<p>
In an install from CD, once the install environment has processed
the last CD, it asks the user to remove any install media from
the drive. By default, when the machine subsequently reboots, it takes
its data from the recently installed hard drive.
</p>

<p>
However, in my case, on reboot, the machine performed its PXE boot -
which restarted the install process. Thank heavens for my
partitioning mistake. Without it, the install would have
proceeded as before, come to the end - and started all over again. It
might still be at it now, repeatedly booting and installing!
</p>

<p>
I guess after a few days I might have grown suspicious.
</p>

<p>
It's an ill wind that blows no good; and sometimes, as in this case, a
mistake can be your friend.
</p>

<h3>Analysis</h3>

<p>
My first mistake was unexceptional. To install FC10 I needed to get a
number of steps right. As we shall soon see, I've glossed over some of
the steps to tell this part of the story simply. It is unsurprising
that I did not get everything right the first time. (I would have been
very surprised had everything just worked!)
</p>

<p>
The second mistake was much more interesting. It relates to the case
where an action is repeated but the conditions change between the
first and a later occurrence of that action. It's the sort of problem
that is common in loops.
</p>

<p>
In this case, the first time I booted the machine, I wanted it to use
PXE; the second time, I didn't. I hadn't realised that I had wanted
different behaviours.
</p>

<p>
Even stated like this, it was not clear to me what to do next. At
first sight, the simple solution is to request that the install
environment <em>not</em> reboot at the end of the install. But, as we
shall see in the next part, that solution is somewhat short-sighted.
</p>

<h3>Lessons</h3>

<p>
When something goes wrong, don't rush to act. Stop, think, and plan
before acting.
</p>

<hr>

<p class="editorial"><a id="grebler.html_1"></a><a href="#grebler.html_1_back">[1]</a>
Reading Henry's articles is giving me a great workout in Aussie
colloquialisms - "grunt" in this case, I'm told, means "muscle", i.e.
computing power. -- Kat
</p>


<br clear="all" />

<script type='text/javascript'>
digg_url = 'http://linuxgazette.net/173/grebler.html';
digg_title = 'Pixie Chronicles: Part 1 Lessons from Mistakes';
digg_bodytext = '<p> I had a friend, Adam, who passed away far too young. Adam seemed to be competent at an amazing number of activities, mostly self-taught. He built himself a house almost single-handedly. </p> ';
digg_topic = 'linux_unix';
</script>
<script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>


<p class="talkback">
Talkback: <a
href="mailto:tag@lists.linuxgazette.net?subject=Talkback:173/grebler.html">Discuss this article with The Answer Gang</a>
</p>

<!-- *** BEGIN author bio *** -->
<hr>
<p>
<img align="left" alt="[BIO]" src="../gx/authors/grebler.jpg" class="bio">
</p>

<em>
<p>
Henry was born in Germany in 1946, migrating to Australia in 1950. In
 his childhood, he taught himself to take apart the family radio and put
 it back together again - with very few parts left over.
</p>

<p>
After ignominiously flunking out of Medicine (best result: a sup in
 Biochemistry - which he flunked), he switched to Computation, the name
 given to the nascent field which would become Computer Science. His
 early computer experience includes relics such as punch cards, paper
 tape and mag tape.
</p>

<p>
He has spent his days working with computers, mostly for computer
 manufacturers or software developers. It is his darkest secret that he
 has been paid to do the sorts of things he would have paid money to be
 allowed to do. Just don't tell any of his employers.
</p>

<p>
He has used Linux as his personal home desktop since the family got its
 first PC in 1996. Back then, when the family shared the one PC, it was a
 dual-boot Windows/Slackware setup. Now that each member has his/her own
 computer, Henry somehow survives in a purely Linux world.
</p>

<p>
He lives in a suburb of Melbourne, Australia.
</p>



</em>

<br clear="all">


<!-- *** END author bio *** -->

<div id="articlefooter">

<p>
Copyright &copy; 2010, Henry Grebler. Released under the <a
href="http://linuxgazette.net/copying.html">Open Publication License</a>
unless otherwise noted in the body of the article. Linux Gazette is not
produced, sponsored, or endorsed by its prior host, SSC, Inc.
</p>

<p>
Published in Issue 173 of Linux Gazette, April 2010
</p>

</div>

<div id="previousnextbottom">
<A HREF="dyckoff.html" >&lt;-- prev</A> | <A HREF="grebler1.html" >next --&gt;</A>
</div>

</div>
</div>

<script src="http://www.google-analytics.com/urchin.js"
type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1204316-1";
urchinTracker();
</script>







<img src="../gx/tux_86x95_indexed.png" id="tux" alt="Tux"/>

</body>
</html>

