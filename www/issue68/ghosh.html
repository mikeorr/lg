<!--startcut  ==============================================-->
<!-- *** BEGIN HTML header *** -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML><HEAD>
<title>Compiling and Installing a Linux Kernel LG #68</title>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#0000AF"
ALINK="#FF0000">
<!-- *** END HTML header *** -->

<CENTER>
<A HREF="http://www.linuxgazette.net/">
<IMG ALT="LINUX GAZETTE" SRC="../gx/lglogo.png" 
	WIDTH="600" HEIGHT="124" border="0"></A> 
<BR>

<!-- *** BEGIN navbar *** -->
<IMG ALT="" SRC="../gx/navbar/left.jpg" WIDTH="14" HEIGHT="45" BORDER="0" ALIGN="bottom"><A HREF="dellomodarme.html"><IMG ALT="[ Prev ]" SRC="../gx/navbar/prev.jpg" WIDTH="16" HEIGHT="45" BORDER="0" ALIGN="bottom"></A><A HREF="index.html"><IMG ALT="[ Table of Contents ]" SRC="../gx/navbar/toc.jpg" WIDTH="220" HEIGHT="45" BORDER="0" ALIGN="bottom" ></A><A HREF="../index.html"><IMG ALT="[ Front Page ]" SRC="../gx/navbar/frontpage.jpg" WIDTH="137" HEIGHT="45" BORDER="0" ALIGN="bottom"></A><IMG ALT="[ Talkback ]" SRC="../gx/navbar/talkback.jpg" WIDTH="121" HEIGHT="45" BORDER="0" ALIGN="bottom"  ><A HREF="../faq/index.html"><IMG ALT="[ FAQ ]" SRC="./../gx/navbar/faq.jpg"WIDTH="62" HEIGHT="45" BORDER="0" ALIGN="bottom"></A><A HREF="jenkins.html"><IMG ALT="[ Next ]" SRC="../gx/navbar/next.jpg" WIDTH="15" HEIGHT="45" BORDER="0" ALIGN="bottom"  ></A><IMG ALT="" SRC="../gx/navbar/right.jpg" WIDTH="15" HEIGHT="45" ALIGN="bottom">
<!-- *** END navbar *** -->
<P>
</CENTER>

<!--endcut ============================================================-->

<H4 ALIGN="center">
"Linux Gazette...<I>making Linux just a little more fun!</I>"
</H4>

<P> <HR> <P> 
<!--===================================================================-->

<center>
<H1><font color="maroon">Compiling and Installing a Linux Kernel</font></H1>
<H4>By <a href="mailto:auspicious_blessingsindia@hotmail.com">Subhasish Ghosh</a></H4>
</center>
<P> <HR> <P>  

<!-- END header -->




<h4><strong>Abstract:</strong></h4>

<p>Hi everyone, this article provides you with an extremely
detailed and step-by-step process describing how to Compile,
Configure and then Install a Customized Red Hat Linux Kernel. As
we all know, a Customized Kernel is required for many reasons,
and I wouldn't want to go into the details of those. I will only
show how to Compile, Configure and Install a Custom Kernel.
Though the steps mentioned below are primarily targeted for the
Red Hat Linux users, but the same process applies to the users of
other Linux Distributions also, of course, with a few minor
modifications as required.  (For instance, not all systems use
initrd.)</p>

<h4><strong>Main:</strong></h4>

<p>Please note that I have performed all the steps mentioned
below on a computer system with the following configurations:
Compaq Presario 4010 Series computer system, 15.5 GB Hard Disk
Space, 96 MB RAM, 400 MHz Intel Celeron Processor, Red Hat Linux
7.0 Distribution Release.  Underlying Kernel: <strong>2.2.16-22</strong></p>

<h4><strong>Aim:</strong></h4>

<p>Our aim would be to obtain a fully working <strong>Customized
Kernel</strong> after all the steps mentioned below have been
completed, for example, I have a Customized Kernel named
&quot;2.2.16-22ghosh&quot; running on my system (cause my name is
Subhasish Ghosh, you could have anything else, in fact a couple
of them running together!). So, happy hunting and compiling the
Linux Kernel.</p>

<h4><strong>Steps to Compile, Configure and Install a Customized
Red Hat Linux Kernel:</strong></h4>

<p>The steps to be followed are as follows:</p>

<p>Step 1: Login as &quot;<strong>root</strong>&quot; and then
perform these steps.</p>

<p>Step 2: At the command prompt, type in: &quot;<strong>rpm -q
kernel-headers kernel-source make dev86</strong>&quot;</p>

<p>Step 3: If these RPMs are already installed, then proceed to
step 4. Otherwise, mount the Red Hat Linux 7.0 CD-ROM and then
perform a rpm -Uvh for installing these RPMs.</p>

<p>Step 4: If you have a fully working X Window System, then type
in &quot;<strong>startx</strong>&quot; at the command-prompt. In
case you don't have an X Window System configured, I personally
would suggest you to have it done before proceeding cause it
would be extremely beneficial. If X Window System is NOT
configured, then type in &quot;make config&quot; or &quot;make
menuconfig&quot; at the command-prompt. Please note that I have
assumed that you have an X Window System running on your system,
and for that reason, just type in &quot;startx&quot;. </p>

<p>Step 5: Then once within the GNOME environment, open the GNOME
Terminal and type in: &quot;<strong>cd /usr/src/linux</strong>&quot;
and press enter.</p>

<p>Step 6: Then from within /usr/src/linux, type in &quot;<strong>make
xconfig</strong>&quot;. </p>

<p>Step 7: The GUI version of &quot;make config&quot; would come
up on the screen. It provides you with various options that you
have for obtaining a Customized Kernel.</p>

<p>Step 8: Now, I would suggest you to leave most of the default
options just as it is. Just don't try to fiddle around cause most
of the options are sensitive and requires expert handling. Just
make sure you make the following changes: </p>

<p>1.<strong><u>Processor Type and Features</u></strong>: Choose
the correct Processor depending on whether you are working on a
Pentium 2, 3, or Intel Celeron like me. For example, I did the
following: Processor Family: PPro/686MX, Maximum Physical Memory:
1 GB, Math Emulation: Yes, MTRR: Yes, SMP: Yes.</p>

<p>2.Open the <strong><u>Filesystems</u></strong> dialog and then
make the following changes to it: For example I did: DOS FAT fs
support: Yes(y), MSDOS fs support: Yes(y), UMSDOS: m,
VFAT(Windows 95) support: Yes(y), NTFS filesystem support
(read-only): Yes(y), NTFS read-write support(DANGEROUS): No(n).
After you have made these changes, please make sure you haven't
changed the others in the process. All these above-mentioned
changes are quite harmless and won't cause any harm to your
existing Linux Kernel. </p>

<p>3.Save and Exit from the Main dialog. </p>

<p>Step 9: Then, perform a &quot;<strong>ls -al</strong>&quot;
from within the path: /usr/src/linux.</p>

<p>Step 10: I am sure you can see a file called: &quot;<strong>Makefile</strong>&quot;.
It is an extremely important file for this entire Compilation
process. So, make sure you create a backup of this file, by
using: &quot;<strong>cp Makefile Makefile.bak</strong>&quot;</p>

<p>Step 11: Now, do: (from within /usr/src/linux) &quot;<strong>vi
Makefile</strong>&quot;.</p>

<p>Step 12: Go to line <strong>EXTRAVERSION</strong> and change
it to something like this, for example I changed
EXTRAVERSION=-22, to EXTRAVERSION=&quot;-22ghosh&quot;. You are
free to name it anyway you wish. </p>

<p>Step 13: Save and exit the file.</p>

<p>Step 14: All the following steps should be done from within:
/usr/src/linux. Type in: &quot;<strong>make dep clean</strong>&quot;,
and press enter.</p>

<p>Step 15: Then type in: &quot;<strong>make bzImage modules</strong>&quot;.
This would take some time, go and have a drink while it compiles
all the necessary files. I usually take a nap during this time,
cause I do all this stuff in the middle of the night.</p>

<p>Step 16: After this step is over, a &quot;<strong>bzImage</strong>&quot;
file would be created in the directory
/usr/src/linux/arch/i386/boot, just go to this directory and
check whether a file called &quot;bzImage&quot; has been produced
or not. IF AND ONLY IF all the compilation steps have been
executed correctly and all the options that we have had chosen in
&quot;make xconfig&quot; are correct, this file would be
produced. If you can find this file, which I am sure you would,
well, you can start enjoying already, cause you have won 75% of
the battle. If you can't see this file, I am sorry, but you must
have had made a mistake somewhere, just take a break and carry
out all the steps again from the start. I am sure you would
succeed.</p>

<p>Step 17: Type in (from within /usr/src/linux): &quot;<strong>cp
./arch/i386/boot/bzImage /boot/vmlinuz-2.2.16-22ghosh</strong>&quot;
and press enter.</p>

<p>Step 18: Then type in: &quot;<strong>cp System.map
/boot/System.map-2.2.16-22ghosh</strong>&quot;</p>

<p>Step 19: Then type in: &quot;<strong>make modules_install</strong>&quot;
and press enter. You would see all the modules being installed in
a new customized directory. </p>

<p>Step 20: Then type in: &quot;<strong>mkinitrd
/boot/initrd-2.2.16-22ghosh.img 2.2.16-22ghosh</strong>&quot;</p>

<p>Step 21: Then, type in: &quot;<strong>vi /etc/lilo.conf</strong>&quot;
and then add the following entry: </p>

<p><strong>image=/boot/vmlinuz-2.2.16-22ghosh </strong></p>

<blockquote>
    <p><strong>label=GhoshKernel<br>
    initrd=/boot/initrd-2.2.16-22ghosh.img<br>
    root=/dev/hdc5<br>
    read-only</strong></p>
</blockquote>

<p>Step 22: Save and exit. Please note that you can change the
entries in the lilo.conf file as you desire, and the root should
be the root in your system, in my machine, it's at /dev/hdc5. So,
insert the info from your own system.</p>

<p>Step 23: Type in: &quot;<strong>/sbin/lilo -v -v</strong>&quot;</p>

<p>Step 24: Read all the info on the screen. If there are no
errors, well, the job's all done. Congratulations!!!!</p>

<p>Step 25: Reboot the system by typing in: &quot;<strong>/sbin/reboot</strong>&quot;
or &quot;<strong>/sbin/shutdown -r now</strong>&quot;.</p>

<p>Step 26: In the start-up screen, press Tab (or Control-X, if
you have the LILO start-up screen), and you can see the entry:
&quot;GhoshKernel&quot; along with the other pre-existing
entries.</p>

<p>Step 27: Type in: <strong>GhoshKernel</strong> and press
enter. The fully working Customized Kernel will be seen booting
on your system. So, you have a fully working Customized Kernel
working on your system now. </p>

<h4><strong>Conclusion:</strong></h4>

<p>After logging in as &quot;root&quot;, type in: &quot;<strong>uname
-r</strong>&quot; and press Enter. You can see the following
entry on the screen: <strong><u>2.2.16-22ghosh</u></strong> that
proves that you are running a Customized Kernel, and not <strong>2.2.16-22</strong>
which was the Kernel we had started out with. That's all. Also
remember, that you can have as many number of Kernel versions as
you like running on a single computer system. In case this
doesn't work out or you guys (and gals) face problems, make sure
you do e-mail me at <a
href="mailto:auspicious_blessingsindia@hotmail.com">auspicious_blessingsindia@hotmail.com</a>
for questions and suggestions. I would really like to hear from
you and help you and I hope this detailed HowTo helps everyone
out there who wants to run a fully working Customized Kernel.</p>

<h4><strong>Resources:</strong></h4>

<p>There exists a lot of info on how to configure and run fully
Optimized and Customized Kernels at a number of web-sites. Make
sure you check out: <a href="http://www.vmlinuz.nu">http://www.vmlinuz.nu</a>
and a few other ones for the HowTo's and Documentation on Linux
Kernel. </p>




<!-- *** BEGIN bio *** -->
<SPACER TYPE="vertical" SIZE="30">
<P> 
<H4><IMG ALIGN=BOTTOM ALT="" SRC="../gx/note.gif">Subhasish Ghosh</H4>
<CITE>I'm 20 years old, and
currently living in India. I am a computer-systems engineering
student as well as a Computer Professional. I currently hold 6
Microsoft Certified Professional(MCP) Certifications, and also am
a Microsoft Certified Professional Certified on NT 4.0 Track. I
have been working with Linux for a long time, especially Red Hat
Linux. I am currently preparing for the Red Hat Linux Certified
Engineer(RHCE) certification Exam and plan to work primarily with
the Linux operating system in the future.</CITE>

<!-- *** END bio *** -->

<!-- *** BEGIN copyright *** -->
<P> <hr> <!-- P --> 
<H5 ALIGN=center>

Copyright &copy; 2001, Subhasish Ghosh.<BR>
Copying license <A HREF="../copying.html">http://www.linuxgazette.net/copying.html</A><BR> 
Published in Issue 68 of <i>Linux Gazette</i>, July 2001</H5>
<!-- *** END copyright *** -->

<!--startcut ==========================================================-->
<HR><P>
<CENTER>
<!-- *** BEGIN navbar *** -->
<IMG ALT="" SRC="../gx/navbar/left.jpg" WIDTH="14" HEIGHT="45" BORDER="0" ALIGN="bottom"><A HREF="dellomodarme.html"><IMG ALT="[ Prev ]" SRC="../gx/navbar/prev.jpg" WIDTH="16" HEIGHT="45" BORDER="0" ALIGN="bottom"></A><A HREF="index.html"><IMG ALT="[ Table of Contents ]" SRC="../gx/navbar/toc.jpg" WIDTH="220" HEIGHT="45" BORDER="0" ALIGN="bottom" ></A><A HREF="../index.html"><IMG ALT="[ Front Page ]" SRC="../gx/navbar/frontpage.jpg" WIDTH="137" HEIGHT="45" BORDER="0" ALIGN="bottom"></A><IMG ALT="[ Talkback ]" SRC="../gx/navbar/talkback.jpg" WIDTH="121" HEIGHT="45" BORDER="0" ALIGN="bottom"  ><A HREF="../faq/index.html"><IMG ALT="[ FAQ ]" SRC="./../gx/navbar/faq.jpg"WIDTH="62" HEIGHT="45" BORDER="0" ALIGN="bottom"></A><A HREF="jenkins.html"><IMG ALT="[ Next ]" SRC="../gx/navbar/next.jpg" WIDTH="15" HEIGHT="45" BORDER="0" ALIGN="bottom"  ></A><IMG ALT="" SRC="../gx/navbar/right.jpg" WIDTH="15" HEIGHT="45" ALIGN="bottom">
<!-- *** END navbar *** -->
</CENTER>
</BODY></HTML>
<!--endcut ============================================================-->
