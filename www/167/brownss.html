<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="utf-8" xml:lang="utf-8">
<head>
<title>QQ on Linux LG #167</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../lg.css" type="text/css" media="screen, projection"  />
<link rel="alternate" type="application/rss+xml" title="LG RSS" href="lg.rss" />
<link rel="alternate" type="application/rdf+xml" title="LG RDF" href="lg.rdf" />
<!-- link rel="alternate" type="application/atom+xml" title="LG Atom" href="lg.atom.xml" / -->
<link rel="shortcut icon" href="../favicon.ico" />

<style type="text/css" media="screen, projection">
<!--

-->
</style>

</head>
<body>

<a href="../">
<img src="../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
</a>
<p id="fun">...making Linux just a little more fun!</p>

<div id="navigation">
<table summary="masthead" width="100%">
<tr>
<td align="center" colspan="3" style="font-size: 10px; font-weight: bold">
<a href="../index.html">Home</a>
<a href="http://linuxgazette.net">Main Site</a>
<a href="../faq/index.html">FAQ</a>

<a href="../lg_index.html">Site Map</a>
<a href="../mirrors.html">Mirrors</a>
<a href="../mirrors.html">Translations</a>
<a href="../search.html">Search</a>
<a href="../archives.html">Archives</a>
<a href="../authors/index.html">Authors</a>
<a href="http://lists.linuxgazette.net/mailman/listinfo/">Mailing Lists</a>
<a href="../jobs.html">Join Us!</a>
<a href="../contact.html">Contact Us</a>

<hr width="99%" style="border: 1px inset #000033">
</td>
</tr>
<tr>
<td width="40%" align="left" style="font-size: 10px; font-weight: bold">
The Free International Online Linux Monthly
</td>
<td width="20%" align="center" style="font-size: 10px; font-weight: bold">
ISSN: 1934-371X
</td>
<td width="40%" align="right" style="font-size: 10px; font-weight: bold">
Main site: <a href="http://linuxgazette.net">http://linuxgazette.net</a> 
</td>
</table>
</div>


<div id="breadcrumbs1">

<a href="../index.html">Home</a> &gt; 
<a href="index.html">October 2009 (#167)</a> &gt; 
Article

</div>

<div class="articlecontent1">
<div class="content">

<div id="previousnexttop">
<A HREF="lg_bytes.html" >&lt;-- prev</A> | <A HREF="dyckoff1.html" >next --&gt;</A>
</div>

<h1>QQ on Linux</h1>
<p id="by"><b>By <a href="../authors/brownss.html">Silas Brown</a></b></p>

<p>Here are some pointers that might help learners of Chinese
to communicate with their Chinese friends using the QQ protocol
which is popular in China.</p>

<H2>Preliminary notes</H2>

<OL>

<LI><STRONG>If you <EM>can</EM> get your friends to use something other than
QQ, <EM>do</EM>.</STRONG> Dealing with QQ is messy, much more so than Skype,
MSN etc.</LI>

<LI>To <STRONG>sign up</STRONG> for a QQ account you <EM>will</EM> need assistance
from a Chinese person with good eyesight, as QQ's
<acronym title="Completely Automated Public Turing test to tell Computers and Humans Apart">CAPTCHA</acronym>
relies on human recognition of distorted Chinese
characters, and they're <EM>not</EM> beginners' characters.</LI>

<LI>libpurple (as used in Pidgin and Adium) has QQ protocol support; you
likely have to install the latest version (not the one in your package
manager), and in the account details select the Advanced tab and choose the
most recent version of the protocol (QQ's servers no longer allow the 2005
version, for example).  However libpurple is <EM>playing catchup</EM> with
QQ; every so often QQ does something that's not supported by libpurple, and
things can happen like all your incoming messages getting silently dropped, or
people trying to send you screen-shots and not realising you're not receiving
them.</LI>

</OL>

<H2>QQ for Linux</H2>

<OL>

<LI>Download from
<A rel="nofollow" href="http://im.qq.com/qq/linux">im.qq.com/qq/linux</A>
(1.0&nbsp;Beta&nbsp;1 has links to a <tt>.deb</tt> for Ubuntu 7.10+, a distribution-independent
<tt>.tgz</tt>, etc)</LI>

<LI>QQ 1.0 beta <STRONG>does not work well with GTK themes</STRONG>. Some
colours will be taken from the theme and others will not; the result is
usually unreadable. Additionally, you cannot simply change the <TT>HOME</TT>
environment variable to point to a directory that lacks <tt>.gtkrc</tt>; QQ
will find your real home directory anyway.
You have to do something like
<pre>
mv .gtkrc g0 ; (sleep 5;mv g0 .gtkrc) &amp; qq
</pre></li>

<li>The login window includes the expected fields for username and password,
a remember-password checkbox, and a sign-in button (the left-hand part of
which can be used to change status).</li>

<li>QQ bypasses the window manager a lot.
If clicking on a QQ window to raise it does not work,
try switching into it via Alt-Tab or equivalent.</li>

<li>The three tabs at the top of the main window are
"Friends", "Groups", and "Recently chatted with".
The colour button above that lets you choose a colour and picture for the QQ
windows' title bars, and above this is a status button and an area where you
can click to type a status message.
The round button at the bottom is a menu.
The spanner lets you change your account options
(friendly name, etc).
The other buttons are to view recently-downloaded files,
and to find/add more QQ contacts.
</li>

<li> Click to expand a list of contacts (friends, strangers, or other),
double-click to start a chat, right-click to bring up a context menu, the
items of which are Send Message, Send File, Delete Contact, View Profile,
Annotate Contact (i.e. set an alias), and whether or not to show these
aliases.</li>

<li>QQ 1.0 beta <STRONG>will crash</STRONG> if you try to type in an
annotation that is longer than 16 characters. (There is no bounds-checking on the
array until the C library sees corruption after <tt>free()</tt>.
It's reasonable to assume that Chinese-character aliases won't be longer than 16
characters, but Latin-character aliases might well be.)</li>

<li>QQ can also forget some of your annotations from time to time; I'm not sure
why.  You'd be advised to keep a separate copy.</li>

<li>In the chat window, press Control+Enter to send
(Enter just adds a new line).
The icons in the chat window are:
Emoticon,
History (toggles display of the most recent part of the conversation you
had before this one),
Send picture (lets you choose a picture file and pastes the picture directly
into the conversation),
Take screenshot (this button darkens the screen, and you then use the mouse to
drag out the rectangle that you want to send, and double-click on it; it
will then appear in the typing box and you can add words around it),
and Send file.</li>

<li>Voice and video chat are <strong>not</strong>
available in the 1.0&nbsp;beta Linux version.</li>

</OL>

<H2>QQ in WINE</H2>

<p>QQ 2008 (with voice chat) can be set up in WINE as
follows, but it is unstable.</p>

<pre>
mkdir qq &amp;&amp; cd qq &amp;&amp;
wget http://dl_dir.qq.com/qqfile/qq/QQ2008stablehij/QQ2008.exe &amp;&amp;
HOME="$(pwd)" LANG=zh_CN.gb18030 wine QQ2008.exe
</pre>

<p>then click the button marked with an (I), then click the first radio box,
then Next, then Next, then wait for installation, then Finish.  The "what's
new" file will appear in Notepad, and QQ will launch; you may now fill in
your number and password (and choose to remember
password).</p>

<p>You then need to close QQ and do this:</p>

<pre>
killall TXPlatform.exe QQ.exe explorer.exe winedevice.exe rundll32.exe services.exe
rm .wine/drive_c/Program\ Files/Tencent/QQ/TXPlatform.exe
</pre>

<p>Then run QQ with</p>

<pre>
HOME="$(pwd)" LANG=zh_CN.gb18030 \
WINEDLLOVERRIDES="mfc42,msvcp60,riched20,riched32=n,b;mmdevapi=" \
wine .wine/drive_c/Program\ Files/Tencent/QQ/QQ.exe
</pre>

<h2>Concluding Notes:</h2>
<p>(adapted from the Chinese-language thread at
<a href="http://www.linuxdiyf.com/bbs/thread-109610-1-1.html">http://www.linuxdiyf.com/bbs/thread-109610-1-1.html</a>,
with some experimentation to improve stability)</p>

<p>Most characters should be displayed if your system has the zh_CN.gb18030 locale and some Chinese TTF
fonts, although some menus may not display.</p>

<p>Voice chat works for me on Ubuntu Hardy's WINE package
(version 1.0.0-1ubuntu4~hardy1).
Newer WINE packages (1.1.0, 1.1.24)
get an assertion failure about
<TT>(elem)-&gt;type == SND_MIXER_ELEM_SIMPLE</TT>
in the ALSA code, or if you use <TT>winecfg</TT> to set
OSS audio then sound works only one way.</p>

<p> Some Chinese people will tell you that there exists an English
version of QQ.  However, that was released in 2005 and uses a version
of the protocol that QQ no longer supports.  There is a 2008 English
version of their simpler "Tencent Messenger" product, but I was not
able to get that to work with WINE.  </p>

<p>With thanks to Jessy Li for some translation help.</p>


<br clear="all" />

<script type='text/javascript'>
digg_url = 'http://linuxgazette.net/167/brownss.html';
digg_title = 'QQ on Linux';
digg_bodytext = '<p>Here are some pointers that might help learners of Chinese to communicate with their Chinese friends using the QQ protocol which is popular in China.</p> ';
digg_topic = 'linux_unix';
</script>
<script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>


<p class="talkback">
Talkback: <a
href="mailto:tag@lists.linuxgazette.net?subject=Talkback:167/brownss.html">Discuss this article with The Answer Gang</a>
</p>

<!-- *** BEGIN author bio *** -->
<hr>
<p>
<img align="left" alt="[BIO]" src="../gx/authors/brownss.jpg" class="bio">
</p>

<em>
<p>
Silas Brown is a legally blind computer scientist based in Cambridge UK.
 He has been using heavily-customised versions of Debian Linux since
 1999.
</p>



</em>

<br clear="all">


<!-- *** END author bio *** -->

<div id="articlefooter">

<p>
Copyright &copy; 2009, Silas Brown. Released under the <a
href="http://linuxgazette.net/copying.html">Open Publication License</a>
unless otherwise noted in the body of the article. Linux Gazette is not
produced, sponsored, or endorsed by its prior host, SSC, Inc.
</p>

<p>
Published in Issue 167 of Linux Gazette, October 2009
</p>

</div>

<div id="previousnextbottom">
<A HREF="lg_bytes.html" >&lt;-- prev</A> | <A HREF="dyckoff1.html" >next --&gt;</A>
</div>

</div>
</div>

<script src="http://www.google-analytics.com/urchin.js"
type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1204316-1";
urchinTracker();
</script>







<img src="../gx/tux_86x95_indexed.png" id="tux" alt="Tux"/>

</body>
</html>

