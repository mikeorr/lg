<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
		 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' lang='utf-8' xml:lang='utf-8'>
<head>
<title>[2-cent Tip]: Counting your mail</title>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
<link rel='stylesheet' type='text/css' href='../../../lg.css' />
</head>
<body>
<a href="../../../"><img alt="Linux Gazette" src="../../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" /></a><img alt="Tux" src="../../../gx/tux_86x95_indexed.png" id="tux" /><p id="fun">...making Linux just a little more fun!</p><div class='content articlecontent'><a name="top"></a><h3>[2-cent Tip]: Counting your mail</h3>
<p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]
</p>

<p>

</p>
</b><br />
<b>Sat, 28 Aug 2010 13:13:02 -0400</b>
</p>

<p>
A few minutes ago, I needed to count all the emails I had archived in my
~/Mail directory. A moment of thought, and:
</p>

<pre>
grep -rc '^From ' Mail/*|awk -F: '{s+=$NF}END{print s}'
</pre>

<p>
NOTES: Email headers start with a 'From ' at the beginning of the line,
so each line that starts that way identifies a single email. 'grep -r'
is recursive - i.e., also searches subdirectories. The output from
'grep' is a bunch of lines, each of which looks like 'file.txt:17',
which says that 'file.txt' has 17 matches; therefore, we use 'awk' to
split each line on colons - but since the filename itself could contain
a colon, we need to grab the very last field. In 'awk', 'NF' is the
count of fields in each line, and '$X' is the value of field X - so
'$NF' is the value of the last field. Sum them up, print them out when
it's all over, and presto - count of emails.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_tips.html#mb-2_cent_tip___counting_your_mail">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Jim Jackson [jj at franjam.org.uk]
</p>

<p>

</p>
</b><br />
<b>Sun, 29 Aug 2010 09:58:30 +0100 (BST)</b>
</p>

<p>
On Sat, 28 Aug 2010, Ben Okopnik wrote:
</p>


<pre>
&gt; A few minutes ago, I needed to count all the emails I had archived in my
&gt; ~/Mail directory. A moment of thought, and:
&gt; 
&gt; ``
&gt; grep -rc '^From ' Mail/*|awk -F: '{s+=$NF}END{print s}'
&gt; ''
</pre>

<p>
Nice. But I've never really internalised awk, my take would be...
</p>

<pre>
grep -r '^From ' Mail/* | wc -l
</pre>

<p>
cheers
Jim
</p>


<pre>
&gt; 
&gt; NOTES: Email headers start with a 'From ' at the beginning of the line,
&gt; so each line that starts that way identifies a single email. 'grep -r'
&gt; is recursive - i.e., also searches subdirectories. The output from
&gt; 'grep' is a bunch of lines, each of which looks like 'file.txt:17',
&gt; which says that 'file.txt' has 17 matches; therefore, we use 'awk' to
&gt; split each line on colons - but since the filename itself could contain
&gt; a colon, we need to grab the very last field. In 'awk', 'NF' is the
&gt; count of fields in each line, and '$X' is the value of field X - so
&gt; '$NF' is the value of the last field. Sum them up, print them out when
&gt; it's all over, and presto - count of emails.
&gt; 
&gt; 
&gt; -- 
&gt; * Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
&gt; <em>                                             </em>
&gt; TAG mailing list
&gt; TAG at lists.linuxgazette.net
&gt; <a href='http://lists.linuxgazette.net/listinfo.cgi/tag-linuxgazette.net'>http://lists.linuxgazette.net/listinfo.cgi/tag-linuxgazette.net</a>
&gt;
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_tips.html#mb-2_cent_tip___counting_your_mail">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]
</p>

<p>

</p>
</b><br />
<b>Sun, 29 Aug 2010 05:45:44 -0400</b>
</p>

<p>
On Sun, Aug 29, 2010 at 09:58:30AM +0100, Jim Jackson wrote:
</p>

<pre>
&gt; 
&gt; 
&gt; 
&gt; On Sat, 28 Aug 2010, Ben Okopnik wrote:
&gt; 
&gt; &gt; A few minutes ago, I needed to count all the emails I had archived in my
&gt; &gt; ~/Mail directory. A moment of thought, and:
&gt; &gt; 
&gt; &gt; ``
&gt; &gt; grep -rc '^From ' Mail/*|awk -F: '{s+=$NF}END{print s}'
&gt; &gt; ''
&gt; 
&gt; Nice. But I've never really internalised awk, my take would be...
&gt; 
&gt; ``
&gt; grep -r '^From ' Mail/* | wc -l
&gt; ''
</pre>

<p>
[blink] Wonder why I didn't think of that. It's certainly more obvious.
</p>

<p>
Well done, Jim!
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_tips.html#mb-2_cent_tip___counting_your_mail">Back</a><hr width="50%" align="left" /><p><br /></p></div>
</body>
</html>