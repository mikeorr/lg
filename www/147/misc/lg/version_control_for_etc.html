<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
		 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' lang='utf-8' xml:lang='utf-8'>
<head>
<title>Version control for /etc</title>
<meta http-equiv='Content-Type; charset=utf-8' />
<link rel='stylesheet' type='text/css' href='../../../lg.css' />
</head>
<body>
<a href="../../../"><img alt="Linux Gazette" src="../../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" /></a><img alt="Tux" src="../../../gx/tux_86x95_indexed.png" id="tux" /><p id="fun">...making Linux just a little more fun!</p><div class='content articlecontent'><a name="top"></a><h3>Version control for /etc</h3>
<p>
<b><p>
Rick Moen [rick at linuxmafia.com]
</p>
</b><br />
<b>Tue, 25 Dec 2007 03:24:57 -0800</b>
</p>

<p>
<p class="editorial">
[[[  This is a followup to "Version control for /etc" in
<a href="../../../144/lg_mail.html">http://linuxgazette.net/144/lg_mail.html</a> -- Kat  ]]]
</p>

</p>

<p>
A promising solution to the exact problem discussed earlier -- put together
by my friend Joey Hess.  See:  <a href="http://kitenet.net/~joey/code/etckeeper/">http://kitenet.net/~joey/code/etckeeper/</a>
One key ingredient is David H?rdeman's "metastore"
(<a href="http://david.hardeman.nu/software.php">http://david.hardeman.nu/software.php</a>), used to capture metadata that
git would otherwise ignore.
</p>

<p>
----- Forwarded message from Jason White &lt;jason@jasonjgw.net&gt; -----
</p>

<pre>
Date: Tue, 25 Dec 2007 19:07:59 +1100
From: Jason White &lt;jason@jasonjgw.net&gt;
To: luv-main &lt;luv-main@luv.asn.au&gt;
Subject: etckeeper
</pre>
For those who are running Debian or debian-derived distributions, there is a
relatively new package, etckeeper, which I have found rather useful: it
maintains a revision history of /etc in a Git repository, including file
permissions and other metadata not normally tracked by Git.
</p>

<p>
It is also invoked by Apt, using standard Apt mechanisms, to commit changes
introduced into /etc when packages are installed or removed.
</p>

<p>
I don't know whether there exist any similar tools for non-Debian
distributions.
</p>

<p>
----- End forwarded message -----
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-version_control_for_etc">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Rick Moen [rick at linuxmafia.com]
</p>
</b><br />
<b>Thu, 3 Jan 2008 04:04:10 -0800</b>
</p>

<p>
I wrote:
</p>


<pre>
&gt; A promising solution to the exact problem discussed earlier -- put together
&gt; by my friend Joey Hess.  See:  <a href="http://kitenet.net/~joey/code/etckeeper/">http://kitenet.net/~joey/code/etckeeper/</a>
&gt; One key ingredient is David H&lt;a4&gt;rdeman's "metastore"
&gt; (<a href="http://david.hardeman.nu/software.php">http://david.hardeman.nu/software.php</a>), used to capture metadata that
&gt; git would otherwise ignore.
</pre>

<p>
Here's Joey's announcement and explanation of the software (explaining
in particular how it avoids some of the drawbacks of IsiSetup):
<a href="http://kitenet.net/~joey/blog/entry/announcing_etckeeper/">http://kitenet.net/~joey/blog/entry/announcing_etckeeper/</a>
Particularly winning is its close integration (on Debian and similar)
into apt, so that changes to /etc/ resulting from package operations get
checked in automatically.
</p>

<p>
etckeeper being an excellent idea whose time has definitely come,
Mathieu Clabaut has also adapted it to use the increasingly popular
revision control system Mercurial (hg) as its back-end storage, instead
of git (although, as built locally on my Xubuntu iBook, v. 0.6 still
ends up needing package "git-core").  See:
</p>

<p>
<a href="http://hg.sharesource.org/etckeeperhg">http://hg.sharesource.org/etckeeperhg</a>
<a href="http://sharesource.org/project/etckeeperhg/">http://sharesource.org/project/etckeeperhg/</a>
</p>

<p>
I notice that Ubuntu does package etckeeper (but not yet the Mercurial
variant) in its "Hardy Heron" development branch's "universe"
collection.
</p>

<p>
By the way, here's a nice little user tutorial on git:
<a href="http://hwasungmars.wordpress.com/2007/11/25/journey-to-a-backup-solution-git/">http://hwasungmars.wordpress.com/2007/11/25/journey-to-a-backup-solution-git/</a>
</p>

<p>
And a separate Nov. 2007 analysis of the need for something like
etckeeper (mentioning it only in a followup) that cites an earlier
solution by Michael Prokop using Mercurial
(<a href="http://michael-prokop.at/blog/2007/03/14/maintain-etc-with-mercurial-on-debian/">http://michael-prokop.at/blog/2007/03/14/maintain-etc-with-mercurial-on-debian/</a>), 
which itself points to Enrico Zini's method of doing similar things in
svk (a superset of subversion that supports decentralised operation and
in general improves it):
<a href="http://lists.debian.org/debian-devel/2005/02/msg00495.html">http://lists.debian.org/debian-devel/2005/02/msg00495.html</a>
</p>

<p>
(As I believe was noted in earlier go-rounds of this subject in TAG, one 
still rather rare quality in revision control systems is the ability to
<em>not</em> have metadata rubbish sitting around in .CVS, .svn, or equivalent 
directories/files in one's working areas, and svk is among the few that 
solve that problem.)
</p>

<p>
Another, and related, recent contribution from Joey is "mr"
(<a href="http://kitenet.net/~joey/code/mr/):">http://kitenet.net/~joey/code/mr/):</a>
</p>

<p>
  The mr(1) command can checkout, update, or perform other actions on a
  set of repositories as if they were one combined respository. It
  supports any combination of subversion, git, cvs, mecurial, bzr and
  darcs repositories, and support for other revision control systems can
  easily be added.
</p>



<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-version_control_for_etc">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Rick Moen [rick at linuxmafia.com]
</p>
</b><br />
<b>Thu, 3 Jan 2008 16:52:40 -0800</b>
</p>

<p>
Reminder about the GIT_DIR variable, for git.
</p>

<p>
----- Forwarded message from Jason White &lt;jason@jasonjgw.net&gt; -----
</p>

<pre>
Date: Fri, 4 Jan 2008 10:10:43 +1100
From: Jason White &lt;jason@jasonjgw.net&gt;
To: luv-main@luv.asn.au
Subject: Re: etckeeper
</pre>
On Thu, Jan 03, 2008 at 10:31:53AM -0800, Rick Moen wrote:
</p>

<pre>
&gt; (As I believe was noted in earlier go-rounds of this subject in TAG,
&gt; one still rather rare quality in revision control systems is the
&gt; ability to <em>not</em> have metadata rubbish sitting around in .CVS, .svn,
&gt; or equivalent directories/files in one's working areas, and svk is
&gt; among the few that solve that problem.)
</pre>

<p>
I haven't tried it, but apparently the GIT_DIR environment variable
allows you to refer to a git repository directory anywhere in the file
system. Provided you set it before invoking git, the problem noted by
Rick should be overcome.
</p>

<p>
This could be useful with etckeeper if your /etc happens to be in a
small root partition in which you don't want space to be consumed by a
.git directory.
</p>

<p>
----- End forwarded message -----
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-version_control_for_etc">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Peter Knaggs [peter.knaggs at gmail.com]
</p>
</b><br />
<b>Thu, 3 Jan 2008 23:27:31 -0800</b>
</p>

<p>
On Jan 3, 2008 4:52 PM, Rick Moen &lt;rick@linuxmafia.com&gt; wrote:
</p>

<pre>
&gt; Reminder about the GIT_DIR variable, for git.
</pre>


<p>
The GIT_DIR does work, but there's a small quirk to be aware of:
</p>


<p>
It seems that the last component of the path specified in the
GIT_DIR variable needs to be the word ".git", otherwise "git-add"
won't work properly:
</p>

<p>
e.g.:
<pre>
mkdir -p /tmp/git_metadata/test
export GIT_DIR=/tmp/git_metadata/test
 
mkdir /tmp/git_testdir &amp;&amp; cd /tmp/git_testdir
 
git-init
Initialized empty Git repository in /tmp/git_metadata/test/
 
ls -l
. ..
 
touch file1
git-add file1
fatal: add must be run in a work tree
</pre>
whereas when the GIT_DIR variable ends with the word ".git", all is fine:
<pre>
mkdir -p /tmp/git_metadata/.git
export GIT_DIR=/tmp/git_metadata/.git
 
mkdir /tmp/git_testdir &amp;&amp; cd /tmp/git_testdir
 
git-init
Initialized empty Git repository in /tmp/git_metadata/test/
 
ls -a
.  ..
 
touch file1
git-add file1
git-commit
warning: unable to read /etc/mailname: Success
 
warning: unable to read /etc/mailname: Success
 
 
warning: unable to read /etc/mailname: Success
 
warning: unable to read /etc/mailname: Success
 
Created initial commit fc652c0: Add
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 file1
</pre>
The tutorials here seem to be quite readable:
</p>

<p>
  <a href="http://www.kernel.org/pub/software/scm/git/docs/tutorial.html">http://www.kernel.org/pub/software/scm/git/docs/tutorial.html</a>
  <a href="http://www.kernel.org/pub/software/scm/git/docs/tutorial-2.html">http://www.kernel.org/pub/software/scm/git/docs/tutorial-2.html</a>
  <a href="http://www.kernel.org/pub/software/scm/git/docs/everyday.html">http://www.kernel.org/pub/software/scm/git/docs/everyday.html</a>
</p>

<p>
Cheers,
Peter.
</p>


<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-version_control_for_etc">Back</a><hr width="50%" align="left" /><p><br /></p></div>
</body>
</html>