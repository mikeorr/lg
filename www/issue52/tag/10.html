<!--startcut ======================================================= -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<META NAME="generator" CONTENT="lgazmail v1.3C.j">
<TITLE>The Answer Guy 52: Cross Comment: 2cent Tips</TITLE>
</HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"
	LINK="#3366FF" VLINK="#A000A0">
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<H4>"The Linux Gazette...<I>making Linux just a little more fun!</I>"</H4>
<P> <hr> <P>
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<center>
<H1><A NAME="answer">
	<img src="../../gx/dennis/qbubble.gif" alt="(?)" 
		border="0" align="middle">
	<font color="#B03060">The Answer Guy</font>
	<img src="../../gx/dennis/bbubble.gif" alt="(!)" 
		border="0" align="middle">
</A></H1> 
<BR>
<H4>By James T. Dennis,
	<a href="mailto:tag@lists.linuxgazette.net">tag@lists.linuxgazette.net</a><BR>
	LinuxCare,
	<A HREF="http://www.linuxcare.com/">http://www.linuxcare.com/</A> 
</H4>
</center>

<p><hr><p>
<!--  endcut ======================================================= -->
<!-- begin 10 -->
<H3 align="left"><img src="../../gx/dennis/qbubble.gif" 
	height="50" width="60" alt="(?) " border="0"
	>Cross Comment: 2cent Tips</H3>


<p><strong>From Flavio Poletti  on Mon, 06 Mar 2000  
</strong></p>
<!-- ::
Cross Comment: 2cent Tips
~~~~~~~~~~~~~~~~~~~~~~~~~
:: -->
<BLOCKQUOTE>
[Recently I've been going through 2cent Tips
looking for ideas to fill out a "Linux Tips" fortune
file.  So this comment stems from a comment I
made to the author of one script.  You'll have to
peruse the 2cent Tips to find out more]
</BLOCKQUOTE>
<P><STRONG><IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
What a honor - am I <EM>answering</EM> the *Answer Guy*? 
<IMG SRC="../../gx/dennis/smily.gif" ALT=";)" 
		height="24" width="20" align="middle">
</STRONG></P>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
That's me.
</BLOCKQUOTE>
<P><STRONG><FONT COLOR="#000066"><EM><IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
Flavio,
</EM></FONT></STRONG></P>
<P><STRONG><FONT COLOR="#000066"><EM>
I was curious about your choice of PERL for this script.
So I wrote a version in sh. It's attached.
</EM></FONT></STRONG></P>
<P><STRONG>
I thank you very much for your interesting. My choice of PERL for
this script is very simple - I found a good Perl manual to
download (Perl 5 by example), and I have nothing like this about
sh/bash. I am able to write very simple sh scripts, but I must
confess I've never used `<tt>read</tt>' or `<tt>case</tt>'. 
I hope that your script will help me to understand something.
</STRONG></P>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
That's O.K.  PERL is a much better job skill.
Putting "<tt>sh</tt>" on your resume won't attract much
attention.  Putting PERL there, and being able to
back it up with any reasonable code will get you work
all over.
</BLOCKQUOTE>
<BLOCKQUOTE>
sh is like the "Don Rinkles" of scripting languages.
You'll get no respect.  If you claim it as a skill
people will assume that the most you can do with it
is list five line abbreviation macros with a
<tt>cd</tt> or <tt>pushd</tt>, <tt>cp</tt> (make a backup of some file), and
a launch of the "real command" that you're using.
</BLOCKQUOTE>
<BLOCKQUOTE>
<tt>awk</tt> gets about the same appreciation.
</BLOCKQUOTE>
<P><STRONG><IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
Do you know a good (and easy to read) source of information for
learning sh programming?
</STRONG></P>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
I like the O'Reilly "Learning the Bash Shell"
and I'm also quite partial to Mark G. Sobell's
"Practical Guide to Linux" (or any edition of
Practical Guide to UNIX).
</BLOCKQUOTE>
<P><STRONG><FONT COLOR="#000066"><EM><IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
Mine is about ten lines (30%) shorter.
</EM></FONT></STRONG></P>
<P><STRONG>
And it seems to do much more!
</STRONG></P>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
Well, it does a little more --- just because
I wanted it to look a little different for my
needs.
</BLOCKQUOTE>
<P><STRONG><FONT COLOR="#000066"><EM><IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
The main
difference is that I pipe my netstat output
right into my main loop, and my fuser output
into an inner loop.  This simplifies the
code path somewhat, and eliminates the need
for any arrays and hashes.
</EM></FONT></STRONG></P>
<P><STRONG>
PERL has native data structures like arrays and hashes - so
why don't use them?
</STRONG></P>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
It's a philosophical issue.
</BLOCKQUOTE>
<BLOCKQUOTE>
Since we were using the same external programs
(<tt>netstat</tt> and <tt>fuser</tt>) the question was how to use
them most efficiently.   The most efficient way
to use your data is in a loop, as you recieve it.
</BLOCKQUOTE>
<BLOCKQUOTE>
When you use the back tick operators and fill a
hash then you have allocated a bunch of memory,
caused a latency (collecting the data) and
are left with the task of separately sifting
back through the data to process it.
</BLOCKQUOTE>
<BLOCKQUOTE>
When you use the pipeline each bit of output data
is used as it becomes available and discard when its
no longer required.  Both processes (the netstat
which is feeding our loop, and the bit of shell
code which is reading it in a subshell) are able
to work in parallel (particularly if we have an
SMP system).  The pipe blocks whever its buffer
is full and the other end isn't ready.
</BLOCKQUOTE>
<BLOCKQUOTE>
(So, when the receiving end is forking off a
copy of fuser to process the current line, the
netstat process is blocked, and when the
netstat process is blocked waiting for system
calls or on file I/O (parsing through <TT>/proc</TT>
entries) then the subshell just sleeps because
its on a blocking<TT> read()</TT>).
</BLOCKQUOTE>
<BLOCKQUOTE>
This is the way that UNIX was designed to work.
</BLOCKQUOTE>
<P><STRONG><FONT COLOR="#000066"><EM><IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
I'd really like to see more people learn this
shell scripting pattern.  It allows one to do quite
a bit with shell without requiring awk, PERL etc.
and without making lots of nasty temp files or
using large variable/values.
</EM></FONT></STRONG></P>
<P><STRONG>
You are surely true, but... I've been able to find (and effectively
use) a PERL manual (the supercited one) and a awk manual (Effective
AWK Programming), and nothing more than a bash man page!
</STRONG></P>
<P><STRONG>
I'll surely use your piece of advice to get rid of temp files, in the
future... I felt they were a sign of weakness in my scripts!
</STRONG></P>
<P><STRONG>
Thanks and bye,
Flavio.
</STRONG></P>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
Maybe I'll write one some day.  Until then look at
Rob Pike's &quot;The UNIX Programming Environment&quot; and
the two I mentioned up above.
</BLOCKQUOTE>
<BLOCKQUOTE>
More generally you can find lots of good books
looking at Eric S. Raymond's "Linux Reading List HOWTO"
<A HREF="http://www.linuxdoc.org/HOWTO/Reading-List-HOWTO.html"
	>http://www.linuxdoc.org/HOWTO/Reading-List-HOWTO.html</A>
</BLOCKQUOTE>
<BLOCKQUOTE>
Though I note that he didn't add my book
to that yet 
<IMG SRC="../../gx/dennis/smily.gif" ALT=";)" 
		height="24" width="20" align="middle">
</BLOCKQUOTE>
<BLOCKQUOTE>
Looking at a couple of other categories:
</BLOCKQUOTE>
<BLOCKQUOTE>
Under TeX/LaTeX I noticed that Eric isn't listing:
</BLOCKQUOTE>
<BLOCKQUOTE><BLOCKQuote>
&quot;A Guide to LaTeX2e&quot; by Helmut Kopka and
Patrick W. Daly (Addison Wesley, 1993)
</BLOCKQuote></BLOCKQUOTE>
<BLOCKQUOTE>
and under C programming I have to recommend:
</BLOCKQUOTE>
<BLOCKQUOTE><BLOCKQuote>
&quot;Beginnning Linux Programming 2nd Ed.&quot;
Richard Stones and Neil Matthew
(Wrox Press, 1996)
</BLOCKQuote></BLOCKQUOTE>
<BLOCKQUOTE>
... This latter one has improved considerably since
the first edition.  I just bought it today.
</BLOCKQUOTE>
<BLOCKQUOTE>
[Eric,  You could toss those into the next version of
the reading HOWTO --- along with a link to the SAGE
(USENIX) "SysAdmin's Bookshelf" at:
</BLOCKQUOTE>
<BLOCKQUOTE><DL><DT>
SAGE - The Sysadmin's Bookshelf
<DD><A HREF="http://www.usenix.org/sage/sysadmins/books/booklist.html"
	>http://www.usenix.org/sage/sysadmins/books/booklist.html</A> ]
</DL></BLOCKQUOTE>
<BLOCKQUOTE>
[Flavio, With your permission I'll publish this in next month's
column, with a link to your tip 
(<a href="../../issue50/lg_tips.html">February, tip #2</a>) 
and any follow up that goes into next months Tips].
</BLOCKQUOTE>

<!-- sig -->


<!-- end 10 -->
<!--startcut ======================================================= -->
<P> <hr> <P>
<H5 align="center"><a href="http://www.linuxgazette.net/copying.html"
	>Copyright &copy;</a> 2000, James T. Dennis 
<BR>Published in <I>The Linux Gazette</I> Issue 52 April 2000</H5>
<H6 ALIGN="center">HTML transformation  by
	<A HREF="mailto:star@tuxtops.com">Heather Stern</a> of
	Tuxtops, Inc.,
	<A HREF="http://www.tuxtops.com/">http://www.tuxtops.com/</A> 
</H6>
<P> <hr> <P>
<!-- begin tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::-->
<TABLE WIDTH="95%"><TR VALIGN="center" ALIGN="center">
<TD colspan="2" rowspan="2"><A 
	HREF="../lg_answer52.html"
	><IMG SRC="../../gx/dennis/answernew.gif"
              ALT="[ Answer Guy Current Index ]"></A>
<TD colspan="2" rowspan="2"><A 
	HREF="../../tag/kb.html"
	><IMG SRC="../../gx/dennis/answertoc.gif"
              ALT="[ Index of Past Answers ]"></A></td>
  <TD WIDTH="11%"><A HREF="../lg_answer52.html#greeting"><img
	src="../../gx/dennis/smily.gif" alt="greetings" border="0"></A></TD>
  <TD WIDTH="11%"><A HREF="1.html">1</A></TD>
  <TD WIDTH="11%"><A HREF="2.html">2</A></TD>
  <TD WIDTH="11%"><A HREF="3.html">3</A></TD>
  <TD WIDTH="11%"><A HREF="4.html">4</A></TD>
</TR><TR VALIGN="center" ALIGN="center">
  <TD WIDTH="11%"><A HREF="5.html">5</A></TD>
  <TD WIDTH="11%"><A HREF="6.html">6</A></TD>
  <TD WIDTH="11%"><A HREF="7.html">7</A></TD>
  <TD WIDTH="11%"><A HREF="8.html">8</A></TD>
  <TD WIDTH="11%"><A HREF="9.html">9</A></TD>
</TR><TR VALIGN="center" ALIGN="center">
  <TD WIDTH="10%"><A HREF="10.html">10</A></TD>
  <TD WIDTH="10%"><A HREF="11.html">11</A></TD>
  <TD WIDTH="10%"><A HREF="12.html">12</A></TD>
  <TD WIDTH="10%"><A HREF="13.html">13</A></TD>
  <TD WIDTH="11%"><A HREF="14.html">14</A></TD>
  <TD WIDTH="11%"><A HREF="15.html">15</A></TD>
  <TD WIDTH="11%"><A HREF="16.html">16</A></TD>
  <TD WIDTH="11%"><A HREF="17.html">17</A></TD>
</TR><TR VALIGN="center" ALIGN="center">
  <TD WIDTH="10%"><A HREF="18.html">18</A></TD>
  <TD WIDTH="10%"><A HREF="19.html">19</A></TD>
  <TD WIDTH="10%"><A HREF="20.html">20</A></TD>
  <TD WIDTH="10%"><A HREF="21.html">21</A></TD>
  <TD WIDTH="11%"><A HREF="22.html">22</A></TD>
  <TD WIDTH="11%"><A HREF="23.html">23</A></TD>
  <TD WIDTH="11%"><A HREF="24.html">24</A></TD>
</TR></TABLE>
<!-- end tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::::-->
<P> <hr> <P>
<!-- begin lgnav ::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<A HREF="../index.html"
	><IMG SRC="../../gx/indexnew.gif" ALT="[ Table Of Contents ]"></A>
<A HREF="../../index.html"
	><IMG SRC="../../gx/homenew.gif" ALT="[ Front Page ]"></A>
<A HREF="../lg_bytes52.html"
	><IMG SRC="../../gx/back2.gif" ALT="[ Previous Section ]"></A>
<A HREF="../../faq/index.html"
	><IMG SRC="../../gx/dennis/faq.gif"
              ALT="[ Linux Gazette FAQ ]"></A>
<A HREF="../lg_tips52.html"
	><IMG SRC="../../gx/fwd.gif" ALT="[ Next Section ]"></A>
<!-- end lgnav ::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
</BODY></HTML>
<!--endcut ========================================================= -->
