<html>
<head>
<link href="../../lg.css" rel="stylesheet" type="text/css" media="screen, projection"  />
<title>The Answer Gang: LG 107: Tripwire</title>

<style type="text/css" media="screen, projection">
<!--
.articlecontent {
        position:absolute;
        top:143px;
}
-->
</style>
</head>
<body>
<img src="../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
<p id="fun">...making Linux just a little more fun!</p>


<div class="content articlecontent">

<div id="previousnexttop">
<A HREF="../lg_tips.html" >&lt;-- 2c Tips</A> 
| <A HREF="../lg_answer.html">TAG Index</a> | <A HREF="1.html">1</a> | <A HREF="2.html">2</a> | <A HREF="3.html">3</a> | <A HREF="4.html">4</a>
| <a href="../../tag/kb.html">Knowledge Base</a>
| <A HREF="../lg_bytes.html" >News Bytes --&gt;</A>
</div>



<h1 align="center"><IMG SRC="../../gx/dennis/qbubble.gif" align="left"> The Answer Gang <IMG SRC="../../gx/dennis/bbubble.gif" align="right"></h1>

<p align="center">By Jim Dennis, Karl-Heinz Herrmann, Breen, Chris, and... 
	(<A HREF="../../tag/bios.html">meet the Gang</A>) ... 
	the Editors of <I>Linux Gazette</I>... and 
	<a href="../../tag/members-faq.html">You</a>!</p>
<br clear="both">
<HR>
<!-- begin 4 -->
<H3 align="left"><img src="../../gx/dennis/bbubble.gif" 
	height="50" width="60" alt="(!) " border="0"
	>Tripwire</H3>


<p><strong>From Greg Bell 
</strong></p> 
<p align="right"><strong>Answered By Barry 
<p></strong></p>

<font color="#000066"><blockquote><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Heather] An honorary answerbubble for Greg Bell.  Good stuff here, and thanks to
article auther Barry O'Donovan for forwarding the thread to us.
</blockquote></font>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
One thing that
I've been suspicious of with tripwire is:  if the hacker is "in",
aren't there all sorts of things he can do to neuter tripwire?
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
To save an argument I could simple say yes... but I won't! First of
all, running tripwire (or another intrusion detection system (IDS)) is
immeasurably better than running no IDS at all.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
thanks for the dialog.  no arguments here, although my counter-points
to your points may appear argumentative 
<IMG SRC="../../gx/dennis/smily.gif" ALT=":)" 
		height="24" width="20" align="middle">
</STRONG></P>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
a lot of things that seem burdensome for a hacker to do can be
wrapped up nicely in a script and bam - 1000s of intruders now have
the capability.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
These scripts usually take advantage of an existing exploit to place a
root kit, backdoor, etc. If your tripwire set-up is unique (i.e. place
the tripwire binary somewhere besides the defualt, use a different
configuration file name and directory, place the db on a floppy, remote
site, etc) then the script won't affect tripwire or if it does it'll be
immediately noticed. Most of these scipt-kiddies go for the "easy hack"
- the poor fools who take no preventative measures. There's so many of
these guys that the script-kiddies are unlikely to invest the time in
created a "be-all and end-all" script to do everything including
disable tripwire in a way that it's not noticed.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
He can
remove the cron/anacron job, and send you fake mail every day saying
everything checked "OK".
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
That's a lot more difficult than it sounds. First of all, he'd need to
know what the usual "all is okay e-mail" looks like for YOUR system.
When you're running tripwire and checking the e-mails you'll get used
to seeing and recognising a lot of numbers such as the total objects
scanned, etc. If you're sending these daily e-mails to another server
then he won't have access to an existing report and he won't be able to
view the saved report files in <TT>/var/lib/tripwire</TT> without your passphrase.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
i am admittedly paranoid about this sort of thing, thanks to reading
about how clever these guys can be, and how it seems to be a
never-ending escalation and arms race (leading towards EVERYTHING
being encrypted, and EVERYTHING being authenticated with biometrics).
a lot of things that seem burdensome for a hacker to do can be wrapped
up nicely in a script and bam - 1000s of intruders now have the
capability.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
Secondly whether you're running tripwire on a server or a desktop
machine, you're liable to have to update at least one package at least
once a week. When you do this you'll expect a problem from tripwire and
if he's sending fake e-mails you'll start to question whther tripwire
is working or not.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
some things i think would be appropriate for tripwire to watch would be
<TT>/etc/passwd</TT> and <TT>/etc/crontab</TT> - two things that can change often, but
that are also prime candidates for a hacker to change.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
Most distributions default tripwire config will check these - especially
passwd. If it doesn't, then ammend the policy file so that it does.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
so it seems to
me than whenever one of these needs to be changed, you've got to run
tripwire on the file to make sure its unchanged, unplug your net
connection, change it, update tripwire, reconnect to the net.  sounds
bizarre but its not improbably that in the hours between your update
and tripwire's next run, a break-in occurs, changing the same file.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
Again, it's all a matter of just how paranoid you are or how far you're
willing to go.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
he can replace the tripwire binary itself.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
Tripwire checks itself too! The stats for the tripwire binary will
reside in the database which an intruder cannot change unless he has
your local passphrase. I suppose an intruder could replace the binary
with one that's programmed to not check itself but if you're really
this paranoid you can put the binary on a remote HTTP server and have
your cronjob download it with wget before checking.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
the "in" hacker would just disable the wget and have the local one be
used.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
He'd also have to asscertain that you use wget to download a fresh
binary and simulate the output from your wget cronjob so you wouldn't
miss it.
</blockQuote>
<blockQuote>
Some servers will mount <TT>/usr</TT> as read-only to increase access speeds and
security. This would help out here too.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
if he's got root, he can just remount r/w.
</STRONG></P>
<P><STRONG>
he can update the database
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
He can't. He'll have to have your local passphrase to do this.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
which an "in" hacker can get with a keycatcher.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
But he'd probably have been spotted by a run of tripwire before hand as
you'd need a reason to input your tripwire passphrase.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
(especially if its on a CD-RW like you suggest).
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
I never said leave the CD-RW in a CD-RW drive. I said "a
re-writable CD in a CD-ROM drive (read-only drive)." i.e. only place
the CD in the CD-RW drive when updating, then put it back in the CD-ROM
drive.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
got it.  smart.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
The bottom line is that tripwire will probably catch an intruder 99 out
of a 100 times. If not more. You'll NEVER be 100% secure. That's just a
simple fact of life. But you can strive to be as secure as possible and
using tripwire will be a huge help here.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
absolutely.
</STRONG></P>
<P><STRONG>
seems to me we might be moving towards a world where an off-site system
does the security check for a particular machine - sort of a checks and
balances setup.  it would host the tripwire binaries, database,
signatures, etc.  and while its there, it should receive the mails from
tripwire, as well as host the syslog remotely.  even so, rootkit
hunters would still have to be run on the secure machine, and some
amount of manual checking would have to be done to make sure any
number of checks hadn't been faked or disabled.
</STRONG></P>

<!-- end 4 -->
<hr>
<p><CENTER><Font face="Helvetica"><STRONG>
This page edited and maintained by the Editors of <I>Linux Gazette</I>
<br>HTML script maintained by
        <A HREF="mailto:star@starshine.org">Heather Stern</a> of
        Starshine Technical Services,
<A HREF="http://www.starshine.org/">http://www.starshine.org/</A></STRONG></Font></CENTER></p>
<hr>

<div id="articlefooter">
<p>
Each TAG thread <a href="http://linuxgazette.net/copying.html"
        >Copyright &copy;</a> its authors, 2004
</p>
<p>
Published in issue 107 of <I>Linux Gazette</I> October 2004
</p>
</div>


<div id="previousnextbottom">
<A HREF="../lg_tips.html" >&lt;-- 2c Tips</A> 
| <A HREF="../lg_answer.html">TAG Index</a> | <A HREF="1.html">1</a> | <A HREF="2.html">2</a> | <A HREF="3.html">3</a> | <A HREF="4.html">4</a>
| <a href="../../tag/kb.html">Knowledge Base</a>
| <A HREF="../lg_bytes.html" >News Bytes --&gt;</A>
</div>
</div>

<div id="navigation">
<a href="../../index.html">Home</a>
<a href="../../faq/index.html">FAQ</a>
<a href="../../lg_index.html">Site Map</a>
<a href="../../mirrors.html">Mirrors</a>
<a href="../../mirrors.html">Translations</a>
<a href="http://linuxgazette.net/search.html">Search</a>
<a href="../../archives.html">Archives</a>
<a href="../../authors/index.html">Authors</a>
<a href="../../contact.html">Contact Us</a>
</div>

<div id="breadcrumbs">
<a href="../../index.html">Home</a> &gt; 
<a href="../index.html">October 2004 (107)</a> &gt; 
<a href="../lg_answer.html">The Answer Gang</a> &gt; 
Thread
</div>

<img src="../../gx/2003/sit3-shine.7-2.gif" id="tux" alt="Tux"/>

</body>
</html>
