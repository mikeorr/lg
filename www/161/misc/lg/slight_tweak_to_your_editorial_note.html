<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
		 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' lang='utf-8' xml:lang='utf-8'>
<head>
<title>Slight tweak to your editorial note</title>
<meta http-equiv='Content-Type; charset=utf-8' />
<link rel='stylesheet' type='text/css' href='../../../lg.css' />
</head>
<body>
<a href="../../../"><img alt="Linux Gazette" src="../../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" /></a><img alt="Tux" src="../../../gx/tux_86x95_indexed.png" id="tux" /><p id="fun">...making Linux just a little more fun!</p><div class='content articlecontent'><a name="top"></a><h3>Slight tweak to your editorial note</h3>
<p>
<b><p>
Rick Moen [rick at linuxmafia.com]

</p>
</b><br />
<b>Tue, 24 Mar 2009 15:51:55 -0700</b>
</p>

<p>
Almost not worth mentioning, but I've made a substantive albeit
de-minimus addition to your editorial note, consisting of the words
"non-root":
</p>



<p>
&lt;p class="editorial"&gt;[ A common application of this would be to run a Web
or FTP server chrooted in a directory like /home/www or
/home/ftp; this provides an excellent layer of security, since even a
malicious non-root user who manages to crack that server is stuck in a
"filesystem" that contains few or no tools, no useful files other than
the ones already available for viewing or downloading, and no way to get
up "above" the top of that filesystem. This is referred to as a "chroot
jail". -- Ben ] 
</p>



<p>
Take my word for it, without that qualifier, you'd attract quibbles from
people repeating the usual mantra:  "chroot(8) is not root safe."
(Ditto the chroot() system call.)
</p>

<p>
That is, the root user, and thus also any process that can escalate to 
UID0 privilege can trivially escape from any chroot jail:
<a href='http://kerneltrap.org/Linux/Abusing_chroot'>http://kerneltrap.org/Linux/Abusing_chroot</a>
<a href='http://unixwiz.net/techtips/chroot-practices.html'>http://unixwiz.net/techtips/chroot-practices.html</a>
<a href='http://www.bpfh.net/simes/computing/chroot-break.html'>http://www.bpfh.net/simes/computing/chroot-break.html</a>
</p>

<p>
(You'll note that the article lists other ways of <em>indirect</em> ways of
escalating privilege, plus "Why would anyone put <em>that</em> in a chroot
jail?" methods such as "Follow a pre-existing hard link to outside the
jail.")
</p>

<p>
If you want to be <em>almost</em> safe against kibbitzers writing in to 
say "chroot is not a security tool!" (another common mantra), amend your
footnote to say that the tool must be used with care as some known means
exist to attack it, and that it's no substitute for eschewing dangerous
software and configurations.  And maybe link to one or more of those
links.
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-slight_tweak_to_your_editorial_note">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Rick Moen [rick at linuxmafia.com]

</p>
</b><br />
<b>Tue, 24 Mar 2009 16:06:16 -0700</b>
</p>

<p>
I wrote:
</p>


<pre>
&gt; Almost not worth mentioning, but I've made a substantive albeit
&gt; de-minimus addition to your editorial note, consisting of the words
&gt; "non-root":
</pre>

<p>
Er, I actually meant to send that only to "ben@linuxgazette.net", but 
borrowed the headers from an old message that evidently had been CC'd to
TAG.  Fortunately, my general policy of not sending in e-mail anything
you couldn't live with appearing on the front page of the _New York
Times_ has paid off, yet again.  ;-&gt;
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-slight_tweak_to_your_editorial_note">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Tue, 24 Mar 2009 21:30:23 -0400</b>
</p>

<p>
On Tue, Mar 24, 2009 at 03:51:55PM -0700, Rick Moen wrote:
</p>

<pre>
&gt; 
&gt; Almost not worth mentioning, but I've made a substantive albeit
&gt; de-minimus addition to your editorial note, consisting of the words
&gt; "non-root":
&gt; 
&gt; &lt;p class="editorial"&gt;[ A common application of this would be to run a Web
&gt; or FTP server chrooted in a directory like /home/www or
&gt; /home/ftp; this provides an excellent layer of security, since even a
&gt; malicious non-root user who manages to crack that server is stuck in a
&gt; "filesystem" that contains few or no tools, no useful files other than
&gt; the ones already available for viewing or downloading, and no way to get
&gt; up "above" the top of that filesystem. This is referred to as a "chroot
&gt; jail". -- Ben ]
&gt; 
&gt; Take my word for it, without that qualifier, you'd attract quibbles from
&gt; people repeating the usual mantra:  "chroot(8) is not root safe."
&gt; (Ditto the chroot() system call.)
</pre>

<p>
I can't imagine anyone stupid enough to run a web or FTP server as root
- for that matter, many of them drop privs after startup anyway - but
certainly, it's a point worth making.
</p>


<pre>
&gt; That is, the root user, and thus also any process that can escalate to 
&gt; UID0 privilege can trivially escape from any chroot jail:
&gt; <a href='http://kerneltrap.org/Linux/Abusing_chroot'>http://kerneltrap.org/Linux/Abusing_chroot</a>
&gt; <a href='http://unixwiz.net/techtips/chroot-practices.html'>http://unixwiz.net/techtips/chroot-practices.html</a>
&gt; <a href='http://www.bpfh.net/simes/computing/chroot-break.html'>http://www.bpfh.net/simes/computing/chroot-break.html</a>
</pre>

<p>
Sure. I've got a chunk of chroot-breaking code in my "teaching files"
directory; it's stupidly simple, actually. I've always found it somewhat
offensive that it's that easy.
</p>


<pre>
&gt; (You'll note that the article lists other ways of <em>indirect</em> ways of
&gt; escalating privilege, plus "Why would anyone put <em>that</em> in a chroot
&gt; jail?" methods such as "Follow a pre-existing hard link to outside the
&gt; jail.")
</pre>

<p>
[laugh]
</p>

<p>
I <em>have</em> seen sillier things ('vi' in a restricted shell, for example),
but not often.
</p>


<pre>
&gt; If you want to be <em>almost</em> safe against kibbitzers writing in to 
&gt; say "chroot is not a security tool!" (another common mantra), amend your
&gt; footnote to say that the tool must be used with care as some known means
&gt; exist to attack it, and that it's no substitute for eschewing dangerous
&gt; software and configurations.  And maybe link to one or more of those
&gt; links.
</pre>

<p>
Not a bad idea; added.
</p>

<p>
It would be nice if there was a mechanism as simple as chroot and that
was secure enough to do - well, the kind of things that people normally
do with it. It's rather scary to consider how many root-priv chroot
accounts exist out there; I know someone who was hosting lots of
shell/web accounts on their machine. The <strong>default</strong> login was 'root@...'
- because it was "too much trouble" to help everybody set their stuff up
otherwise.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-slight_tweak_to_your_editorial_note">Back</a><hr width="50%" align="left" /><p><br /></p></div>
</body>
</html>