<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
		 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' lang='utf-8' xml:lang='utf-8'>
<head>
<title>HOWTO kill client when Xserver dies?</title>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
<link rel='stylesheet' type='text/css' href='../../../lg.css' />
</head>
<body>
<a href="../../../"><img alt="Linux Gazette" src="../../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" /></a><img alt="Tux" src="../../../gx/tux_86x95_indexed.png" id="tux" /><p id="fun">...making Linux just a little more fun!</p><div class='content articlecontent'><a name="top"></a><h3>HOWTO kill client when Xserver dies?</h3>
<p>
<b><p>
=?ISO-8859-2?Q?Petr_Vav=F8inec?= [pvavrinec at snop.cz]

</p>
</b><br />
<b>Tue, 15 Dec 2009 10:44:36 +0100</b>
</p>

<p>
Hello gurus,
</p>

<p>
I run a diskless, keyboard-less pc that boots into X11 (just plain twm 
as a window manager). The X clients I run remotedly, on a "database 
server". When someone switches off the Xserver PC (i.e. flips that big 
red switch), the X clients aren't killed - they remain on the "database 
server" forever (or at least 24 hours, that's for me the same as 
"forever"). Is there something that I could to to force them to die 
automa[t|g]ically?
</p>

<p>
Thanks in advance,
Petr
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-howto_kill_client_when_xserver_dies">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Thomas Adam [thomas.adam22 at gmail.com]

</p>
</b><br />
<b>Tue, 15 Dec 2009 10:22:19 +0000</b>
</p>

<p>
2009/12/15 Petr Vavřinec &lt;pvavrinec@snop.cz&gt;:
</p>

<pre>
&gt; Hello gurus,
&gt;
&gt; I run a diskless, keyboard-less pc that boots into X11 (just plain twm as a
&gt; window manager). The X clients I run remotedly, on a "database server". When
&gt; someone switches off the Xserver PC (i.e. flips that big red switch), the X
&gt; clients aren't killed - they remain on the "database server" forever (or at
&gt; least 24 hours, that's for me the same as "forever"). Is there something
&gt; that I could to to force them to die automa[t|g]ically?
</pre>

<p>
No.
</p>

<p>
Sometimes the simplest answers are the shortest.
</p>

<p>
-- Thomas Adam
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-howto_kill_client_when_xserver_dies">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Tue, 15 Dec 2009 07:33:45 -0600</b>
</p>

<p>
On Tue, Dec 15, 2009 at 10:44:36AM +0100, Petr Vavřinec wrote:
</p>

<pre>
&gt; Hello gurus,
&gt; 
&gt; I run a diskless, keyboard-less pc that boots into X11 (just plain
&gt; twm as a window manager). The X clients I run remotedly, on a
&gt; "database server". When someone switches off the Xserver PC (i.e.
&gt; flips that big red switch), the X clients aren't killed - they
&gt; remain on the "database server" forever (or at least 24 hours,
&gt; that's for me the same as "forever"). Is there something that I
&gt; could to to force them to die automa[t|g]ically?
</pre>

<p>
I'm not 100% clear on this "X clients on a database server" concept, but
it seems like you could run a script that monitors whether the X server
is alive or not, and kills the clients after the server fails to respond
to some number of pings.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-howto_kill_client_when_xserver_dies">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
=?UTF-8?B?UGV0ciBWYXbFmWluZWM=?= [pvavrinec at snop.cz]

</p>
</b><br />
<b>Tue, 15 Dec 2009 15:30:51 +0100</b>
</p>

<p>
Ben Okopnik napsal(a):
</p>

<pre>
&gt; On Tue, Dec 15, 2009 at 10:44:36AM +0100, Petr Vavřinec wrote:
&gt;&gt; Hello gurus,
&gt;&gt;
&gt;&gt; I run a diskless, keyboard-less pc that boots into X11 (just plain
&gt;&gt; twm as a window manager). The X clients I run remotedly, on a
&gt;&gt; "database server". When someone switches off the Xserver PC (i.e.
&gt;&gt; flips that big red switch), the X clients aren't killed - they
&gt;&gt; remain on the "database server" forever (or at least 24 hours,
&gt;&gt; that's for me the same as "forever"). Is there something that I
&gt;&gt; could to to force them to die automa[t|g]ically?
&gt; 
&gt; I'm not 100% clear on this "X clients on a database server" concept, but
&gt; it seems like you could run a script that monitors whether the X server
&gt; is alive or not, and kills the clients after the server fails to respond
&gt; to some number of pings.
&gt; 
&gt; 
</pre>

<p>
Hi Ben,
</p>

<p>
yes, I was afraid I will have to go that route. It's not that simple, 
though. When you switch the PC off and on, you'll end with two sets of 
clients, serving the same ip address, when only the second one is 
"alive". In this case I would like to kill the "older" one. It seems to 
me that I will have to sort by date+time and kill "everything but the 
first one". I was hoping that there could be a simple way...
</p>

<p>
Thanks for your valuable input,
</p>

<p>
Petr
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-howto_kill_client_when_xserver_dies">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Tue, 15 Dec 2009 09:05:05 -0600</b>
</p>

<p>
On Tue, Dec 15, 2009 at 03:30:51PM +0100, Petr Vavřinec wrote:
</p>

<pre>
&gt; Hi Ben,
&gt; 
&gt; yes, I was afraid I will have to go that route. It's not that
&gt; simple, though. When you switch the PC off and on, you'll end with
&gt; two sets of clients, serving the same ip address, when only the
&gt; second one is "alive". In this case I would like to kill the "older"
&gt; one. It seems to me that I will have to sort by date+time and kill
&gt; "everything but the first one". I was hoping that there could be a
&gt; simple way...
</pre>

<p>
Not a big problem - 'ps' can do almost all of that for you (I suspect
that, if you study the 'ps' man page long enough, you can make 'ps' cook
a 7-course French meal, find the treasure of Sierra Madre, polish the
knob at the top of the Eiffel tower, and destroy the world. Either
that, or they'll cart you off to the mental hospital because you'll
<strong>believe</strong> that it can do all of those things. <img src="../gx/smile.png" alt=":)">
</p>

<p>
Try something like this:
</p>

<pre>
ps -eo pid,etime,args|/bin/grep '[/]X :[0-9]'
</pre>

<p>
This will give you the PID, the time that the process has been running,
and the process string. Sorting by running time, killing the process,
etc. from there on should be pretty trivial.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-howto_kill_client_when_xserver_dies">Back</a><hr width="50%" align="left" /><p><br /></p></div>
</body>
</html>