
<html>
<head>
<link href="../lg.css" rel="stylesheet" type="text/css" media="screen, projection"  />
<link rel="shortcut icon" href="../favicon.ico" />
<title>Python One-Liner of the Month, a Satire LG #96</title>

<style type="text/css" media="screen, projection">
<!--

-->
</style>

<link rel="alternate" type="application/rss+xml" title="LG RSS" href="lg.rss" />
<link rel="alternate" type="application/rdf+xml" title="LG RDF" href="lg.rdf" />
<link rel="alternate" type="application/atom+xml" title="LG Atom" href="lg.atom.xml" />

</head>

<body>


<img src="../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
<p id="fun">...making Linux just a little more fun!</p>


<div class="content articlecontent">

<div id="previousnexttop">
<A HREF="okopnik.html" >&lt;-- prev</A> | <A HREF="tougher.html" >next --&gt;</A>
</div>



<h1>Python One-Liner of the Month, a Satire</h1>
<p id="by"><b>By <A HREF="../authors/orr.html">Mike Orr (Sluggo)</A></b></p>

<p>
<P> "Woomert, Woomert!"  Frink Ooblick ran into the room and shut the
door behind him.  He was clearly out of breath.

<P> "What is it, Frink?" said Woomert Foonly.  "You look like you've seen a
ghost."

<P> "There's a guy outside named Sluggo.  He says he's gonna kick my Perl ass."

<P> "Ass?"  Woomert was puzzled.  "But you don't own a donkey."

<P> "He means arse," explained Frink.  

<P> "Oh, in that case he must be talking about a camel.  A camel's behind.
What do you know about this Sluggo?"

<P> "He's the one that moved into the apartment on the corner.  He's big and
bald and has a menacing black bomber jacket.  There's a tattoo on his arm of a
snake.  And there's a patch on his jacket of a camel with a slash through it."

<P> "A Python bigot, huh?"

<P> "Looks like it.  He says he can beat our wimpy-ass Perl one-liners."

<P> "Well, we've got him beat already there."  Woomert laughed.  Everybody knows
there are no Python one-liners except 
'<TT>print&nbsp;"Hello,&nbsp;spam&nbsp;world!"</TT>'"

<P> "He wants to enter your POLOTM contest.  And---"  Frink stopped.

<P> "And what, Frink?"

<P> Frink replied quietly, "He... he said you're a dirty communist spy."

<P> "Hey, I bathe every day!  Well, well, let's put him in the contest."
Woomert mused.  "Tell him I'll give him a Perl example and he'll have to come
up with a Python example that's just as elegant.  But we'll have to find a
judge.  He certainly won't accept me as an unbiased judge."  He thought and
thought, and then banged his fist on the table.  "I know!  Elbert Arkleberry.
He's widely known as being language neutral.  I bet he'll do it.  But you,
Frink..."  He put his hand on Frink's shoulder.  "You'll have to explain and
defend the Perl example yourself."

<P> "Yikes!" said Frink and jumped.  "You want <EM>me</EM> to defend Perl
code against that animal?  He'll tear my head off."

<P> "I think it will be a good learning experience for you.  Remember how
worried you were about dealing with that <A HREF="../okopnik.html">hot babe</A>
client, and then it turned out to be no big deal.  Why don't you go outside
right now and tell this Sluggo to meet us tomorrow at ten behind the
Quick-E-Mart."

<P> "Well, OK, Woomert, if you think so.  But... can I borrow your dark
sunglasses?  I think they'll give me courage."

<P> "Sure, Frinko."  He rummaged around and found the glasses, which he hadn't
worn in three months.  "Here you go."

<P> Frink put the glasses on and left the room a bit more boldly than when he
had entered.

<H3>The Big Day</H3>

<P> The winter sun was clear but cold on the small circle that had gathered
behind the Quick-E-Mart.  Frink was sitting on the curb (or kerb
as Woomert spelled it) with his laptop open on his knees.  Sluggo was
sitting on the curb a few blocks away.  He didn't have a laptop, but Judge
Arkleberry had brought an old 486/75 for him to use.  The judge himself, an
ex football player, sat between the two sides to prevent any arguments from
boiling over.  Woomert stood in front of them with a stack of printouts.

<P> Sluggo looked over at Frink and squinted his eyes nastily.  Frink swallowed
and tried to return the gaze.  Woomert watched the two and chuckled.  "All 
right, let's begin," he said, and the staring contest was over.  They both
looked at Woomert.  He showed them a printout.  "Here's the first one," he 
said.  On the printout was written:

<BLOCKQUOTE><PRE>
PERL PROGRAM:
  perl -wpe's/at/op/g'  INPUT  

INPUT FILE:
  A cat sat on a mat with a hat.

OUTPUT:
  A cop sop on a mop with a hop.
</PRE></BLOCKQUOTE>

<P> Woomert said, "Frink, explain it."

<P> "The <KBD>-w</KBD> flag prints warnings about constructs that look like
common mistakes in Perl.  The <KBD>-p</KBD> flag means run each input line
through the expression and print the result.  Actually, what it prints is the
value of the default variable <VAR>$_</VAR>, but for a one-expression program
like this it's essentially the same thing.  <KBD>-e</KBD> means you're giving
the program on the command line.  <KBD>s</KBD> is a regular-expression
substitution.  <KBD>g</KBD> (global) means replace all occurrances on the line,
not just the first."

<P> "Thank you, Frink.  Sluggo?"

<P> Sluggo typed for a couple minutes on his laptop, and then came up with
this:

<BLOCKQUOTE><PRE>
% python -c \
&gt; "import sys; print sys.stdin.read().replace('at', 'op')," &lt;INPUT
A cop sop on a mop with a hop.
</PRE></BLOCKQUOTE>

<BLOCKQUOTE><EM>[We split the line because some browsers and printers don't
display wide &lt;PRE&gt; lines well.  Sluggo actually typed one line
without the backslash.]</EM></BLOCKQUOTE>

<P> "Zounds!" said Woomert.  "I thought Python's separate <KBD>import</KBD>
statement made any non-trivial one-liner impossible.  I forgot you can have two
commands on one line with a semicolon.  All right, explain your program,
Sluggo."

<P> "<KBD>sys</KBD> is the module that has several miscellaneous system
services.  In this case we're using <KBD>sys.stdin</KBD>, which is the
standard input filehandle.  We don't need <KBD>sys.stdout</KBD> because 
<KBD>print</KBD> prints there by default.  <KBD>.read</KBD> is a method
that returns the entire file content as a string.  Since it's now a string,
we can use the string method <KBD>.replace</KBD> on it, which substitutes
every 'at' with 'op'.  The comma at the end prevents <KBD>print</KBD> from
adding a newline, so the result is closest to the original.  Python doesn't
have an equivalent of Perl's <KBD>-w</KBD> flag, but it doesn't need it.  The
syntax is more straightforward and strict, so most of the constructs 
<KBD>-w</KBD> would complain about are errors in Python."

<P> Sluggo didn't mention that Python does have warnings and a <KBD>-W</KBD>
flag, because most Pythoneers don't use it.  The built-in warnings are few in
number and are related to much less drastic situations.  <KBD>-W</KBD> exists
in case your program raises your own custom warnings, or if you really want to
get nagged about depreciated features.

<P> The judge looked at the program, and said after a moment, "Sneaking that
import statement onto the same line is OK; we couldn't very well have a
contest without that, since Python puts basic services into libraries.
<KBD>.read</KBD> is OK, even though it slurps the entire file at once rather
than line by line.  In this trivial case it doesn't make a difference either
way.  It just means you won't want to use it on a file that's several megabytes
big.  But I'll have to reject <KBD>.replace</KBD>.  That's a literal string
substitution and doesn't give the flexibility of a regular expression.  You can
have a second try if you wish."

<P> Sluggo frowned and started an editor.  In a couple minutes he showed
another program.

<BLOCKQUOTE><PRE>
% cat program.py
import re, sys;  print re.sub(sys.argv[1], sys.argv[2], sys.stdin.read()),

% python program.py at op &lt;INPUT
A cop sop on a mop with a hop.
</PRE></BLOCKQUOTE>

<P> "OK, explain that one," said Woomert.

<P> Sluggo explained, "It's the same as the previous example but with a regular
expression.  <KBD>re.sub</KBD> is a function that does the equivalent of
Perl's <KBD>s///g</KBD>.  It automatically replaces all occurrances so you
don't need a <KBD>g</KBD> flag.  <KBD>sys.argv</KBD> is an list-- I mean, an
array-- of the command line arguments.  <KBD>sys.argv[0]</KBD> is the
program name itself, so we skip that.  <KBD>sys.stdin.read()</KBD> turns the
input file into a string, the same as above."

<P> "But the command-line syntax isn't the same," Frink objected.  "Even if
we allow the program to be in a file rather than inline."

<P> "Python doesn't need the <KBD>s///g</KBD> syntax.  It's easier on the user
if they don't have to get the slashes right, especially if you're embedding
slashes in one of the parts.  I know you can do <KBD>s!!!g</KBD> in Perl, but
my way is even more convenient."

<P> The judge spoke.  "I like the way the Python program has a simpler
command-line syntax.  But the program is much more verbose than the Perl one.
I call it a tie."

<P> "The judge has spoken," declared Woomert.  He held up another printout.

<BLOCKQUOTE><PRE>
perl -i wpe's/at/op/g'  *
</PRE></BLOCKQUOTE>

<P> "I'll have Frink demonstrate it."

<P> Frink showed on his laptop how the program edits several files in place.
"That's what the <KBD>-i</KBD> option does.  Other than that it's the same."

<P> "OK, Sluggo, it's your turn," said Woomert.

<P> Sluggo turned a deep red and didn't move.  Woomert said, "Sluggo, is
something wrong?"

<P> Sluggo sat silent a long moment.  Finally he confessed, "That's the one
case where I still use Perl."

<P> Frink was shocked.  "Does that mean you forfeit the contest?"

<P> "I guess so."  Sluggo looked at Frink for a second, then looked away.

<P> Judge Arkleberry cleared his throat.  "We'd still like to see how you'd
do it in Python."

<P> Sluggo remembered that there was a <KBD>fileinput</KBD> module, but he
couldn't remember the syntax.  So he spent a few minutes looking through the
Python Library Reference on the judge's laptop, and then wrote:

<BLOCKQUOTE><PRE>
% cat program.py
import fileinput, re, sys
for lin in fileinput.input(sys.argv[3:], inplace=1):
    print re.sub(sys.argv[1], sys.argv[2], lin),

% cat INPUT
A cat sat on a mat with a hat.

% cat INPUT2
tit tat

% python program.py at op INPUT INPUT2

% cat INPUT
A cop sop on a mop with a hop.

% cat INPUT2
tit top
</PRE></BLOCKQUOTE>

<P> Sluggo added, "I've tried and tried to think of a way to do that
Perl example consisely in Python, but I haven't.  Perl sucks rocks, but that
one case makes it worth it.  There is one thing I'm frustrated about it,
though.  Sometimes you want it to interactively ask you which matches to
change, like vim does but with multiple files.  Vim lets you search and
replace in multiple files, but you gotta do '<KBD>:w :n</KBD>, arrow up a
few times, enter' at the end of every file, and that gets tiresome.  I've
thought about writing a program to do that but haven't gotten around to it.
Maybe in next month's PyOLOTM, although it certainly won't be a one-liner, so
I'll have to think up a new title for the column."

<P> The judge looked around.  "Did Mr. Bint ever show up?"

<P> Sluggo whispered to Frink, "Who's Mr. Bint?"

<P> Frink whispered back, "He's this guy who thinks 
<A HREF="../issue89/bint.html">C is the only language worth learning</A>, and
wishes we didn't publish so many Perl and Python articles because it distracts
people from learning the One Really Useful Language in depth.  Nobody has seen
him since April.  He's a homeless guy in England, and he types his entire
article at the public library."

<P> "That's pretty f*ing amazing!" Sluggo said.  "The library here gives you
only 45 minutes a day on the Internet, and all you get is a lousy web browser,
Word and Excel.  It would take forever to write an article that way.  And how
would you test the program?"

<P> Sluggo closed the judge's notebook and stood up to leave, but Woomert
cleared his throat.  "Uh, Sluggo, there is one remaining thing we've got to
settle <EM>right now</EM>."  He put on his dark sunglasses.

<P> Sluggo's jaw tensed and he eyed Woomert closely, ready in case he made a
sudden move.  "What's that, Wal-Mart?" he asked warily.

<P> "I do bathe once a day," said Woomert, ignoring the pun on his name.

<P> "OK, you're a <EM>clean</EM> communist spy."

<P> "One whom Thomas Adam, the <A HREF="../authors/adam.html">Linux Weekend
Mechanic</A>, has suggested should stand for the office of British Prime
Minister," said Woomert, with a flourish and a tip of his hat.

<P> "He means 'run for the office of'," explained Frink to Sluggo.

<P> Sluggo held out his hand to Frink and said, "The best tool for the job."
Frink shook his hand and echoed, "The best tool for the job."
Sluggo slapped him on the back and said, "You're all right, even if do have an
idiot name."  Frink replied indignantly, "Hey, it's not as bad as 'Woomert
Foonly'."

<H2>Epilogue</H2>

<P> A few hours later, Woomert was at his office when the door opened 
again, and Frink and Sluggo emerged chatting noisily.

<P> "It looks like you made a new friend, Frink," observed Woomert.

<P> "Sluggo and I are gonna go beat up some Visual Basic weenies," said
Frink excitedly, putting on the old steel-toe boots Sluggo had given him (two
sizes too big) and stuffing a lead paperweight in his pocket.

<P> "Yeah, I know where they hang out, under the bridge on the edge of town,"
explained Sluggo.

<P> "But what about all that best-tool-for-the-job stuff this morning?  Have
you forgotten it already?"

<P> "Oh, we were only talking about real languages," said Frink, dashing
out the door with Sluggo.

<P> "Have fun!" Woomert called after them with some trepidation.

<P> "We will!" shouted Frink in the distance.

</p>


<!-- *** BEGIN author bio *** -->
<P>&nbsp;
<P>
<!-- *** BEGIN bio *** -->
<hr>
<P>
<IMG ALT="picture" SRC="../gx/2003/authors/orr.jpg" WIDTH="235" HEIGHT="333" ALIGN="left"  HSPACE="10" VSPACE="10" class="bio">
<em>
Mike is a Contributing Editor at <I>Linux Gazette</I>. He has been a
Linux enthusiast since 1991, a Debian user since 1995, and now Gentoo.
His favorite tool for programming is Python.  Non-computer interests include
martial arts, wrestling, ska and oi! and ambient music, and the international
language Esperanto.  He's been known to listen to Dvorak, Schubert,
Mendelssohn, and Khachaturian too.
</em>
<br CLEAR="all">
<!-- *** END bio *** -->

<!-- *** END author bio *** -->

<div id="articlefooter">

<p>
Copyright &copy; 2003, Mike Orr (Sluggo). Released under the <a
href="http://linuxgazette.net/copying.html">Open Publication license</a>
unless otherwise noted in the body of the article. Linux Gazette is not
produced, sponsored, or endorsed by its prior host, SSC, Inc.
</p>

<p>
Published in Issue 96 of Linux Gazette, November 2003
</p>

</div>


<div id="previousnextbottom">
<A HREF="okopnik.html" >&lt;-- prev</A> | <A HREF="tougher.html" >next --&gt;</A>
</div>


</div>






<div id="navigation">

<a href="../index.html">Home</a>
<a href="../faq/index.html">FAQ</a>
<a href="../lg_index.html">Site Map</a>
<a href="../mirrors.html">Mirrors</a>
<a href="../mirrors.html">Translations</a>
<a href="../search.html">Search</a>
<a href="../archives.html">Archives</a>
<a href="../authors/index.html">Authors</a>
<a href="../contact.html">Contact Us</a>

</div>



<div id="breadcrumbs">

<a href="../index.html">Home</a> &gt; 
<a href="index.html">November 2003 (#96)</a> &gt; 
Article

</div>





<img src="../gx/2003/sit3-shine.7-2.gif" id="tux" alt="Tux"/>




</body>
</html>

