<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
		 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' lang='utf-8' xml:lang='utf-8'>
<head>
<title>inquiry on tcpdump</title>
<meta http-equiv='Content-Type; charset=utf-8' />
<link rel='stylesheet' type='text/css' href='../../../lg.css' />
</head>
<body>
<a href="../../../"><img alt="Linux Gazette" src="../../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" /></a><img alt="Tux" src="../../../gx/tux_86x95_indexed.png" id="tux" /><p id="fun">...making Linux just a little more fun!</p><div class='content articlecontent'><a name="top"></a><h3>inquiry on tcpdump</h3>
<p>
<b><p>
Ignacio, Domingo Jr Ostria - igndo001 [DomingoJr.Ignacio at postgrads.unisa.edu.au]

</p>
</b><br />
<b>Tue, 1 Jul 2008 13:24:03 +0930</b>
</p>

<p>
Hello everyone,
</p>

<p>
Good day!
</p>

<p>
I am using tcpdump in my linux system to sniff and capture tcp packet
headers. 
</p>

<p>
I  inserted a new variable, srtt, into  the print_tcp.h header file  and
tcp.c source code.
I want  to print/ouput/capture  the inserted variable srtt into  the tcp
packet headers once I run tcpdump. 
Any idea on how to go about this?
</p>

<p>
However, once I run tcpdump with all the changes I made (of course,
after configuring and making) and  I got an error:
Bad header length and &lt;bad opt&gt;.
</p>

<p>
I tried to increase the snaplength to 1514 but I still got the same
errors. What seems to be the problem, anyone? Thanks!
</p>

<p>
Also, I cannot see the inserted srtt variable in the tcpdump trace
files. Any idea on these guys?
</p>

<p>
I don't know if this is the right venue to ask these question since this
is for linux queries but still I am hoping that anyone has an experience
on this. Help would be appreciated.
</p>

<p>
Cheers, Dom
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-inquiry_on_tcpdump">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ren&eacute; Pfeiffer [lynx at luchs.at]

</p>
</b><br />
<b>Tue, 1 Jul 2008 09:05:15 +0200</b>
</p>

<p>
Hello!
</p>

<p>
On Jul 01, 2008 at 1324 +0930, Ignacio, Domingo Jr Ostria - igndo001 appear=
ed and said:
</p>

<pre>
&gt; [...]
&gt; I am using tcpdump in my linux system to sniff and capture tcp packet
&gt; headers.
&gt;
&gt; I  inserted a new variable, srtt, into  the print_tcp.h header file  and
&gt; tcp.c source code.
&gt; I want  to print/ouput/capture  the inserted variable srtt into  the tcp
&gt; packet headers once I run tcpdump.
&gt; Any idea on how to go about this?
&gt;
&gt; However, once I run tcpdump with all the changes I made (of course,
&gt; after configuring and making) and  I got an error:
&gt; Bad header length and &lt;bad opt&gt;.
</pre>

<p>
Can you provide the full command line you used and tell us which Linux
distribution this is (Fedora, Debian, Gentoo, etc.)?
</p>

<p>
Best,
Ren&eacute;.
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-inquiry_on_tcpdump">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Jim Jackson [jj at franjam.org.uk]

</p>
</b><br />
<b>Tue, 1 Jul 2008 09:16:08 +0100 (BST)</b>
</p>

<p>
On Tue, 1 Jul 2008, Ignacio, Domingo Jr Ostria - igndo001 wrote:
</p>


<pre>
&gt; I am using tcpdump in my linux system to sniff and capture tcp packet
&gt; headers.
&gt;
&gt; I  inserted a new variable, srtt, into  the print_tcp.h header file  and
&gt; tcp.c source code.
&gt; I want  to print/ouput/capture  the inserted variable srtt into  the tcp
&gt; packet headers once I run tcpdump.
&gt; Any idea on how to go about this?
&gt;
&gt; However, once I run tcpdump with all the changes I made (of course,
&gt; after configuring and making) and  I got an error:
&gt; Bad header length and &lt;bad opt&gt;.
&gt;
&gt; I tried to increase the snaplength to 1514 but I still got the same
&gt; errors. What seems to be the problem, anyone? Thanks!
&gt;
&gt; Also, I cannot see the inserted srtt variable in the tcpdump trace
&gt; files. Any idea on these guys?
&gt;
&gt; I don't know if this is the right venue to ask these question since this
&gt; is for linux queries but still I am hoping that anyone has an experience
&gt; on this. Help would be appreciated.
</pre>

<p>
This is a specialist query about making changes to the source code of 
tcpdump. I suspect you really need to find a suitable network programming 
list or newsgroup.
</p>

<p>
In fact I have just now googled for
</p>

<pre>
   tcpdump homepage
</pre>

<p>
and found
</p>

<p>
   <a href="http://www.tcpdump.org/">http://www.tcpdump.org/</a>
</p>

<p>
And under "Mailing Lists" seen that there is a tcpdump-workers email list.
There you are likely to find people who know the working of the tcpdump 
code and there are a <em>LOT</em> more likely to be able to help you.
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-inquiry_on_tcpdump">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ignacio, Domingo Jr Ostria - igndo001 [DomingoJr.Ignacio at postgrads.unisa.edu.au]

</p>
</b><br />
<b>Wed, 2 Jul 2008 15:21:31 +0930</b>
</p>

<p>
Hi Rene' and the rest of the gang,
</p>

<p>
The filter command line is:
</p>

<pre>
$tcpdump tcp -vvv -i eth0
</pre>

<p>
That was the command I used to capture the tcp packet headers 
</p>

<p>
I thought it has something to do with the snaplen that I got the bad opt
and header length too short&lt;20 error that I modified my filter to up to
1514 bytes instead of the default 96 bytes.
 
<pre>
$tcpdump tcp -vvv -s 1514 -i eth0
</pre>

<p>
By the way, I am using fedora 4.
</p>

<p>
Thanks for the help.
</p>

<p>
Cheers,
Dom
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-inquiry_on_tcpdump">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ren&eacute; Pfeiffer [lynx at luchs.at]

</p>
</b><br />
<b>Thu, 3 Jul 2008 23:18:57 +0200</b>
</p>

<p>
Hello, Dom!
</p>

<p>
On Jul 02, 2008 at 1521 +0930, Ignacio, Domingo Jr Ostria - igndo001 appear=
ed and said:
</p>

<pre>
&gt; Hi Rene' and the rest of the gang,
&gt;
&gt; The filter command line is:
&gt;
&gt; $tcpdump tcp -vvv -i eth0
&gt;
&gt; That was the command I used to capture the tcp packet headers
</pre>

<p>
Well, that's what the command does, but you want to extract round trip
times as far as I understood your project. tcpdump can't do that. You
have to analyse the timestamps and the sequence numbers yourself or use
a different tool for that. Ethereal/Wireshark has some plugins to do
TCP stream analysis. You can also use <a href="http://www.tcptrace.org/">http://www.tcptrace.org/</a> or
similar tools for further analysis, but I don't think tcpdump can do
much more than collecting the data.
</p>

<p>
Best,
Ren&eacute;.
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_mail.html#mb-inquiry_on_tcpdump">Back</a><hr width="50%" align="left" /><p><br /></p></div>
</body>
</html>