<!--startcut  ==============================================-->
<!-- *** BEGIN HTML header *** -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML><HEAD>
<title>Developing Web Applications - Part II LG #49</title>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#0000AF"
ALINK="#FF0000">
<!-- *** END HTML header *** -->

<!-- *** BEGIN navbar *** -->
<A HREF="index.html"><IMG ALT="[ Table of Contents ]" 
	SRC="../gx/indexnew.gif" WIDTH=163 HEIGHT=60 ALIGN=bottom ></A>
<A HREF="../index.html"><IMG ALT="[ Front Page ]" 
	SRC="../gx/homenew.gif" WIDTH=163 HEIGHT=60 ALIGN=bottom></A>
<A HREF="pramode.html"><IMG ALT="[ Prev ]" SRC="../gx/back2.gif" WIDTH=41 HEIGHT=60 ALIGN=bottom></A>
<A HREF="../faq/index.html"><IMG ALT="[ Linux Gazette FAQ ]" 
	SRC="./../gx/dennis/faq.gif"WIDTH=163 HEIGHT=60 ALIGN=bottom></A>
<A HREF="silva2.html"><IMG ALT="[ Next ]" SRC="../gx/fwd.gif" WIDTH=41 HEIGHT=60 ALIGN=bottom  ></A>
<!-- *** END navbar *** -->

<!--endcut ============================================================-->

<H4>
"Linux Gazette...<I>making Linux just a little more fun!</I>"
</H4>

<P> <HR> <P> 
<!--===================================================================-->

<center>
<H1><font color="maroon">Developing Web Applications - Part II</font></H1>
<H4>By <a href="mailto:afsilva@liberty.edu">Anderson Silva</a></H4>
</center>
<P> <HR> <P>  

<!-- END header -->





<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: 8.333333mm; color: Black; background-color: White; ">&nbsp;&nbsp;&nbsp;
As I promised, I was going to give you guys another example of a php3 program.
This program is a very simple program, and yet somewhat useful.</div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: 8.333333mm; color: Black; background-color: White; ">&nbsp;&nbsp;&nbsp;
One night, I was at the university working and I tried to call home to
talk to my wife. Unfortunately, I had left my computer connected that day,
and could not get through. So, since my computer was running Apache, I
decided to scan through the IPs of my ISP , and find out which computer
was my computer, so I could telnet to it, and remotely disconnect it.</div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: 8.333333mm; color: Black; background-color: White; ">&nbsp;&nbsp;&nbsp;
The fastest, and simplest way to do this was either through php3 or java,
but since I am not very fond of java applets, I decided to do it in php3.</div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; ">&nbsp;&nbsp;&nbsp;
And here is how it goes:</div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&lt;?</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
//Author: Anderson Silva</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
//Date: September, 1999</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
//Opens socket and goes through a bunch of sequential IPs, and</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
//it returns all the address that have a web server running.</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">&nbsp;
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
// This loop will go through all addresses in the block 10.0.0.x</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
// The 10.0.0.x series is a fictional example, these IPs are normally</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
// for intranet addresses, I am just trying to keep my ISP safe from</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
// all of you guys :-)</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
for($i=1; $i &lt; 256; $i++)</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
{</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// $path is the variable that will hold the URL you are testing.</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$path = "http://10.0.0.".$i;</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">&nbsp;
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Opens socket on server PAI, port 80.</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$fp = fsockopen("pai", 80, &amp;$errno, &amp;$errstr);</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">&nbsp;
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Sends the HTTP request that returns the info we need to know.</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
fputs($fp,"GET $path HTTP/1.0\n\n");</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
set_socket_blocking($fp, false);</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">&nbsp;
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// This is the string we wait for as a reply to the HTTP request.</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$str2 = "HTTP/1.0 200 OK";</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">&nbsp;
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Gives the program 2 seconds to try to connect to the server.</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Sleep(2);</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; ">&nbsp;
<br><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Captures the line from the
HTTP request.</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
$line = fgets($fp, 16);</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// If str2 is the same line, then we have a match, and there is a web</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// server running. Then go ahead and show me the name of the server with</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// a link to it.</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
if (strcmp($line, $str2) == 0)</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
echo "&lt;A HREF=".$path.">".gethostbyaddr($pathhost)."&lt;/a>&lt;br>\n";</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
fclose($fp);</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>&nbsp;&nbsp;&nbsp;
}</b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: normal; color: Black; background-color: White; "><b>?></b></div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: 8.333333mm; color: Black; background-color: White; ">&nbsp;&nbsp;&nbsp;
One important observation, this process is very simple, but it is very
inefficient, since for every IP you check you will wait a maximum of 2
seconds. So, don't abuse this script, because you will probably get a time
out operation from your web server, or you will be stuck waiting for all
the iterations for a long time.</div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">
<div style="text-indent: 0.00mm; text-align: left; line-height: 8.333333mm; color: Black; background-color: White; ">&nbsp;&nbsp;&nbsp;
But still, it is a good example of what you as a home user can do with
php3.</div>
</div>

<div style=" 
padding: 0.00mm 0.00mm 0.00mm 0.00mm; ">&nbsp;
<div style="text-indent: 0.00mm; text-align: left; line-height: 8.333333mm; color: Black; background-color: White; ">&nbsp;&nbsp;&nbsp;
Next month, I will write yet another example of php3 program, this time
I will show you how to create your own guest book, using php3 and mySQL.</div>
</div>




<!-- *** BEGIN copyright *** -->
<P> <hr> <P> 
<H5 ALIGN=center>

Copyright &copy; 2000, Anderson Silva<BR> 
Published in Issue 49 of <i>Linux Gazette</i>, January 2000</H5>
<!-- *** END copyright *** -->

<!--startcut ==========================================================-->
<P> <HR> <P>
<!-- *** BEGIN navbar *** -->
<A HREF="index.html"><IMG ALT="[ Table of Contents ]" 
	SRC="../gx/indexnew.gif" WIDTH=163 HEIGHT=60 ALIGN=bottom ></A>
<A HREF="../index.html"><IMG ALT="[ Front Page ]" 
	SRC="../gx/homenew.gif" WIDTH=163 HEIGHT=60 ALIGN=bottom></A>
<A HREF="pramode.html"><IMG ALT="[ Prev ]" SRC="../gx/back2.gif" WIDTH=41 HEIGHT=60 ALIGN=bottom></A>
<A HREF="../faq/index.html"><IMG ALT="[ Linux Gazette FAQ ]" 
	SRC="./../gx/dennis/faq.gif"WIDTH=163 HEIGHT=60 ALIGN=bottom></A>
<A HREF="silva2.html"><IMG ALT="[ Next ]" SRC="../gx/fwd.gif" WIDTH=41 HEIGHT=60 ALIGN=bottom  ></A>
<!-- *** END navbar *** -->
</BODY></HTML>
<!--endcut ============================================================-->
