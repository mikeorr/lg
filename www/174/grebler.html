<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="utf-8" xml:lang="utf-8">
<head>
<title>Henry's Techno-Musings: My Help System LG #174</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../lg.css" type="text/css" media="screen, projection"  />
<link rel="alternate" type="application/rss+xml" title="LG RSS" href="../lg.rss" />
<link rel="alternate" type="application/rdf+xml" title="LG RDF" href="../lg.rdf" />
<!-- link rel="alternate" type="application/atom+xml" title="LG Atom" href="lg.atom.xml" / -->
<link rel="shortcut icon" href="../favicon.ico" />

<style type="text/css" media="screen, projection">
<!--

-->
</style>

</head>
<body>

<a href="../">
<img src="../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
</a>
<p id="fun">...making Linux just a little more fun!</p>

<div id="navigation">
<table summary="masthead" width="100%">
<tr>
<td align="center" colspan="3" style="font-size: 10px; font-weight: bold">
<a href="../index.html">Home</a>
<a href="http://linuxgazette.net">Main Site</a>
<a href="../faq/index.html">FAQ</a>

<a href="../lg_index.html">Site Map</a>
<a href="../mirrors.html">Mirrors</a>
<a href="../mirrors.html">Translations</a>
<a href="../search.html">Search</a>
<a href="../archives.html">Archives</a>
<a href="../authors/index.html">Authors</a>
<a href="http://lists.linuxgazette.net/listinfo.cgi">Mailing Lists</a>
<a href="../jobs.html">Join Us!</a>
<a href="../contact.html">Contact Us</a>

<hr width="99%" style="border: 1px inset #000033">
</td>
</tr>
<tr>
<td width="40%" align="left" style="font-size: 10px; font-weight: bold">
The Free International Online Linux Monthly
</td>
<td width="20%" align="center" style="font-size: 10px; font-weight: bold">
ISSN: 1934-371X
</td>
<td width="40%" align="right" style="font-size: 10px; font-weight: bold">
Main site: <a href="http://linuxgazette.net">http://linuxgazette.net</a> 
</td>
</table>
</div>


<div id="breadcrumbs1">

<a href="../index.html">Home</a> &gt; 
<a href="index.html">May 2010 (#174)</a> &gt; 
Article

</div>

<div class="articlecontent1">
<div class="content">

<div id="previousnexttop">
<A HREF="dyckoff.html" >&lt;-- prev</A> | <A HREF="grebler1.html" >next --&gt;</A>
</div>

<h1>Henry's Techno-Musings: My Help System</h1>
<p id="by"><b>By <a href="../authors/grebler.html">Henry Grebler</a></b></p>


<img src="../gx/minilogos/technomusings.jpg" alt="Techno-Musings image" align="left" style="margin-right: 50px; margin-bottom: 15px;" />

<h3>Preamble</h3>

<p>
If a doctor or an electrician came to your house empty-handed, you'd
be a bit bemused, right? (I suppose, these days, if a doctor came to
your house, you'd be astonished! But let's not get side-tracked.) You
expect the professional and the tradesman to come with tools. How else
is she going to do her job?
</p>

<p>
Yet, in the computer industry, people show up on their first day at
work in a suit. And that's it. And, sometimes, not in a suit.
</p>

<p>
Strangely, not only are we not expected to bring our own tools, often
the very idea of computer people relying on tools is considered a
deficiency, a weakness. <i>What?! You look phone numbers up in a
directory! What a wuss! A real sysadmin would just memorise the phone
book!</i>
</p>

<h3>Context</h3>

<p>
I do not come to work empty-handed; I come with a large toolkit. Most
of what I know fits into several classes. It also fits on a CD.
</p>

<p>
These are the components of my toolkit:
</p>

<ol>
<a name="HAL"></a>
<li>HAL - Henry Abstraction Layer</li>
<li>Muscle memory</li>
<li>Help System</li>
<li>History files</li>
</ol>

<p>
This article is about the third of these.
</p>

<h3>Motivation</h3>

<p>
Someone comes to me and asks, "What do you know about SAN, Henry?"
</p>

<p>
"I don't know," I reply. "Let's have a look."
</p>

<pre class="code">
	help san
</pre>

<p>
I am presented with help on the <strong>San</strong>dringham train timetable and
nui<strong>san</strong>ce calls, in addition to quite a lot of practical information on
SAN accumulated over many years.
</p>

<p>
My <tt>help</tt> command is analogous to something which is a cross
between <tt>apropos</tt> and some implementations of <tt>man</tt>. It
has the wildcarding properties of <tt>apropos</tt>, but gives full
answers like <tt>man</tt> rather than the headings returned by
<tt>apropos</tt>.
</p>

<p>
It's different from <tt>man</tt> and complementary. <tt>man</tt>
contains reference information; the information returned by
<tt>help</tt> is more like what you might find in a HOWTO or a
quick-start guide. <tt>man</tt> tends to contain complete information
on a topic; the information returned by <tt>help</tt> is often
fragmentary, incomplete and very basic.
</p>

<p>
Unlike <tt>man</tt> which is purely technical and only for the machine
I'm on, <tt>help</tt> is not restricted to a single platform; nor is
it restricted to technical matters. People who know me might be
shocked to learn that I have help on Microsoft offerings. I also have
help on how to use my bank accounts.
</p>


<h3>Invoking help</h3>


<p>
To use my help command, I type

<pre class="code">
	help string
</pre>

where <strong>string</strong> is any string which I think might be
relevant. For example,

<pre class="code">
	help rpm
</pre>

should give me help on <tt>rpm</tt>.
</p>

<h3>My <tt>help</tt> directory</h3>

<p>
My <tt>help</tt> directory is <strong>$HOME/help</strong>. I was not
very consistent at first. Arguably, I'm still not. From what I can
see, my earliest entry is dated 14 Aug 1992.
</p>

<p>
These days, I work like this. Each entry is a file. Each file that I
want to be able to look up has <strong>help_</strong> as the first
part of its filename. There may have been a reason for this, though,
honestly, I don't recall. Perhaps I thought there could be other
entries (non-text files like PDFs) that I would access some other way.
I also had subdirectories. I guess I did not want them "getting in the
way" when I was looking stuff up (so their names never began with
<strong>help_</strong>). I don't use subdirectories very often these
days; I can't recall the last time I did.
</p>

<p>
There's a subdir called <strong>FIREFOX</strong> which contains some
html files; another called <strong>HTML</strong> which includes
<strong>Quick_HTML_Reference.html</strong>; another called
<strong>fedora-install-guide-en_US</strong>. But these subdirs are on
the periphery of my help system.
</p>

<p>
The main game is the body of <strong>help_*</strong> files.
</p>

<p>
The "rules" are very simple: 
</p>

<ul>
<li>
<p>

	Put into the name of the file any keywords that I think I
	might use to find the info at some time in the future.
	Separate with underscores to keep it readable. Keep the entire
	filename in lower case.
</p>
</li>

<li>
	Put into the file any information I want.
</li>
</ul>

<h3>My <tt>help</tt> command</h3>

My <tt>help</tt> command is implemented as a <tt>bash</tt> function
defined in one of my many startup scripts (which form part of my <A
HREF="#HAL">HAL</A>).

<pre class="code">
function help {
# Assume no arg means standard bash help

        if [ "$1" = "" ]
        then
                builtin help
                return
        fi
        echo 'For bash help, use builtin help'

# avoid backup files:   
        (set -x; less `ls ~/help/help_*${1}* | grep -v '~$'`)
        if [ $? -ne 0 ]
        then                    # try for bash help
                builtin help $1
        fi
}
</pre>

<p>
The first few lines deal with the fact that I have appropriated
<tt>bash</tt>'s builtin <tt>help</tt> command. So, if I just type
<strong>help</strong>, I get <tt>bash</tt>'s help.
</p>

<p>
The line with the parentheses does the work. I'll come back to it.
</p>

<p>
The last 4 lines are supposed to help me coexist with <tt>bash</tt>.
In theory, if I don't have help on the subject in my database, maybe I
meant the bash command. In writing this up, I have discovered that
this part doesn't work! This supports somebody's law that every
non-trivial program has bugs.
</p>

<p>
It also supports the notion that something does not have to be perfect
to be extremely useful. "Perfect is the enemy of good", as Ben said
recently.
</p>


<h3>The main command</h3>

<pre class="code">
	less `ls ~/help/help_*${1}* | grep -v '~$'`
</pre>

<p>
Let's start at the inside.
</p>

<pre class="code">
	ls ~/help/help_*${1}*
</pre>

<p>
This lists all files in <strong>~/help</strong>
(ie <strong>$HOME/help</strong>) which start with <strong>help_</strong>
and have the specified string somewhere in the rest of the filename.
</p>

<p>
I use <tt>emacs</tt> as my editor. It creates backup files which have
tilda (<strong>~</strong>) as the last character of the filename. I
don't want to see these backup files; the <tt>grep</tt> removes them
from the list.
</p>

<p>
The <tt>less</tt> command then displays the files left in the list,
sometimes one file, often several.
</p>

<p>
Before I talk about my <tt>less</tt> command, I'll make one more
comment about the line with the parentheses. It starts with
<strong>set -x</strong>. Long ago, when I first met Unix (before Linux
existed, I think), I read somewhere that Unix commands do their work
quietly. That isn't how I like to operate; I like lots of
confirmation: this is what I did, this is the command I used, these
are the files on which I operated.
</p>

<p>
I don't expect others to share my preferences. Those who prefer
silence can omit the <strong>set -x</strong>.
</p>

<h3>My 'less' command</h3>

<p>
Using <tt>less</tt> on several files would be vastly less useful without a
little wrinkle.
</p>

<p>
I prefer to use <tt>less(1)</tt> as my $PAGER. However, standard
<tt>less</tt> needs a little help. I want to be able to move from one
file to the next and back quickly. By default, less uses
<strong>:n</strong> and <strong>:p</strong> for this, but that's 3
keystrokes, and there is no way that 3 keystrokes can achieve what I
want. I guess I could program the function keys to generate
<strong>:n</strong> and <strong>:p</strong>,
but there are issues with that.
</p>

<p>
I prefer to use the LEFTARROW and RIGHTARROW keys. By default, <tt>less</tt>
uses these to mean "scroll horizontally", but I never want to be able
to scroll horizontally in <tt>less</tt>, so I appropriate those keys.
</p>

<p>
I want RIGHTARROW to mean "next file" and LEFTARROW to mean "previous
file".
</p>

<p>
If you want to do things my way, get hold of my
<strong>.lesskey</strong> file and either copy it to your home
directory or use it to edit your own <strong>.lesskey</strong> file -
see <tt>lesskey(1)</tt>. Either way, check what's there: you may not want
everything I have. See below.
</p>

<p>
Then run <strong>lesskey</strong> to compile the
<strong>.lesskey</strong> file into something <tt>less</tt> can use.
</p>

<h3>Analysis</h3>

<p>
In my view this is a wonderful example of appropriate technology. It's
appropriate when all factors are taken into consideration. The most
important factor is the customer. I designed this to be used by me, no
one else. Of course, "design" is a gross overstatement; the mechanism
grew organically.
</p>

<p>
Most of my interaction with computers is via the command line,
typically running in an <tt>xterm</tt>. Whenever I can, I use
<tt>bash</tt>. That's pretty nearly always: <tt>bash</tt> is the
default shell on Linux (that which we think of as <tt>/bin/sh</tt> is
really <tt>bash</tt>); it is now standard (<tt>/bin/bash</tt>) on
recent versions of Solaris; and is readily available on BSD. When I'm
not typing commands, it's probably because I've invoked <tt>emacs</tt>.
</p>

<p>
Whether I'm in <tt>emacs</tt> or in <tt>bash</tt>, most of the 
commands I use are the same.
</p>

<p>
So, editing a help file involves one of my bread-and-butter
activities; nothing new to learn.
</p>

<p>
Probably the next most common thing I do is use <tt>less</tt> to
browse files. It is my mail reader of choice (unless I absolutely
can't use <tt>less</tt>). Consequently, reading my help files also
involves one of my bread-and-butter activities.
</p>

<p>
Most importantly, it's wonderfully portable. I can take the whole <tt>help</tt>
directory (and other stuff) on a CD wherever I go and copy it to local
disk in no time.
</p>

<p>
The system is deliberately as unstructured as possible. There is a
danger that if I make entering information too onerous, I won't do it.
In many organisations, generally helpful information must be entered
in some markup language. If I have to organise my help information at
the time I'm recording it, I'm going to have to suspend doing whatever
task I'm working on. That won't do.
</p>

<p>
Typically, I just swipe and paste text from where I'm working into a
file. I'm just creating aids for myself - the equivalent of rough
notes one might write on a scrap of paper.
</p>

<p>
If, some time later, I return to a help file because I'm working in
the same area, I might clean the information a little. Or not.
</p>

<p>
The major purpose is to save time. If I spend a long time trying to
work out how to do something, I don't want to have to repeat that
exercise in the future.
</p>

<p>
Of course I'm human and fallible. Sometimes I'm so happy that I got
the thing to work, I just jump in and use it; I forget to record
useful information. But, hopefully, I'll catch it next time.
</p>


<h3>Typical use</h3>

<p>
Let's take an example. I've recently moved to FreeBSD. I'm a bit of a
newbie. Let's see what I feel I need to know.
</p>

<pre class="code">
	ls -lat $HOME/help/help_*bsd* | grep -v '~' | cut -c 30-
 3897 Mar 21 07:35 /home/henryg/help/help_freew_bsd_diary
 3030 Mar 19 14:50 /home/henryg/help/help_bsd_build_notes
  100 Mar 19 11:12 /home/henryg/help/help_bsd
  113 Mar 17 16:38 /home/henryg/help/help_bsd_admin
  261 Mar 17 10:37 /home/henryg/help/help_bsd_build
</pre>

<p>
So when I go <strong>help bsd</strong>, the effect is to load the
above 5 files into <tt>less</tt>. Because I can use the left- and
right-arrow keys to navigate from one file to the next, and because
these keys auto-repeat, I can get to any file very quickly. Since I
put this stuff in, it follows that I know what's there (more or less).
The way my brain works these days, I'm much better at recognising and
selecting than I am at recalling.
</p>

<p>
If I'm looking at a file with <tt>less</tt>, and I decide I want to
modify the file in some way, I can simply type <strong>v</strong> and
I'm in <tt>emacs</tt> ready to edit.
</p>

<p>
If all else fails, I can <tt>grep</tt> through the help files since they are
just text files. Or I can list the <tt>help</tt> directory to see if any of the
filenames trigger recognition.
</p>

<p>
This rarely happens, but let's say I'm looking for some info on xxx
and <strong>help xxx</strong> doesn't produce anything useful. I
resort to <tt>grep</tt> and find the info. Why didn't <strong>help
xxx</strong> deliver the relevant file? I realise that I have
"misfiled". For instance, I stored some info in
<strong>help_audio</strong> but I subsequently look for it with
<strong>help sound</strong>. Ok, simple solution:

<pre class="code">
	mv help_audio help_audio_sound
</pre>

I can now find the relevant help by using either string (or a
substring). For instance, either of these commands will deliver the
above file (and possibly others):

<pre class="code">
        help aud
        help soun
</pre>
</p>

<p>
I can "file" some information under a dozen categories (strings)
virtually for free. I simply need to include more items in the name of
the help file.
</p>

<h3>The contents of help files</h3>

<p>
Please remember that the information in a help file is what I believe
will be useful to me at some time in the future. If you are interested
in such a mechanism for yourself, I expect you to put into your help
files the sort of information that you will find useful. That could be
quite different.
</p>

<p>
Just so you get the flavour, here's the first part of
<strong>help_rpm</strong>:
</p>

<pre class="code">
### For complicated stuff see help_rpm2
### For Uninstall see help_rpm_uninstall
------------------------------------------------------------------------

RPM=wxpythongtk-2.4.2.4-1.rhfc2.nr.i386.rpm

rpm --query -p $RPM   -i
rpm --query -p $RPM   -l | cut -d / -f1-3 | uniq | head
rpm --query -p $RPM   -l | wc
rpm --query -p $RPM   -l

# Test Install
#                               rpm -i --test $RPM      # Use the long option
rpm --install --test $RPM
# Really install
#                               rpm -i $RPM             # Use the long option
rpm --install $RPM

++++++++++++++++++++++++++++++++++++++++++++++++
Tough installs for extreme situations:

rpm -i $RPM --force
rpm -i $RPM --nodeps            # Don't check dependencies

</pre>

<p>
Typically, to perform an install, I set the variable
<strong>RPM</strong>, then copy and paste each of the
<tt>rpm</tt> commands into an <tt>xterm</tt>. If I want, I can pretty
much turn my brain off and run on autopilot.
</p>

<p>
More importantly, it saves me a lot of typing; it minimises typos; and
it allows me to concentrate on more global matters, not the mechanics
of an install.
</p>

<p>
One more example: here's help on the string <strong>pub</strong>.
(Yours might tell you about watering holes.) I have two help files
concerned with public transport:
<strong>help_public_transport</strong> and
<strong>help_aaa_public_transport</strong>. I created the first one
first. It has some detailed information on bus routes. It's the one I
usually don't want to see. So, when I created the second file I put
<strong>aaa</strong> at the start of the string so that it will always
show as the first file in <tt>less</tt> (because of the way
<tt>ls</tt> works).
</p>

<p>
When I want to go somewhere by public transport, I visit <A
HREF="http://jp.metlinkmelbourne.com.au/metlink/XSLT_TRIP_REQUEST2?language=en">Viclink
Journey Planner</A>. It's a marvellous resource, but it can be a
little too general at times. To get answers more quickly, it helps to
provide detailed strings, strings that I would never bother to
remember and could probably never type correctly. So my help shows me
the strings I need for the stations I frequent:
</p>

<pre class="code">
Gardenvale Railway Station (Brighton)

Ormond Railway Station (Ormond)
Caulfield Railway Station (Caulfield East)
Malvern Railway Station (Malvern) 
Armadale Railway Station (Armadale) 

Southern Cross Railway Station (Melbourne City) 
Richmond Railway Station (Richmond)
Flinders Street Railway Station (Melbourne City)
Melbourne Central Railway Station (Melbourne City)
</pre>

<p>
I just paste the relevant strings into the form and get answers very
quickly.
</p>

<h3>Extensions</h3>

<p>
After many years working with one organisation, recently I've been
contracting to different companies. I am just in the process of
working out how I want to handle this. I'm thinking that the stuff I
gather while working at X Corp could go into directory
<strong>help_X_Corp</strong> and the Y Corp stuff could go into
<strong>help_Y_Corp</strong>. I started doing something along these
lines at my last contract.
</p>

<p>
I'm leaning towards formalising this, using a modified form of the
<tt>help</tt> command. The key line is:
</p>

<pre class="code">
	               v
	less `ls ~/help*/help_*${1}* | grep -v '~$'`
	               ^
</pre>

<p>
I've added an extra asterisk to wildcard across ALL <tt>help</tt> directories.
</p>

<h3>In Conclusion</h3>

<p>
That's it in a nutshell. Anyone can adapt what I've done to suit
him/herself. That's the beauty of computers and especially open source
software: near infinite flexibility and customisation. It's such a
shame that we waste the power on "look and feel" (skins and themes).
</p>

<p>
"Off the rack" fits most people reasonably well without fitting anyone
perfectly. But anyone can adapt a system like this to suit as closely
as desired - with enough effort.
</p>

<p>
It doesn't matter if you are a computer nerd or a neophyte.
It doesn't really matter what OS you use (though Microsoft makes it
harder). You need an editor and some way to select and display files.
The only difficulty I can see is if your only access is through GUIs,
because then you have to write (or get someone to write) the selection
code (and maybe the display code). I guess the Microsoft way is to
also use the editor (say Wordpad) as the display program. I'm not real
keen on that, but others might prefer it.
</p>

<p>
If I'd wanted that functionality, I could have used <tt>emacs</tt> in place
of <tt>less</tt>. I think I would have lost a lot if I'd done that.
</p>

<h3>Postscript</h3>

I wrote the above a few days ago. The next day, pricked by some of
the points I made, I modified my help command. I've included it in
Resources below.

<h3>Resources</h3>

<pre class="code">
#	.lesskey - less keybinding file

#  Henry Grebler    26 May 98  Add alternative left-scroll.
#  Henry Grebler    26 May 97  First cut.
#=============================================================================#

# Note on comments:

#     Blank lines and lines which start with a pound sign (#)  are
#     ignored, except for the special section header lines.

#=============================================================================#
# Note on usage:

# This file is the input file to lesskey. Without args, lesskey
# processes $HOME/.lesskey (a text file) to produce $HOME/.less (a
# binary file (which is the init file for less)).

#=============================================================================#

          x         quit
          X         quit
          \e[C        next-file
          \e[D        prev-file
          \eOC        next-file
          \eOD        prev-file

# By default, \e[ is left-scroll. However, the inclusion of \e[C above
# seems to have disabled \e[ (sort of understandable). So I add \e{ as
# a synonym for left-scroll (and add \e} as a synonym for right-scroll
# as an afterthought for consistency).

#          \e{         left-scroll
#          \e}         right-scroll
</pre>

<p>
My latest help command:

<pre class="code">
function help {
# Assume no arg means standard help

        if [ "$1" = "" ]
        then
                builtin help
                return
        fi
        echo 'For bash help, use builtin help'

# avoid backup files:
        files=`ls ~/help*/help_*${1}* 2>/dev/null | grep -v "~$"`
        if [ "$files" = '' ]
        then                    # no matches: try for bash help
                builtin help $1
                return
        fi
        echo "$files"
        echo 'ls ~/help*/help_*'${1}'* | grep -v "~$"'
        less $files
}
</pre>
</p>

<br clear="all" />

<script type='text/javascript'>
digg_url = 'http://linuxgazette.net/174/grebler.html';
digg_title = 'Henry\'s Techno-Musings: My Help System';
digg_bodytext = '<p> If a doctor or an electrician came to your house empty-handed, you\'d be a bit bemused, right? (I suppose, these days, if a doctor came to your house, you\'d be astonished! But let\'s not get side-tracked.) You expect the professional and the tradesman to come with tools. How else is she going to do her job? </p> ';
digg_topic = 'linux_unix';
</script>
<script src="http://digg.com/tools/diggthis.js" type="text/javascript"></script>


<p class="talkback">
Talkback: <a
href="mailto:tag@lists.linuxgazette.net?subject=Talkback:174/grebler.html">Discuss this article with The Answer Gang</a>
</p>

<!-- *** BEGIN author bio *** -->
<hr>
<p>
<img align="left" alt="[BIO]" src="../gx/authors/grebler.jpg" class="bio">
</p>

<em>
<p>
Henry has spent his days working with computers, mostly for computer
 manufacturers or software developers. His early computer experience
 includes relics such as punch cards, paper tape and mag tape. It is
 his darkest secret that he has been paid to do the sorts of things he
 would have paid money to be allowed to do. Just don't tell any of his
 employers. 
</p>

<p>
He has used Linux as his personal home desktop since the family got its
 first PC in 1996. Back then, when the family shared the one PC, it was a
 dual-boot Windows/Slackware setup. Now that each member has his/her own
 computer, Henry somehow survives in a purely Linux world.
</p>

<p>
He lives in a suburb of Melbourne, Australia.
</p>



</em>

<br clear="all">


<!-- *** END author bio *** -->

<div id="articlefooter">

<p>
Copyright &copy; 2010, Henry Grebler. Released under the <a
href="http://linuxgazette.net/copying.html">Open Publication License</a>
unless otherwise noted in the body of the article. Linux Gazette is not
produced, sponsored, or endorsed by its prior host, SSC, Inc.
</p>

<p>
Published in Issue 174 of Linux Gazette, May 2010
</p>

</div>

<div id="previousnextbottom">
<A HREF="dyckoff.html" >&lt;-- prev</A> | <A HREF="grebler1.html" >next --&gt;</A>
</div>

</div>
</div>

<script src="http://www.google-analytics.com/urchin.js"
type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1204316-1";
urchinTracker();
</script>







<img src="../gx/tux_86x95_indexed.png" id="tux" alt="Tux"/>

</body>
</html>

