<!--startcut ======================================================= -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<META NAME="generator" CONTENT="lgazmail v1.2M.j">
<TITLE>The Answer Guy 44: Linux gazette article, July 1999</TITLE>
</HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"
	LINK="#3366FF" VLINK="#A000A0">
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<H4>"The Linux Gazette...<I>making Linux just a little more fun!</I>"</H4>
<P> <hr> <P>
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<center>
<H1><A NAME="answer">
	<img src="../../gx/dennis/qbubble.gif" alt="(?)" 
		border="0" align="middle">
	<font color="#B03060">The Answer Guy</font>
	<img src="../../gx/dennis/bbubble.gif" alt="(!)" 
		border="0" align="middle">
</A></H1> 
<BR>
<H4>By James T. Dennis,
	<a href="mailto:tag@lists.linuxgazette.net">tag@lists.linuxgazette.net</a><BR>
	LinuxCare,
	<A HREF="http://www.linuxcare.com/">http://www.linuxcare.com/</A> 
</H4>
</center>

<p><hr><p>
<!--  endcut ======================================================= -->
<!-- begin 32 -->
<H3 align="left"><img src="../../gx/dennis/qbubble.gif" 
	height="50" width="60" alt="(?) " border="0"
	>Linux gazette article, July 1999</H3>


<p><strong>From Chris Mikkelson  on Mon, 19 Jul 1999  
</strong></p>
<P><STRONG>
In your "answer guy" column, you made the following off-the-cuff comment:
</STRONG></P>
<P><STRONG><FONT COLOR="#000066"><EM><BlockQuote>
It would be sheer idiocy for Linux to adopt a straight polling strategy
for it's networking interfaces. However, it might be possible to have
a hybrid. If the interrupt frequency on a given device exceeds one
threshold the kernel might then switch to polling on that device.
When the polling shows that the activity on that device as dropped
back below another threshold it might be able to switch back to
interrupt-driven mode.
</BlockQuote></EM></FONT></STRONG></P>
<P><STRONG>
Well, this reminded me instantly of a research paper I had recently read,
called "Eliminating Receive Livelock in an Interrupt-driven Kernel."
It is available online at
</STRONG></P>
<P><STRONG>
<A HREF="http://www.research.digital.com/wrl/techreports/abstracts/95.8.html"
	>http://www.research.digital.com/wrl/techreports/abstracts/95.8.html</A>
</STRONG></P>
<P><STRONG>
The problem with interrupt-driven processing is that the high
overhead (and priority) of servicing an interrupt can starve the
machine under high load.  That is, not only does latency increase,
but throughput can drop to practically zero under high load (this
will be particularly evident on a gigabit-range network, 100baseT
maybe, 10baseT -- a 486 can keep up with that 
<IMG SRC="../../gx/dennis/smily.gif" ALT=";-)" 
		height="24" width="20" align="middle">
</STRONG></P>
<P><STRONG>
The solution implemented for the paper was as follows -- when receiving
a network interrupt, start a polling task and disable that interrupt.
When the polling task doesn't find significant new traffic for some number
of cycles, stop the polling task and re-enable interrupts.
</STRONG></P>
<P><STRONG>
The platform this was implemented on was BSD (but I don't know if it
made it into *BSD), but it could just as easily be done on Linux.  It
is also a rather simple and elegant solution, and drastically improved
the behavior of the system under high loads.
</STRONG></P>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
It sounds similar to what I suggested, except that
it sounds like you routinely disable the interrupt and
switch to polling mode whereas I'd suggested that you'd
only do it based on certain thresholds of activity.
</BLOCKQUOTE>
<BLOCKQUOTE>
In any event, you'd be welcome to submit a patch to
the Linux kernel team.
</BLOCKQUOTE>
<BLOCKQUOTE>
Look in the CREDITS file for a list of e-mail addresses of
major kernel developers.  It's recommended that patches be
initially sent to one of them (other than Linus) so that
they can review it and marshall it towards the main kernel.
Sending things directly to Linus might work, or it might get
lost in the flood.  It's not recommended.  Let the others on
the team see it first.
</BLOCKQUOTE>
<!-- sig -->

<!-- end 32 -->
<!--startcut ======================================================= -->
<P> <hr> <P>
<H5 align="center"><a href="http://www.linuxgazette.net/copying.html"
	>Copyright &copy;</a> 1999, James T. Dennis 
<BR>Published in <I>The Linux Gazette</I> Issue 44 August 1999</H5>
<H6 ALIGN="center">HTML transformation  by
	<A HREF="mailto:star@starshine.org">Heather Stern</a> of
	Starshine Techinical Services,
	<A HREF="http://www.starshine.org/">http://www.starshine.org/</A> 
</H6>
<P> <hr> <P>
<!-- begin tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::-->
<TABLE WIDTH="98%"><TR VALIGN="center" ALIGN="center">
<TD ROWSPAN="2" COLSPAN="3" WIDTH="42%"><A 
	HREF="../lg_answer44.html"
	><IMG SRC="../../gx/dennis/answernew.gif"
              ALT="[ Answer Guy Index ]"></A></td>
  <TD WIDTH="14%"><A HREF="1.html">1</A></TD>
  <TD WIDTH="14%"><A HREF="4.html">4</A></TD>
  <TD WIDTH="14%"><A HREF="7.html">7</A></TD>
  <TD WIDTH="14%"><A HREF="9.html">9</A></TD>
</TR><TR VALIGN="center" ALIGN="center">
  <TD WIDTH="14%"><A HREF="11.html">11</A></TD>
  <TD WIDTH="14%"><A HREF="12.html">12</A></TD>
  <TD WIDTH="14%"><A HREF="14.html">14</A></TD>
  <TD WIDTH="14%"><A HREF="17.html">17</A></TD>
</TR><TR VALIGN="center" ALIGN="center">
  <TD><A HREF="18.html">18</A></TD>
  <TD><A HREF="19.html">19</A></TD>
  <TD><A HREF="20.html">20</A></TD>
  <TD><A HREF="21.html">21</A></TD>
  <TD><A HREF="24.html">24</A></TD>
  <TD><A HREF="25.html">25</A></TD>
  <TD><A HREF="26.html">26</A></TD>
</TR><TR VALIGN="center" ALIGN="center">
  <TD><A HREF="28.html">28</A></TD>
  <TD><A HREF="29.html">29</A></TD>
  <TD><A HREF="30.html">30</A></TD>
  <TD><A HREF="31.html">31</A></TD>
  <TD><A HREF="32.html">32</A></TD>
  <TD><A HREF="33.html">33</A></TD>
  <TD><A HREF="34.html">34</A></TD>
</TR><TR VALIGN="center" ALIGN="center">
  <TD><A HREF="35.html">35</A></TD>
  <TD><A HREF="36.html">36</A></TD>
  <TD><A HREF="37.html">37</A></TD>
  <TD><A HREF="38.html">38</A></TD>
  <TD><A HREF="39.html">39</A></TD>
  <TD><A HREF="40.html">40</A></TD>
  <TD><A HREF="41.html">41</A></TD>
</TR><TR VALIGN="center" ALIGN="center">
  <TD><A HREF="42.html">42</A></TD>
  <TD><A HREF="43.html">43</A></TD>
  <TD><A HREF="44.html">44</A></TD>
  <TD><A HREF="45.html">45</A></TD>
  <TD><A HREF="46.html">46</A></TD>
  <TD><A HREF="47.html">47</A></TD>
  <TD><A HREF="48.html">48</A></TD>
</TR></TABLE>
<!-- end tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::::-->
<P> <hr> <P>
<!-- begin lgnav ::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<A HREF="../index.html"
	><IMG SRC="../../gx/indexnew.gif" ALT="[ Table Of Contents ]"></A>
<A HREF="/index.html"
	><IMG SRC="../../gx/homenew.gif" ALT="[ Front Page ]"></A>
<A HREF="../lg_bytes44.html"
	><IMG SRC="../../gx/back2.gif" ALT="[ Previous Section ]"></A>
<A HREF="../lg_tips44.html"
	><IMG SRC="../../gx/fwd.gif" ALT="[ Next Section ]"></A>
<!-- end lgnav ::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
</BODY></HTML>
<!--endcut ========================================================= -->
