<!--startcut ======================================================= -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<META NAME="generator" CONTENT="lgazmail v1.3E.w">
<TITLE>The Answer Gang 68: Dash it All!  Coping with ---Unruly--- Filenames</TITLE>
</HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"
	LINK="#3366FF" VLINK="#A000A0">
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<P> <hr> 
<CENTER>
<!-- *** BEGIN navbar *** -->
<!-- *** END navbar *** -->
</CENTER>
</p>
<P> <hr> <P>
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<!-- begin tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::-->
<p align="center">
<table width="100%" border="0"><tr>
<td align="right" valign="center"
        ><IMG ALT="" SRC="../../gx/navbar/left.jpg"
        WIDTH="14" HEIGHT="45" BORDER="0" ALIGN="middle" border="0"
><A HREF="..//"
        ><IMG SRC="../../gx/navbar/toc.jpg" align="middle"
              ALT="[ Table Of Contents ]" border="0"></A
><A HREF="../lg_answer68.html"
        ><IMG SRC="../../gx/dennis/answertoc.jpg" align="middle"
              ALT="[ Answer Guy Current Index ]" border="0"></A></td>
<td align="center" valign="center"><A HREF="../lg_answer68.html#greeting"><img align="middle"
        src="../../gx/dennis/smily.gif" alt="greetings" border="0"></A> &nbsp;
  <A HREF="bios.html">bios</A> &nbsp;
  <A HREF="1.html">1</A> &nbsp;
  <A HREF="2.html">2</A> &nbsp;
  <A HREF="3.html">3</A> &nbsp;
  <A HREF="4.html">4</A> &nbsp;
  <A HREF="5.html">5</A> &nbsp;
  <A HREF="6.html">6</A> &nbsp;
  <A HREF="7.html">7</A> &nbsp;
  <A HREF="8.html">8</A> &nbsp;
  <A HREF="9.html">9</A> &nbsp;
  <A HREF="10.html">10</A> &nbsp;
  <A HREF="11.html">11</A> &nbsp;
  <A HREF="12.html">12</A> 
  </td>
<td align="left" valign="center"><A HREF="../../tag/kb.html"
        ><IMG SRC="../../gx/dennis/answerpast.jpg" align="middle"
              ALT="[ Index of Past Answers ]" border="0"></A
><IMG ALT="" SRC="../../gx/navbar/right.jpg" align="middle"
        WIDTH="14" HEIGHT="45" BORDER="0"></td></tr></table>
</p>
<!-- end tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::::-->
<center>
<H1><A NAME="answer">
	<img src="../../gx/dennis/qbubble.gif" alt="(?)" 
		border="0" align="middle">
	<font color="#B03060">The Answer Gang</font>
	<img src="../../gx/dennis/bbubble.gif" alt="(!)" 
		border="0" align="middle">
</A></H1> 
<BR>
<H4>By Jim Dennis, Ben Okopnik, Dan Wilder, Breen, Chris, and the Gang,
	the Editors of Linux Gazette... 
	and You!
<br>Send questions (or interesting answers) to
	<a href="mailto:tag@lists.linuxgazette.net">tag@lists.linuxgazette.net</a>
</H4>
<p><em><font color="#990000">There is no guarantee that your questions
	here will <b>ever</b> be answered.  Readers at confidential sites
	must provide permission to publish.  However, you can be published 
	anonymously - just let us know!
</font></em></p>
</center>

<p><hr><p>
<!--  endcut ======================================================= -->
<!-- begin 7 -->
<H3 align="left"><img src="../../gx/dennis/qbubble.gif" 
	height="50" width="60" alt="(?) " border="0"
	>Dash it All!  Coping with ---Unruly--- Filenames</H3>


<p><strong>From John Murray 
</strong></p> 
<p align="right"><strong>Answered By Jim Dennis, Andrew Higgs, Ben Okopnik
<br></strong></p>

<P><STRONG>
I was experimenting with the TAR command and trying to get it to "exclude"
some files.  I finally got it to work but in one of my tests I ended up
sending the output of the TAR command to a file called -exclude.  I want to
delete -exclude, but when I type in the command to delete it "rm -f
-exclude", the command thinks the file name is an option. The same thing
happens when I try to rename the file.  Any ideas??
</STRONG></P>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
This is a classic UNIX FAQ.  I pose variations of it to prospective
sysadmins and support personnel when I interview them.
</BLOCKQUOTE>

<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Andrew]
Hi John
</BLOCKQUOTE>
<BLOCKQUOTE><BLOCKQUOTE><CODE>
Try  'rm -f -- -exclude'. The '--' terminates the options list.
</CODE></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
Kind regards
</BLOCKQUOTE>

<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
<TT>./</TT> is more portable (works with <EM>all</EM> UNIX commands on <EM>all</EM> versions
of UNIX) and is even shorter (saves one space).
</BLOCKQUOTE>

<BLOCKQUOTE>
The current directory in UNIX (and Linux, of course) is always
the "dot" directory.  When we use a filename with <EM>no</EM> slashes
(directory/subdirectory delimiters) in it; that's merely a shorthand
for "the one in the current directory."  So any file foo is also
./foo.
</BLOCKQUOTE>
<BLOCKQUOTE>
More importantly -foo is the same as <TT>./-foo</TT>  (Of course it's also
the same as $(pwd)/-foo --- the full path to the filename).
</BLOCKQUOTE>
<BLOCKQUOTE>
NOTE: I give half credit for people who suggest " -- " (a double dash
argument to the rm or some other commands; signifying the end of all
options processing by that command and thus forcing all following
arguments to be taking literally rather than as possible option switches).
</BLOCKQUOTE>

<BlockQuote>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben]
&lt;laugh&gt; How about for using Midnight Commander? Scroll down to the
filename, hit 'F8'. Gone.
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
Half credit.  What if mc isn't on this box?  How about
mc's "undelete" feature?  Is that file <EM>really</EM> gone?
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben]
Erm... the "undelete" feature is a facet of the ext2 file system;
nothing to do with MC itself, which just provides an interface to it.
&lt;grin&gt; You'd get a _debit_ for that one.
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
I'll take the hit --- but I'll stick by my guns on the opinion that
"rm is forever" (even though I've recovered deleted files using
grep, dd and vi).  I've read about mc's undelfs before, but I've
never used it and I didn't remember the details.
</BLOCKQUOTE>

<blockquote>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben]
"undelfs", despite the confusing name, is no more a filesystem than is
their "tarfs": 'foo'fs, in MC parlance, is simply a way of looking at
'foo', where 'foo' is presented as a filesystem - sort of like what
the 'mount' command does with a DOS floppy. In the case of "tarfs",
it allows you to look at tar files as if they were directories and
subdirectories containing files; with "undelfs", it allows you to look
at the deleted-but-not-yet-reused filespace in ext2 as if it was a
directory. Pretty neat gadget that greatly facilitates the undeletion
process; however, the initial read (it would have to scan the entire
partition, obviously) takes a while. MC, despite its ease of use, goes
<EM>very</EM> deep; you can actually edit the various 'fs' files, and even
create your own!
</BLOCKQUOTE>
</blockquote>

<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
I'll give 3/4 credit for anyone who says: "I just use
(x)emacs dired-mode for all my file management, so I'd
just C-s (search) to move point to it, and hit the 'd'
key."
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben]
Hey! What if emacs isn't on the box? In my opinion, that's a higher
probability than with MC.
</BLOCKQUOTE>

<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
I'll even give 90% credit for someone who says: "I
forgot all my shell tricks since I do everything in
perl.  So I'd just use:  perl -e 'unlink("-foo");' and
be done with it"
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben]
&lt;laugh&gt; That's what I used the last time I had to rename a bunch of MP3s
(KOI8-R (Russian) song names on my 'LANG=C' system). Even MC had a
problem; Perl chewed it right up. Except in my case, the above would be
</BLOCKQUOTE>
<BLOCKQUOTE><BLOCKQUOTE><CODE>
perl -we'unlink -foo'
</CODE></BLOCKQUOTE></BLOCKQUOTE>
<BLOCKQUOTE>
It's not a list and there's no precedence issue (no parens), and there's
no interpretation necessary (no double-quotes). Also, enable warnings to
tell you if something weird happens.
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
I give extra credit for those who recognize it as an FAQ
and laugh at me for posing the question.
</BLOCKQUOTE>
<BLOCKQUOTE>
I'll give double credit to anyone that recites the FAQ,
and ticks off six different ways to do it (--, <TT>./</TT>, mc, perl,
dired, and one I've never heard of) and tells me that he saw
the whole thread on TAG!
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben]
Edit the inode directly - hexedit, MC, etc.
Use C's "int unlink (const char *FILENAME)".
Tell an assembler programmer that you've found something that can't be
done in it. &lt;evil grin&gt;
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
That would be using fsdb or debugfs and use clri and unlink
commands therein.
</BLOCKQUOTE>

<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben]
(and, from the "incidental feature" side of the fence...)
</BLOCKQUOTE>
<BLOCKQUOTE>
Use a large electromagnet.
Take a hammer to the hard drive.
Take off and nuke the site from orbit (it's the only way to be sure.)
</BLOCKQUOTE>
<BLOCKQUOTE>
And, as the bonus option, go to Jim Dennis and say, "Jim, I have this
beautiful barometer I'll give you if you..." Oh, oops. Wrong story. 
<IMG SRC="../../gx/dennis/smily.gif" ALT=":)" 
		height="24" width="20" align="middle">
</BLOCKQUOTE>
<BLOCKQUOTE>
...Oh. You said "_one_ [way] I've never heard of"? 
<IMG SRC="../../gx/dennis/smily.gif" ALT=":)" 
		height="24" width="20" align="middle">
</BLOCKQUOTE>

<BLOCKQUOTE><IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	>
Now, don't you wish I was a hiring manager at someplace
you wanted to work?
</BLOCKQUOTE>
<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben]
If I wanted to be a sysadmin (which I don't), definitely. Knowing that
the people around me are vetted by someone knowledgeable instead of
some HR bozo with a checklist &lt;barely managing to supress Major Rant
with a sack&gt; would be a Good Thing!
</BLOCKQUOTE>
</BlockQuote>

<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
I give zilch credit for any efforts to use quotes, backslashes, or
other shell "escaping" techniques.
</BLOCKQUOTE>
<BLOCKQUOTE>
The leading dash is conventionally used by UNIX commands (and specified
in the POSIX standards for many of them) as a way to distinguish
"object" arguments (things the command will work on) from "options"
(or adverbial) arguments (also known as "switches") (which specify
<EM>how</EM> the command will work).  Note that this is a convention; and that
it applies to commands.  The shell (command interpreter) does no
special parsing of leading dashes.  Quoting and escapingn only affect
how the shell parses the command line (how it is passed to the commands)
--- so no amount of shell shenanigans will ever overcome a "dashed"
filename problem.
</BLOCKQUOTE>
<BLOCKQUOTE>
(BTW: That's the easiest question on my list of "qualifiers" for
sysadmins.  No offense intended, but I need people to know the
FAQs before I can let them loose with a root prompt on my production
systems)
</BLOCKQUOTE>

<blockquote>

<BLOCKQUOTE>
Here's a slightly tougher one: "due to some merger we need to
migrate a set of users to a block of (formerly unused) UIDs;
why and how?  Also what are some 'gotchyas' in this process?"
(Preferred answer to "how" is in the form of shell script
pseudocode; feel free to gloss over details with comments on
how you'd safely figure out implementation specifics).
</BLOCKQUOTE>
<BLOCKQUOTE>
That's a medium level qualifier.
</BLOCKQUOTE>
<BLOCKQUOTE>
BTW changing chowning all of the files belonging to just <EM>one</EM>
user is a one-liner;  However, it's not as simple as you'd think.
Try that for 3/4 credit.
</BLOCKQUOTE>
<BLOCKQUOTE>
Answer next month; if you remind me!  (My rough cut at this
is just over 20 lines long).
</BLOCKQUOTE>

</blockquote>

<BLOCKQUOTE><IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [JimD]
The UNIX FAQ is at:
</BLOCKQUOTE>
<BLOCKQUOTE><BLOCKQuote>
<A HREF="http://www.faqs.org/faqs/unix-faq/faq/contents"
	>http://www.faqs.org/faqs/unix-faq/faq/contents</A>
</BLOCKQuote></BLOCKQUOTE>
<BLOCKQUOTE>
... and this is question 2.1
</BLOCKQUOTE>
<BLOCKQUOTE>
Read that before you su again!
</BLOCKQUOTE>

<!-- end 7 -->
<!--startcut ======================================================= -->
<P> <hr> </p>
<!-- *** BEGIN copyright *** -->
<H5 align="center">This page edited and maintained by the Editors
        of <I>Linux Gazette</I>
<a href="http://www.linuxgazette.net/copying.html"
        >Copyright &copy;</a> 2001
<BR>Published in issue 68 of <I>Linux Gazette</I> July 2001</H5>
<H6 ALIGN="center">HTML script maintained by
        <A HREF="mailto:star@starshine.org">Heather Stern</a> of
        Starshine Technical Services,
        <A HREF="http://www.starshine.org/">http://www.starshine.org/</A>
</H6>
<!-- *** END copyright *** -->
<P> <hr> 
<P> <hr> 
<CENTER>
<!-- *** BEGIN navbar *** -->
<!-- *** END navbar *** -->
</CENTER>
</p>
<!-- begin tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::-->
<p align="center">
<table width="100%" border="0"><tr>
<td align="right" valign="center"
        ><IMG ALT="" SRC="../../gx/navbar/left.jpg"
        WIDTH="14" HEIGHT="45" BORDER="0" ALIGN="middle" border="0"
><A HREF="..//"
        ><IMG SRC="../../gx/navbar/toc.jpg" align="middle"
              ALT="[ Table Of Contents ]" border="0"></A
><A HREF="../lg_answer68.html"
        ><IMG SRC="../../gx/dennis/answertoc.jpg" align="middle"
              ALT="[ Answer Guy Current Index ]" border="0"></A></td>
<td align="center" valign="center"><A HREF="../lg_answer68.html#greeting"><img align="middle"
        src="../../gx/dennis/smily.gif" alt="greetings" border="0"></A> &nbsp;
  <A HREF="bios.html">bios</A> &nbsp;
  <A HREF="1.html">1</A> &nbsp;
  <A HREF="2.html">2</A> &nbsp;
  <A HREF="3.html">3</A> &nbsp;
  <A HREF="4.html">4</A> &nbsp;
  <A HREF="5.html">5</A> &nbsp;
  <A HREF="6.html">6</A> &nbsp;
  <A HREF="7.html">7</A> &nbsp;
  <A HREF="8.html">8</A> &nbsp;
  <A HREF="9.html">9</A> &nbsp;
  <A HREF="10.html">10</A> &nbsp;
  <A HREF="11.html">11</A> &nbsp;
  <A HREF="12.html">12</A> 
  </td>
<td align="left" valign="center"><A HREF="../../tag/kb.html"
        ><IMG SRC="../../gx/dennis/answerpast.jpg" align="middle"
              ALT="[ Index of Past Answers ]" border="0"></A
><IMG ALT="" SRC="../../gx/navbar/right.jpg" align="middle"
        WIDTH="14" HEIGHT="45" BORDER="0"></td></tr></table>
</p>
<!-- end tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::::-->
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
</BODY></HTML>
<!--endcut ========================================================= -->
