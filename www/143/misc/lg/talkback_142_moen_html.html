<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
<title>Talkback:142/moen.html</title>
<link rel="stylesheet" type="text/css" href="../../../lg.css" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
</head>
<body>
<a href="../../../"><img alt="Linux Gazette" src="../../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" /></a><img alt="Tux" src="../../../gx/tux_86x95_indexed.png" id="tux" /><p id="fun">...making Linux just a little more fun!</p><div class='content articlecontent'><a name="top"></a><h3>Talkback:142/moen.html</h3>
<p><b>[ In reference to "<a href='../../../142/moen.html'>Preventing Domain Expiration</a>" in LG#142 ]</b></p><p>
<b><p>
s. keeling [keeling at nucleus.com]
</p>
</b><br />
<b>Sun, 2 Sep 2007 17:17:42 -0600</b>
</p>

<p>
Entertaining and informative article, Rick, as always.  I hope I can
consider some of my recent floundering with whois and
linuxmafia.{com,net} as partial inspiration.
</p>

<p>
However, getting down to the picture at the .sig block, shouldn't you
be doing more long distance bicycling?  I always pictured you as one
of those ca. 150 lb., wiry joggers gorging yourself on tofu.  Instead,
the picture shows you're either a sumo wrestler, a linebacker (a geek
linebacker?!?), or you need to avoid burger joints more often.  Oh,
and that perl book behind you is pink.  Doesn't that need an upgrade?
</p>

<p>
My perl books are pink too, and they suit me just fine (damnit).  Sorry
for the crack about the picture.  I'd just prefer that folks like you
outlive me (I'm a selfish that way).
</p>


<p>
P.S. Ben, looks like we need to fiddle with pinehelper.pl again.  It's
     ignoring the bit in parens in the subject line, making "Subject:
     Talkback".  Crap.
</p>

<p>
     My version of your pinehelper.pl attached.  This is pinehelper.pl
     called by FF 2.0.0.4 (Debian stable/Etch Iceweasel), fwiw.
</p>

<p>
     I've also just installed flashplayer-mozilla, which appears to
     handle swf better than swf-player, so maybe I can actually read
     the cartoons this time.  <img src="../gx/smile.png" alt=":-)">
</p>

<p>
<a href="../../../143/misc/lg/pinehelper">http://linuxgazette.net/143/misc/lg/pinehelper</a>
</p>

<pre>-- 
Any technology distinguishable from magic is insufficiently advanced.
(*)
- -
</pre>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Rick Moen [rick at linuxmafia.com]
</p>
</b><br />
<b>Sun, 2 Sep 2007 16:54:49 -0700</b>
</p>

<p>
Quoting s. keeling (keeling@nucleus.com):
</p>


<pre>
&gt; Entertaining and informative article, Rick, as always.  I hope I can
&gt; consider some of my recent floundering with whois and
&gt; linuxmafia.{com,net} as partial inspiration.
</pre>

<p>
You're more than welcome.  The immediate inspiration, though, was a
fan-run science fiction convention of my acquaintance losing (and then
having to ransom back) its Internet domain.
</p>


<pre>
&gt; However, getting down to the picture at the .sig block, shouldn't you
&gt; be doing more long distance bicycling?
</pre>

<p>
Oddly enough, I am indeed intending to climb up over the Santa Cruz
Mountains tomorrow, for Labor Day -- maybe over to Big Basin State Park.
In any event:
</p>


<pre>
&gt; I always pictured you as one of those ca. 150 lb., wiry joggers
&gt; gorging yourself on tofu.  Instead, the picture shows you're either a
&gt; sumo wrestler, a linebacker (a geek linebacker?!?), or you need to
&gt; avoid burger joints more often.
</pre>

<p>
It's not a really flattering photo, and doesn't reveal that I'm just shy
of 6' with a 34"-36" waist (fluctuates), weighing probably -- oh -- 200 lb.
(I haven't actually weighed myself since the days when jokes about
Generalissimo Francisco Franco were still considered funny.)  I'm no
longer wiry, and have never been guilty of jogging (cross-country
running was always more the ticket), but am at least still considered an
ectomorph and blessed with absurdly excellent health.  But thanks for
caring.
</p>

<p>
Perhaps I should also GIMP up the logo on that t-shirt a bit, because
some people report reading it as "BayUSA", whereas it's actually
"BayLISA", the local sysadmin group.
</p>


<pre>
&gt; Oh, and that perl book behind you is pink.  Doesn't that need an upgrade?
</pre>

<p>
It does -- but I'm also notoriously cheap, and so borrow Deirdre's copy.  ;-&gt;
</p>


<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Rick Moen [rick at linuxmafia.com]
</p>
</b><br />
<b>Mon, 3 Sep 2007 00:46:00 -0700</b>
</p>

<p>
I wrote:
</p>

<pre>
&gt; Quoting s. keeling (keeling@nucleus.com):
</pre>


<pre>
&gt; &gt; Entertaining and informative article, Rick, as always.  I hope I can
&gt; &gt; consider some of my recent floundering with whois and
&gt; &gt; linuxmafia.{com,net} as partial inspiration.
&gt; 
&gt; You're more than welcome.  The immediate inspiration, though, was a
&gt; fan-run science fiction convention of my acquaintance losing (and then
&gt; having to ransom back) its Internet domain.
</pre>

<p>
Actually, I just remembered your e-mail query from last June, when you
were having some odd problems getting useful WHOIS data regarding my
linuxmafia.com domain -- which turned out to be that you were querying the
WHOIS server at ARIN, which is actually the official Internet registry
in/around North America for <em>numbers</em> (such as IP addresses) rather than
<em>names</em>.
</p>

<p>
I was a little groggy when you'd asked that earlier query, because I'd
just gotten off a flight back from Turkey via a short stop in London.  
(What was really bizarre was taking the London Underground train from
Heathrow Airport into central London, so I could walk over to my old
stomping grounds in Southwark, walk up the stairs into Picadilly Circus
-- and immediately have my mobile ring:  "Hello, this is Mike.  Is the
Linux user group meeting today?" "Um, possibly, but I'm a third of the
way around the planet right now.  Might I call back?")
</p>

<p>
Anyhow, <em>yes</em>, as it turned out, your WHOIS question about
linuxmafia.com was indeed a motivator for that article, because it made
me curious about how /usr/bin/whois knows which WHOIS server to query
for particular data, and why it sometimes goes very badly wrong.
</p>


<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]
</p>
</b><br />
<b>Sun, 2 Sep 2007 23:53:56 -0400</b>
</p>

<p>
On Sun, Sep 02, 2007 at 05:17:42PM -0600, s. keeling wrote:
</p>

<pre>
&gt; 
&gt; P.S. Ben, looks like we need to fiddle with pinehelper.pl again.  It's
&gt;      ignoring the bit in parens in the subject line, making "Subject:
&gt;      Talkback".  Crap.
</pre>

<p>
Ah, my sins come back to haunt me. I <em>knew</em> I shouldn't have been
splitting on that colon; the damn things can occur in the text, too.
Also - if you modify my scripts without having a sufficient level of
Perl-Fu, things <em>will</em> break. Anyway... for anyone tuning in late: this
relates back to the discussion that we had on using Mutt as a mail
client for Firefox. The process goes something like this:
</p>

<pre>
1) Save the following script somewhere reasonable, e.g.
	'/usr/local/bin/mutthelper'.
2) Type 'about:config' in the Firefox URL bar.
3) Either set or create the entry for 'network.protocol-handler.app.mailto'
	with a value of '/usr/local/bin/mutthelper' (or wherever you save it.)
</pre>
<pre class="code">
#!/usr/bin/perl -w
# Created by Ben Okopnik on Sun Nov 13 17:24:14 EST 2005
 
($str = shift) =~ s/^(mailto):/$1=/;
 
for (split /[?&amp;]/, $str){
		( $k, $v ) = split /=/;
		# Low-rent entity conversion
		( $header{ $k } = $v ) =~ s/%(..)/pack("H2",$1)/eg;
}
 
# Define appropriate switches for a given mail client (e.g., 'mutt')
$opts = qq[ -s "$header{subject}" ] if exists $header{subject};
$opts .= $header{mailto};
 
exec "/usr/bin/xterm -T Mutt -e /usr/bin/mutt $opts";
</pre>
May it serve you well all the days of your life. <img src="../gx/smile.png" alt=":)">
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href="http://LinuxGazette.NET">http://LinuxGazette.NET</a> *
</pre>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
s. keeling [keeling at nucleus.com]
</p>
</b><br />
<b>Mon, 3 Sep 2007 07:52:09 -0600</b>
</p>

<p>
Incoming from Ben Okopnik:
</p>

<pre>
&gt; On Sun, Sep 02, 2007 at 05:17:42PM -0600, s. keeling wrote:
&gt; &gt; 
&gt; &gt; P.S. Ben, looks like we need to fiddle with pinehelper.pl again.  It's
&gt; &gt;      ignoring the bit in parens in the subject line, making "Subject:
&gt; &gt;      Talkback".  Crap.
&gt; 
&gt; Ah, my sins come back to haunt me. I <em>knew</em> I shouldn't have been
&gt; splitting on that colon; the damn things can occur in the text, too.
&gt; Also - if you modify my scripts without having a sufficient level of
&gt; Perl-Fu, things <em>will</em> break. Anyway... for anyone tuning in late: this
</pre>

<p>
Well, one person's "sufficient level of Perl-fu" is another person's
"why the heck did they do it that way?!?"  For instance, at the
moment, I'm rebuilding a client's grotty old Korn shell script, and
the other day I found this in it:
<pre>
     grep "^.*$foo.*"  ...
</pre>
Anchored at the beginning of the line, followed by any number of any
characters, test for the existence of $foo, followed by any number of
any characters.  Well, why not just grep for $foo?  Is this actually doing
something magical which for some reason I can't see it, or is it just
silly?
</p>

<p>
Sometimes, it's hard to tell.  That got past at least three very
capable big iron *nix guys before I tripped over it.
</p>

<p>
Thanks for your help bringing pinehelper/mutthelper back.
</p>


<pre>-- 
Any technology distinguishable from magic is insufficiently advanced.
(*)
- -
</pre>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]
</p>
</b><br />
<b>Mon, 3 Sep 2007 13:20:57 -0400</b>
</p>

<p>
On Mon, Sep 03, 2007 at 07:52:09AM -0600, s. keeling wrote:
</p>

<pre>
&gt; Incoming from Ben Okopnik:
&gt; &gt; On Sun, Sep 02, 2007 at 05:17:42PM -0600, s. keeling wrote:
&gt; &gt; &gt; 
&gt; &gt; &gt; P.S. Ben, looks like we need to fiddle with pinehelper.pl again.  It's
&gt; &gt; &gt;      ignoring the bit in parens in the subject line, making "Subject:
&gt; &gt; &gt;      Talkback".  Crap.
&gt; &gt; 
&gt; &gt; Ah, my sins come back to haunt me. I <em>knew</em> I shouldn't have been
&gt; &gt; splitting on that colon; the damn things can occur in the text, too.
&gt; &gt; Also - if you modify my scripts without having a sufficient level of
&gt; &gt; Perl-Fu, things <em>will</em> break. Anyway... for anyone tuning in late: this
&gt; 
&gt; Well, one person's "sufficient level of Perl-fu" is another person's
&gt; "why the heck did they do it that way?!?"  
</pre>

<p>
Only when you're <em>critiquing</em> someone else's script - not when you're
actually changing it. In the latter case, you really do need to
understand what they did - and all the peripheral results of it - or
rewrite that entire script, since you don't know what else may be
affected.
</p>

<p>
<pre class="code">
perl -le'sub x{local $"="+"; print eval "@_"}; split //, 1234; &amp;x'
10
</pre>
"Oh, look at that idiot: he's using '&amp;' in front of the subroutine call.
Doesn't he know that's long deprecated?"
</p>

<p>
<pre class="code">
perl -le'sub x{local $"="+"; print eval "@_"}; split //, 123; x()'
 
</pre>
"Hey, what happened to the output???"
</p>


<pre>
&gt; For instance, at the
&gt; moment, I'm rebuilding a client's grotty old Korn shell script, and
&gt; the other day I found this in it:
&gt; 
&gt;      grep "^.*$foo.*"  ...
&gt; 
&gt; Anchored at the beginning of the line, followed by any number of any
&gt; characters, test for the existence of $foo, followed by any number of
&gt; any characters.  Well, why not just grep for $foo?  Is this actually doing
&gt; something magical which for some reason I can't see it, or is it just
&gt; silly?
</pre>

<p>
Neither - it's like dead yeast in beer. No benefit, but no particular
negative effect, either. If it was "^.+$foo.+", that would be a
completely different deal - but '.*'s are essentially meaningless in
this case.
 
</p>

<pre>
&gt; Sometimes, it's hard to tell.  That got past at least three very
&gt; capable big iron *nix guys before I tripped over it.
</pre>

<p>
I could see just leaving it alone, myself. I can't see any scenario in
which it would do harm.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href="http://LinuxGazette.NET">http://LinuxGazette.NET</a> *
</pre>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Neil Youngman [ny at youngman.org.uk]
</p>
</b><br />
<b>Mon, 3 Sep 2007 21:34:21 +0100</b>
</p>

<p>
On or around Monday 03 September 2007 18:20, Ben Okopnik reorganised a bunch 
of electrons to form the message:
</p>

<pre>
&gt; On Mon, Sep 03, 2007 at 07:52:09AM -0600, s. keeling wrote:
&gt; &gt; For instance, at the
&gt; &gt; moment, I'm rebuilding a client's grotty old Korn shell script, and
&gt; &gt; the other day I found this in it:
&gt; &gt;
&gt; &gt;      grep "^.*$foo.*"  ...
&gt; &gt;
&gt; &gt; Anchored at the beginning of the line, followed by any number of any
&gt; &gt; characters, test for the existence of $foo, followed by any number of
&gt; &gt; any characters.  Well, why not just grep for $foo?  Is this actually
&gt; &gt; doing something magical which for some reason I can't see it, or is it
&gt; &gt; just silly?
&gt;
&gt; Neither - it's like dead yeast in beer. No benefit, but no particular
&gt; negative effect, either. If it was "^.+$foo.+", that would be a
&gt; completely different deal - but '.*'s are essentially meaningless in
&gt; this case.
</pre>

<p>
Semantically that's true, however ...
</p>


<pre>
&gt; &gt; Sometimes, it's hard to tell.  That got past at least three very
&gt; &gt; capable big iron *nix guys before I tripped over it.
&gt;
&gt; I could see just leaving it alone, myself. I can't see any scenario in
&gt; which it would do harm.
</pre>

<p>
... that's the sort of thing, which could have an impact on performance if run 
often enough on large enough strings. I went to a course on Exim, which 
included a very enlightening seminar on regex performance. This isn't 
particularly bad, but it is inefficient. 
</p>

<p>
I would expect the handling of the above to work on the following lines
</p>

<p>
```
1. Match with ^ at the start of the line, no problem
2. The first .* matches all the way to the end of the line.
repeat
3. $foo doesn't match anything, roll back 1 character and try again
until $foo matches or you can't rollback any further
 
4 If you have a match
   then
     the final .* matches to the end of line
  else
     match failed
''
</p>

<p>
All these rollbacks are unnecessary and can soak up a serious amount of CPU 
with a badly written regex. A little testing (below) shows that it doesn't 
seem to be too bad in this case, but it could be expensive if repeated too 
often.
</p>

<p>
Pcretest shows that the simpler form takes 0.046 milliseconds on a longish, 
non-matching string, vs. 0.133 milliseconds for the version with the 
unnecessary complications. That's a factor of 3 difference in cost for zero 
benefit. More complex regexes could show an even higher cost.
</p>

<pre>
$ pcretest -t
PCRE version 6.7 04-Jul-2006
 
  re&gt; /^.*test string.*/
Compile time 0.003 milliseconds
data&gt; A little over a month ago, Microsoft announced that it would submit one 
or more of its Shared Source licences to OSI for certification. That has 
generated a lot of controversy within the Open Source community, with some 
Open Source supporters welcoming the prospect of Microsoft approaching OSI 
but many others regarding any move by Microsoft with deep suspicion. Eric 
Raymond acknowledges that ongoing debate and allows as how it's been going on 
within OSI, too. However, as he writes, "OSI's official position, from the 
beginning, which I helped formulate and have expressed to any number of 
reporters and analysts, is that OSI will treat any licenses submitted [by] 
Microsoft strictly on their merits, without fear or favor. That remains OSI's 
position. But..." He goes on, "...Microsoft's behavior in the last few months 
with respect to OOXML has been egregious. They haven't stopped at pushing 
a "standard" that is divisive, technically bogus, and an obvious tool of 
monopoly lock-in; they have resorted to lying, ballot-stuffing, 
committee-packing, and outright bribery to ram it through the ISO 
standardization process in ways that violate ISO's own guidelines wholesale."
Execute time 0.133 milliseconds
No match
data&gt; 
  re&gt; /test string/
Compile time 0.002 milliseconds
data&gt; A little over a month ago, Microsoft announced that it would submit one 
or more of its Shared Source licences to OSI for certification. That has 
generated a lot of controversy within the Open Source community, with some 
Open Source supporters welcoming the prospect of Microsoft approaching OSI 
but many others regarding any move by Microsoft with deep suspicion. Eric 
Raymond acknowledges that ongoing debate and allows as how it's been going on 
within OSI, too. However, as he writes, "OSI's official position, from the 
beginning, which I helped formulate and have expressed to any number of 
reporters and analysts, is that OSI will treat any licenses submitted [by] 
Microsoft strictly on their merits, without fear or favor. That remains OSI's 
position. But..." He goes on, "...Microsoft's behavior in the last few months 
with respect to OOXML has been egregious. They haven't stopped at pushing 
a "standard" that is divisive, technically bogus, and an obvious tool of 
monopoly lock-in; they have resorted to lying, ballot-stuffing, 
committee-packing, and outright bribery to ram it through the ISO 
standardization process in ways that violate ISO's own guidelines wholesale."
Execute time 0.046 milliseconds
No match
data&gt; 
</pre>
Neil Youngman
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]
</p>
</b><br />
<b>Mon, 3 Sep 2007 22:01:42 -0400</b>
</p>

<p>
On Mon, Sep 03, 2007 at 09:34:21PM +0100, Neil Youngman wrote:
</p>

<pre>
&gt; On or around Monday 03 September 2007 18:20, Ben Okopnik reorganised a bunch 
&gt; of electrons to form the message:
&gt; &gt; On Mon, Sep 03, 2007 at 07:52:09AM -0600, s. keeling wrote:
</pre>

<p>
[...]
</p>


<pre>
&gt; &gt; &gt;      grep "^.*$foo.*"  ...
</pre>

<p>
[...]
</p>


<pre>
&gt; &gt; &gt; Well, why not just grep for $foo?  Is this actually
&gt; &gt; &gt; doing something magical which for some reason I can't see it, or is it
&gt; &gt; &gt; just silly?
&gt; &gt;
&gt; &gt; Neither - it's like dead yeast in beer. No benefit, but no particular
&gt; &gt; negative effect, either. If it was "^.+$foo.+", that would be a
&gt; &gt; completely different deal - but '.*'s are essentially meaningless in
&gt; &gt; this case.
&gt; 
&gt; Semantically that's true, however ...
</pre>

<p>
[...]
 
</p>

<pre>
&gt; ... that's the sort of thing, which could have an impact on performance if run 
&gt; often enough on large enough strings.
</pre>

<p>
Neil, I can't say that I've ever considered performance as a major goal
when writing a shell script. If I did, I wouldn't be writing a shell
script. <img src="../gx/smile.png" alt=":)">
</p>


<pre>
&gt; I went to a course on Exim, which 
&gt; included a very enlightening seminar on regex performance. This isn't 
&gt; particularly bad, but it is inefficient. 
</pre>

<p>
I actually add a section on regex performance when I teach my Perl
class, since Perl scripts are often used by, e.g., Web servers - where
performance matters quite a lot. I also throw in, <em>gratis</em>, a rant about
using '.*' to match things (it's way too broad and tends to grab far
more than necessary; useful for <strong>consuming</strong> space, but not for accurate
matching.) Part of the former is a section on backtracking - which is
nicely covered in "perldoc perlre".  My particular favorite is this bit:
</p>

<pre>
  It's important to realize that a regular expression is merely a set
  of assertions that gives a definition of success. There may be 0, 1, or
  several different ways that the definition might succeed against a
  particular string. And if there are multiple ways it might succeed, you
  need to understand backtracking to know which variety of success you
  will achieve.
</pre>

<pre>
&gt; I would expect the handling of the above to work on the following lines
&gt; 
&gt; 1. Match with ^ at the start of the line, no problem
&gt; 2. The first .* matches all the way to the end of the line.
&gt; repeat
&gt;   3. $foo doesn't match anything, roll back 1 character and try again
&gt; until $foo matches or you can't rollback any further
</pre>

<p>
The Perl regex engine is a bit smarter than that, actually; several
optimizations would kick in at this last step.
 
</p>

<pre>
&gt; 4 If you have a match
&gt;    then
&gt;      the final .* matches to the end of line
&gt;   else
&gt;      match failed
&gt; 
&gt; All these rollbacks are unnecessary and can soak up a serious amount of CPU 
&gt; with a badly written regex. A little testing (below) shows that it doesn't 
&gt; seem to be too bad in this case, but it could be expensive if repeated too 
&gt; often.
&gt; 
&gt; Pcretest shows that the simpler form takes 0.046 milliseconds on a longish, 
&gt; non-matching string, vs. 0.133 milliseconds for the version with the 
&gt; unnecessary complications. That's a factor of 3 difference in cost for zero 
&gt; benefit.
</pre>

<p>
All of which get swamped in disk access, etc.:
</p>

<pre>
ben@Tyr:/tmp$ time grep '^.*test string.*' foo
 
real    0m0.010s
user    0m0.008s
sys     0m0.000s
ben@Tyr:/tmp$ time grep 'test string' foo
 
real    0m0.010s
user    0m0.008s
sys     0m0.000s
</pre>
<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href="http://LinuxGazette.NET">http://LinuxGazette.NET</a> *
</pre>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
s. keeling [keeling at nucleus.com]
</p>
</b><br />
<b>Mon, 3 Sep 2007 16:17:02 -0600</b>
</p>

<p>
Incoming from Ben Okopnik:
</p>

<pre>
&gt; On Mon, Sep 03, 2007 at 07:52:09AM -0600, s. keeling wrote:
&gt; &gt; Incoming from Ben Okopnik:
&gt; &gt; &gt; Also - if you modify my scripts without having a sufficient level of
&gt; &gt; &gt; Perl-Fu, things <em>will</em> break. Anyway... for anyone tuning in late: this
&gt; &gt; 
&gt; &gt; Well, one person's "sufficient level of Perl-fu" is another person's
&gt; &gt; "why the heck did they do it that way?!?"  
&gt; &gt; [schnip]
&gt; &gt; 
&gt; &gt;      grep "^.*$foo.*"  ...
&gt; &gt; 
&gt; &gt; any characters.  Well, why not just grep for $foo?  Is this actually doing
&gt; &gt; something magical which for some reason I can't see it, or is it just
&gt; &gt; silly?
&gt; 
&gt; Neither - it's like dead yeast in beer. No benefit, but no particular
</pre>

<p>
&lt;pontification&gt;
Well, the first thing I thought when I saw it was, "How much can I
trust the last person to have known what they were doing?"
</p>

<p>
It goes to the question of reputation.  How much of the rest of this
thing was written by someone who apparently had only a vague
understanding of regexps?  How much can I trust the rest of this thing
to not blow up somewhere down the line and have that failure point to
me for not having caught and fixed such obvious bloopers?  I don't
want my name embedded in something which contains silliness like that.
&lt;/pontification&gt;
</p>

<p>
Thanks to Neil for the interesting pcre analysis (good to know), but
no, this isn't a situation where that would apply.  This app is a
highly interactive menu program which Ops use (I'm "Midrange") to
manage accounts and group memberships.  It's not timing sensitive that
way.
</p>

<p>
It's also since been stripped of all its "Useless Use of Cat":
</p>

<pre>
   cat /etc/passwd | grep $foo
</pre>
(grep is quite capable of opening up files all by itself, thank you
very much) and it's now using ksh test correctly.  This (sh/bash):
</p>

<pre>
   if [ "${foo}x" = "${bar}x" ]; then ...
</pre>
is (roughly) equivalent to (ksh):
</p>

<pre>
   if [[ $foo = $bar ]]; then ...
</pre>
Here's an oddity I discovered.  In ksh, this actually works as a valid
test (not assignment of $bar to foo):
</p>

<pre>
   if [ $foo=$bar ]; then ...
</pre>
Try that in C/C++.  <img src="../gx/smile.png" alt=":-)">  You can't do the same with double brackets.
This:
</p>

<pre>
   if [[ $foo=$bar ]]; then ...
</pre>
fails on a syntax error.  ksh has some interesting features.
For instance, "typeset var" creates a local variable named var.
</p>

<p>
I still much prefer perl, bash, and zsh, but ksh too is interesting as
shell scripting languages go.  Though I have looked into ksh before,
and have owned *O'Really*'s "Learning the Korn shell" for a long time,
this is the first time I've needed to use it professionally.  You
wizards, I imagine, think all of this this is pretty elementary stuff,
but the last time I worked on commercial Unix "shell scripting" (not
perl) was using HP/UX' sh-posix (ca. 1996).  Does that still exist?
</p>

<p>
There's a lot of mediocre code extant in the corporate world.
Corps. are seldom interested in "doing it right."  They're far more
often interested in "getting it done" so you can move on and get to
the next fire that needs fighting.  I believe that's why @#$% like
that regexp above happens.  Not enough time allotted to learn to get
it right.  "Just get it done, damnit!  Time's money."  :-P
</p>


<pre>-- 
Any technology distinguishable from magic is insufficiently advanced.
(*)
- -
</pre>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]
</p>
</b><br />
<b>Mon, 3 Sep 2007 22:40:47 -0400</b>
</p>

<p>
On Mon, Sep 03, 2007 at 04:17:02PM -0600, s. keeling wrote:
</p>

<pre>
&gt; 
&gt; &lt;pontification&gt;
&gt; Well, the first thing I thought when I saw it was, "How much can I
&gt; trust the last person to have known what they were doing?"
&gt; 
&gt; It goes to the question of reputation.  How much of the rest of this
&gt; thing was written by someone who apparently had only a vague
&gt; understanding of regexps?  How much can I trust the rest of this thing
&gt; to not blow up somewhere down the line and have that failure point to
&gt; me for not having caught and fixed such obvious bloopers?  I don't
&gt; want my name embedded in something which contains silliness like that.
&gt; &lt;/pontification&gt;
</pre>

<p>
That's an excellent perspective as well - and it's one I have whenever I
undertake to fix someone else's code.
 
</p>

<pre>
&gt;    cat /etc/passwd | grep $foo
</pre>

<p>
Oh-oh. Classic bad idea, that - and it's not just "Useless Use of
'cat'", either.
</p>

<p>
<pre class="code">
ben@Tyr:/tmp$ foo="a b"
ben@Tyr:/tmp$ &lt; /etc/passwd grep $foo
grep: b: No such file or directory
</pre>
Always - yes, <strong>always</strong> - quote the argument. Particularly when it's a
variable.
</p>


<pre>
&gt; (grep is quite capable of opening up files all by itself, thank you
&gt; very much) and it's now using ksh test correctly.  This (sh/bash):
&gt; 
&gt;    if [ "${foo}x" = "${bar}x" ]; then ...
</pre>

<p>
This is right...
 
</p>

<pre>
&gt; is (roughly) equivalent to (ksh):
&gt; 
&gt;    if [[ $foo = $bar ]]; then ...
</pre>

<p>
...while this could cause a problem - randomly (whenever the var is
undefined, or contains whitespace.)
</p>

<p>
<pre class="code">
ben@Tyr:/tmp$ [ $a = foo ] &amp;&amp; echo 'Ooops!'
-bash: [: =: unary operator expected
</pre>

<pre>
&gt; Here's an oddity I discovered.  In ksh, this actually works as a valid
&gt; test (not assignment of $bar to foo):
&gt; 
&gt;    if [ $foo=$bar ]; then ...
</pre>

<p>
Yep. Ksh being an sh-derived shell, it still follows all the POSIX
1002.3 spec (i.e., does all the 'sh'-standard stuff). I generally avoid
using the '[[ ]]' string-comparison syntax, since it's not portable; 
'[ ]' works everywhere.
 
</p>

<pre>
&gt; Try that in C/C++.  <img src="../gx/smile.png" alt=":-)">  You can't do the same with double brackets.
&gt; This:
&gt; 
&gt;    if [[ $foo=$bar ]]; then ...
&gt; 
&gt; fails on a syntax error.
</pre>

<p>
<pre class="code">
ben@Tyr:/tmp$ ksh
[ben@Tyr:/tmp]$ foo=abc
[ben@Tyr:/tmp]$ bar=abc
[ben@Tyr:/tmp]$ [[ "$foo"="$bar" ]] &amp;&amp; print 'It worked!'
It worked!
[ben@Tyr:/tmp]$ 
</pre>
You may be running some version different from mine, though (I've got
ksh93).
</p>


<pre>
&gt; There's a lot of mediocre code extant in the corporate world.
&gt; Corps. are seldom interested in "doing it right."  They're far more
&gt; often interested in "getting it done" so you can move on and get to
&gt; the next fire that needs fighting.  I believe that's why @#$% like
&gt; that regexp above happens.  Not enough time allotted to learn to get
&gt; it right.  "Just get it done, damnit!  Time's money."  :-P
</pre>

<p>
Heh. Too true.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href="http://LinuxGazette.NET">http://LinuxGazette.NET</a> *
</pre>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Kapil Hari Paranjape [kapil at imsc.res.in]
</p>
</b><br />
<b>Mon, 3 Sep 2007 08:53:52 +0530</b>
</p>

<p>
Hello,
</p>

<p>
One reason to renew annually (but well in time!) is that if you
take a 3-4 year lease you might not have this job on your annual
TODO list --- then you forget! That, of course, is where the
domain-check script will be useful.
</p>

<p>
Great article!
</p>

<p>
Kapil.
--
</p>


<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Rick Moen [rick at linuxmafia.com]
</p>
</b><br />
<b>Sun, 2 Sep 2007 23:44:06 -0700</b>
</p>

<p>
Quoting Kapil Hari Paranjape (kapil@imsc.res.in):
</p>


<pre>
&gt; One reason to renew annually (but well in time!) is that if you
&gt; take a 3-4 year lease you might not have this job on your annual
&gt; TODO list --- then you forget! That, of course, is where the
&gt; domain-check script will be useful.
</pre>

<p>
Well, speaking of that, there's actually no reason why you can't renew
(i.e., add an extra year to) a domain annually <em>and</em> always keep a fixed
distance of about 3-4 years away from expiration.  In fact, that sounds
like a capital idea, to me!
</p>

<pre>-- 
Cheers,                     Errors have been made.  Others will be blamed.
Rick Moen
rick@linuxmafia.com
</pre>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_142_moen_html">Back</a><hr width="50%" align="left" /><p><br /></p></div>
</body>
</html>