<!--startcut ======================================================= -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<META NAME="generator" CONTENT="lgazmail v1.4F.s">
<TITLE>The Answer Gang 79: How does LILO find the boot partition???</TITLE>
</HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"
	LINK="#3366FF" VLINK="#A000A0">
<!--endcut ========================================================= -->
<P> <hr> 
<!--startcut ======================================================= -->
<CENTER>
<!-- *** BEGIN navbar *** -->
<!-- *** END navbar *** -->
</CENTER>
</p>
<!--endcut ========================================================= -->
<!--startcut ======================================================= -->
<P> <hr> 
<!-- begin tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::-->
<p align="center">
<table width="100%" border="0"><tr>
<td align="right" valign="center"
	><IMG ALT="" SRC="../../gx/navbar/left.jpg"
        WIDTH="14" HEIGHT="45" BORDER="0" ALIGN="middle" border="0"
><A HREF="../index.html"
	><IMG SRC="../../gx/navbar/toc.jpg" align="middle"
              ALT="[ Table Of Contents ]" border="0"></A
><A HREF="../lg_answer.html"
	><IMG SRC="../../gx/dennis/answertoc.jpg" align="middle"
              ALT="[ Answer Guy Current Index ]" border="0"></A></td>
<td align="center" valign="center"><A HREF="../lg_answer.html#greeting"><img align="middle"
	src="../../gx/dennis/smily.gif" alt="greetings" border="0"></A> &nbsp;
  <A HREF="../tag/bios.html">Meet&nbsp;the&nbsp;Gang</A> &nbsp;
  <A HREF="1.html">1</A> &nbsp;
  <A HREF="2.html">2</A> 
  </td>
<td align="left" valign="center"><A HREF="../../tag/kb.html"
	><IMG SRC="../../gx/dennis/answerpast.jpg" align="middle"
              ALT="[ Index of Past Answers ]" border="0"></A
><IMG ALT="" SRC="../../gx/navbar/right.jpg" align="middle"
        WIDTH="14" HEIGHT="45" BORDER="0"></td></tr></table>
</p>
<!-- end tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::::-->
<!--endcut ========================================================= -->
<P> <hr> <P>
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<center>
<H1><A NAME="answer">
	<img src="../../gx/dennis/qbubble.gif" alt="(?)" 
		border="0" align="middle">
	<font color="#B03060">The Answer Gang</font>
	<img src="../../gx/dennis/bbubble.gif" alt="(!)" 
		border="0" align="middle">
</A></H1> 
<BR>
<H4>By Jim Dennis, Ben Okopnik, Dan Wilder, Breen, Chris, and...
        (<a href="tag/bios.html">meet the Gang</a>) ...
        the Editors of Linux Gazette...

	and You!
<br>Send questions (or interesting answers) to
	The Answer Gang
	for possible publication 
	(but read the <a href="../tag/ask-the-gang.html">guidelines</a> first)
</H4>
</center>
<!-- ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: -->
<p><hr><p>
<!-- begin 2 -->
<H3 align="left"><img src="../../gx/dennis/qbubble.gif" 
	height="50" width="60" alt="(?) " border="0"
	>How does LILO find the boot partition???</H3>


<p><strong>From Super Simian 
</strong></p> 
<p></strong></p>

<!-- sig -->


<!-- sig -->


<p align="right"><strong>Answered By  John Karns, Ben Okopnik
</strong></p>
<P><STRONG>
Greetings Answer Gang,
</STRONG></P>
<P><STRONG>
I've found the info you've given to others very useful in the not-so-distant
past, and I like the Gazette in general, and I thought I might ask you a
question to which I have looked for the answer to myself, and very recently
plagued and tormented me:
</STRONG></P>
<P><STRONG><BLOCKQuote>
How does LILO find the boot partition???
</BLOCKQuote></STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben Okopnik] 
Quite tasty, thanks. Also rather cute and cuddly, but not quite the kind
of thing one takes home to mother, if you know what I mean. 
<IMG SRC="../../gx/dennis/smily.gif" ALT=":)" 
		height="24" width="20" align="middle">
</blockQuote>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [John Karns] 
Sorry, I'm on a bit of a hurry at the moment so am unable to write a
detailed reply.  But I can offer some hints.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
Wait, first, here's what I'm running:
</STRONG></P>

<blockquote><code><font color="#000033"><br>PIII dual proc
<br>RedHat 7.2
<br>2 IDE disks, hda and hdc,
<br>1 SCSI disk, sda
</font></code></blockquote>
<P><STRONG>
Suppose that's all that's relevant to this question...
</STRONG></P>
<P><STRONG>
OK, so the scsi disk is a pretty new addition to the setup, and I already
had a pretty good linux install on hdc, so I decided to move over to the
scsi as my main disk. After a bit of fooling around, I decided that the
easiest way was just to do a new install onto the scsi, and copy over some
choice config files and all my data. This went smoothly, no problem.
</STRONG></P>
<P><STRONG>
Oh, I should probably mention at this point, I had LILO in the MBR of hda,
and my boot partition was on hdc1...
</STRONG></P>
<P><STRONG>
So, about a week later, I still had my old linux installation on hdc2, as I
was waiting to see if I had forgotten any vital info before I commited it to
the abyss. Well, my roommate wanted to reinstall and format (WinXP, as it
happens...) and he needed about 6 gigs of backup space, so I deleted my old
linux installation on hdc2, and rewrote the LILO on the MBR without it, just
to make sure everything was still cool, and it was. We moved the data to my
system, he reinstalled, and we moved the data back.
</STRONG></P>
<P><STRONG>
So, then, I decided it was time for a little housekeeping, and repartitioned
hdc as one ext3, and went to reboot, and... OH CRAP! My boot partition was
on that drive!!!
</STRONG></P>
<P><STRONG>
So, I poped in my bootable "Super Rescue" cdrom, and decided to poke around
a bit and see if I could get my system to boot again. I ran LILO again, no
dice. I poked around for a while, and noticed I still had all of the data in
<TT>/boot</TT> on sda1, and tried to figure out how to inform LILO about this, but I
had no luck. I even recreated the boot partition on hdc1 and copied all the
same info back onto it, and reran LILO, still no luck. After looking through
some man pages and browsing through liniuxdoc.org, I still had no clue as to
how to get things working again, so I made a new linux install on hdc, using
the same boot partition (hdc1) and installing LILO to the MBR of hda again,
modified lilo.conf in this new install to also boot the sda copy of RedHat,
and everything worked.
</STRONG></P>
<P><STRONG>
So, my question to you, is how do I make LILO aware of the location of the
boot partition or directory? How do I prevent this from happening again
(aside form not deleting my boot partition
<IMG SRC="../../gx/dennis/smily.gif" ALT=":)" 
		height="24" width="20" align="middle">
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [John Karns] 
With 3 hd's in the system, things can get a little complicated to explain,
as there are so many ways to go about it.  But for the time being, let's
say that when you installed to sda the install properly set up everything
on sda, and assumed that it was the only drive in the system.  Then in
order to boot from sda, you would have to make a change in your BIOS setup
to tell the system to boot from SCSI.  When there are both IDE and SCSI
drives installed, the default is to boot from IDE.  Most BIOSes I have
seen in the past two years allow the option of booting from SCSI.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
Oh, I thought it might be something in <TT>/etc/fstab</TT>, but to my feeble efforts,
this proved to be a blind alley.
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben Okopnik] 
Nope, wouldn't be there. That comes <em> _way</em> down the road, dealing with
which partitions should be mounted and where.
</blockQuote>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [John Karns] 
If you installed fresh to sda, then the fstab there should have the
correct set up.  However, if you copied the one from hdc, then you would
have to change the partition references to point to sda.
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
I'm feeling a little lost, there doesn't seem to be anything in lilo.conf
addressing this,
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben Okopnik] 
Here's a bit from my "<TT>/etc/lilo.conf</TT>" (though admittedly not all the distros
comment theirs this well):
</blockQuote>

<blockquote><pre># Specifies the boot device.  This is where Lilo installs its boot
# block.  It can be either a partition, or the raw device, in which
# case it installs in the MBR, and will overwrite the current MBR.
#
boot=/dev/hda
</pre></blockquote>
<P><STRONG>
<IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
and I thought maybe fstab might help, as LILO should be
able to find this file, as the <TT>/</TT> directory IS specified in lilo.conf, but
please, help!
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [John Karns] 
You have to decide on what scheme you want to use to boot your system -
i.e., whether you want to boot from lilo or use XP's boot mgr (lilo is
easier to config for multi-boot IMO), and from which drive you want to
boot.  Gotta go.
</blockQuote>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben Okopnik] 
My recommendation to you is to take a good read of
"<TT>/usr/share/doc/lilo/Manual.txt.gz</TT>", or wherever RedHat keeps its doc
files (if I recall, it's that or something fairly close to it.) It's a
well-written document that describes the boot process and LILO's place
in it, as well as all about boot records and where they can be stored
and how they can be accessed. Quite an education, all in one file (about
125kB, but, hey, it's a complete manual.)
</blockQuote>
<P><STRONG>
<IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
Eagerly awaiting your replies,
</STRONG></P>
<P><STRONG>
--Super Simian
</STRONG></P>
<P><STRONG>
PS-I hope this email doesn't contain any html, I know you people don't like
that, but it's hotmail and it might, and I can't find anywhere to turn it
off!
</STRONG></P>
<P><STRONG>
Thanks again!
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben Okopnik] 
It was fine, just plain text. Seems like Hotmail does the Right Thing in
that regard.
</blockQuote>
<HR width="10%" align="left"><P><STRONG>
<IMG SRC="../../gx/dennis/qbub.gif" ALT="(?)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> 
Hello again,
</STRONG></P>
<P><STRONG>
OK, after reviewing the documentation under <TT>/usr/share/doc/lilo</TT>, I think I
understand exactly what happened. Lilo was starting the boot process, but
only got as far as "LI" because it couldn't find the files in <TT>/boot</TT>, which
originally was a separate partition, hdc1. Even after recreating this
partition, and copying the same data back to it, it still couldn't find
<TT>/boot/boot.b</TT> because the info Lilo stores in the MBR points to the physical
location on disk of boot.b, instead of using partition numbers and
directories to locate it. That's why I couldn't find anywhere to specify the
location of the boot partition, because Lilo gets this info from your
filesystem when you execute <TT>/sbin/lilo</TT> to write a new MBR. So if you have,
say, your root on hdc5, and hdc1 is mounted under <TT>/boot</TT>, then it actually
stores the location of the files on disk (by sector, or some such), and if
you remove hdc1 from your filesystem and just copy the files to <TT>/boot</TT> under
hdc5, Lilo will still look for the info on hdc1.
</STRONG></P>
<P><STRONG>
Then, when I reran Lilo to try to get it to use the <TT>/boot</TT> directory on sda1,
it still couldn't find <TT>/boot/boot.b</TT> because it was on a SCSI disk which was
not addressable by BIOS during the early portion of booting, as I had my
SCSI BIOS turned off to speed booting. I mistakenly thought that the stuff
in the MBR was enough to get the computer into protected-mode.
</STRONG></P>
<P><STRONG>
So, thank you very much for pointing out that document, it has proved to be
an excellent repository of informative Lilo goodness!
</STRONG></P>
<P><STRONG>
Oh, and do you see any flaws in my thinking? I'm fairly sure that the above
is what was going on...
</STRONG></P>
<P><STRONG>
Thank you
</STRONG></P>
<blockQuote>
<IMG SRC="../../gx/dennis/bbub.gif" ALT="(!)"
	HEIGHT="28" WIDTH="50" BORDER="0"
	> [Ben Okopnik] 
It all sounds very reasonable to me, at least according to The Holy
Writ, erm, I mean <TT>/usr/share/doc/lilo/Manual.txt.gz.</TT> Sounds like you've
read the docs and understood them - well done!
</blockQuote>

<!-- end 2 -->
<P> <hr> </p>
<!-- *** BEGIN copyright *** -->
<H5 align="center">This page edited and maintained by the Editors
        of <I>Linux Gazette</I>
<a href=""
        >Copyright &copy;</a> 2002
<BR>Published in issue 79 of <I>Linux Gazette</I> June 2002</H5>
<H6 ALIGN="center">HTML script maintained by
        <A HREF="mailto:star@starshine.org">Heather Stern</a> of
        Starshine Technical Services,
        <A HREF="http://www.starshine.org/">http://www.starshine.org/</A>
</H6>
<!-- *** END copyright *** -->
<!--startcut ======================================================= -->
<P> <hr> 
<!-- begin tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::-->
<p align="center">
<table width="100%" border="0"><tr>
<td align="right" valign="center"
	><IMG ALT="" SRC="../../gx/navbar/left.jpg"
        WIDTH="14" HEIGHT="45" BORDER="0" ALIGN="middle" border="0"
><A HREF="../index.html"
	><IMG SRC="../../gx/navbar/toc.jpg" align="middle"
              ALT="[ Table Of Contents ]" border="0"></A
><A HREF="../lg_answer.html"
	><IMG SRC="../../gx/dennis/answertoc.jpg" align="middle"
              ALT="[ Answer Guy Current Index ]" border="0"></A></td>
<td align="center" valign="center"><A HREF="../lg_answer.html#greeting"><img align="middle"
	src="../../gx/dennis/smily.gif" alt="greetings" border="0"></A> &nbsp;
  <A HREF="../tag/bios.html">Meet&nbsp;the&nbsp;Gang</A> &nbsp;
  <A HREF="1.html">1</A> &nbsp;
  <A HREF="2.html">2</A> 
  </td>
<td align="left" valign="center"><A HREF="../../tag/kb.html"
	><IMG SRC="../../gx/dennis/answerpast.jpg" align="middle"
              ALT="[ Index of Past Answers ]" border="0"></A
><IMG ALT="" SRC="../../gx/navbar/right.jpg" align="middle"
        WIDTH="14" HEIGHT="45" BORDER="0"></td></tr></table>
</p>
<!-- end tagnav ::::::::::::::::::::::::::::::::::::::::::::::::::::-->
<!--endcut ========================================================= -->
<P> <hr> 
<!--startcut ======================================================= -->
<CENTER>
<!-- *** BEGIN navbar *** -->
<!-- *** END navbar *** -->
</CENTER>
</p>
<!--endcut ========================================================= -->
<!--startcut ======================================================= -->
</BODY></HTML>
<!--endcut ========================================================= -->
