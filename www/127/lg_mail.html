
<html>
<head>
<link href="../lg.css" rel="stylesheet" type="text/css" media="screen, projection"  />
<link rel="shortcut icon" href="../favicon.ico" />
<title>The Mailbag LG #127</title>

<style type="text/css" media="screen, projection">
<!--

-->
</style>

<link rel="alternate" type="application/rss+xml" title="LG RSS" href="lg.rss" />
<link rel="alternate" type="application/rdf+xml" title="LG RDF" href="lg.rdf" />
<link rel="alternate" type="application/atom+xml" title="LG Atom" href="lg.atom.xml" />

</head>

<body>


<img src="../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" alt="Linux Gazette"/>
<p id="fun">...making Linux just a little more fun!</p>


<div class="content articlecontent">

<div id="previousnexttop">
<A HREF="lg_talkback.html" >&lt;-- prev</A> | <A HREF="lg_mail2.html" >next --&gt;</A>
</div>



<h1>The Mailbag</h1>
<p id="by"><b>By <A HREF="../authors/tanaka-okopnik.html">Kat Tanaka Okopnik</A></b></p>

<p>
<hr>
<center>
  <big><strong><font COLOR="maroon">GAZETTE MATTERS</font></strong></big>
  <!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->
  <a NAME="notice.1"></a> 
</center>
<hr>
<h3><img ALIGN=BOTTOM ALT="" SRC="../gx/envelope.gif"> <font color="navy">&quot;Open 
  Source State of the Union&quot; in Boston</font></h3>
<p>Benjamin A. Okopnik (ben at linuxgazette.net)<br />
  Wed Mar 29 00:50:24 PST 2006</p>
<p> <strong>Hi, Gang -</strong></p>
<p><strong>Anyone interested in hearing Bruce Perens do his &quot;Open Source 
  State of the Union&quot; speech in Boston (4/5/2006), please let me know and 
  I'll arrange a press pass for you (it would be a Very Nice Thing if you sent 
  in a conference report as a result.) Do note that this usually requires a recently-published 
  article with your name on it.</strong></p>
<p><strong>In fact, if you'd like to attend any other industry conferences, the 
  same process applies. I will ask that you do a little research in those cases 
  and send me the contact info for the group that's running the particular con 
  you're interested in.</strong></p>
  <!-- end 1 -->
  <!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->
  
<hr>
<center>
  <big><strong><font COLOR="maroon">FOLLOWUPS from Previous Mailbags</font></strong></big> 
  <br>
  <strong>Submit comments about articles, or articles themselves (after reading 
  <a href="../faq/author.html">our guidelines</a>) to <a HREF="mailto:gazette@linuxgazette.net">The 
  Editors of <i>Linux Gazette</i></a>, and technical answers and 
  <!-- index_text begins -->
  tips about Linux to <a HREF="mailto:tag@lists.linuxgazette.net">The Answer Gang</a>. 
  </strong> 
</center><hr>

<a NAME="update.1"></a>
<h3><img ALIGN=BOTTOM ALT="" SRC="/gx/envelope.gif"> <font COLOR="navy"> USB MIDI</font></h3>
<p><p>  Bob van der Poel (bvdp at uniserve.com)<br />
  Sun Feb 26 18:31:54 PST 2006</p>
  
<p class="editorial">Following up on a <a href="../122/lg_mail.html#wanted.4">previous 
  discussion</a></p>
<p> <strong>Just to follow up on this ... I have it working perfectly now. A few 
  fellows on the ALSA mailing list gave me hand and found out that for some reason 
  the OSS sound stuff was being loaded and then the ALSA was ignored (still, I 
  don't see why a cold plug did work). But, the simple solution was to delete 
  or rename the kernel module &quot;usb-midi.ko.gz&quot; so that the system can't 
  find it. Works like a damn.</strong></p>

<!-- end 1 -->
<!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->

<hr>
<center>
  <big><strong><font COLOR="maroon">GENERAL MAIL</font></strong></big> 
</center><hr>
<ul>
  <!-- index_text begins -->
  <li><a HREF="#mailbag.01"
	><strong>Default inputs for program 
  at cmd line</strong></a> 
  <li><a HREF="#mailbag.02"
	><strong>Help with file transfer 
  over parallel port.</strong></a> 
  <li><a HREF="#mailbag.03"
	><strong>Can a running command be 
  modified?</strong></a> 
  <li><a HREF="#mailbag.04"
	><strong>I have a question about 
  rm command.</strong></a> 
  <li><a HREF="#mailbag.05"
	><strong>Writing to an NFS share 
  truncates files</strong></a>  
  <li><a HREF="#mailbag.06"
	><strong>Answer 
  Blog/Ad-hoc Wireless Network</strong></a> 
    <!-- index_text ends -->
</ul>
<!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->
<a NAME="mailbag.01"></a>
<hr WIDTH="75%" ALIGN="center">
<h3><img ALIGN=BOTTOM ALT="" SRC="../gx/envelope.gif"> Default inputs for program 
  at cmd line</h3>
<p>Brian Sydney Jathanna (briansydney at gmail.com)<br />
  Tue Mar 14 18:18:19 PST 2006</p>
<p> <strong>Hi all,</strong></p>
<p><strong>I was just wondering if there is a way to enter the default inputs 
  at the cmdline recursively when a program asks for user input. For eg. while 
  compiling the kernel it asks for a whole lot of interactions wherein you just 
  keep pressing Enter. The command 'Yes' is not an option in this case cos at 
  some stages the default input would be a No. Help appreciated and thanks in 
  advance.</strong></p>
<p>[Thomas] - Sure. You can use 'yes' of course -- just tell it not to actually 
  print any characters:</p>
<pre class="code">
   yes "" | make oldconfig
</pre>
<blockquote> 
  <p> That will just feed into each stage an effective "return key press" that 
    accepts whatever the default is. </p>
</blockquote>
<p>[[Ben]] - Conversely, you can use a 'heredoc' - a shell mechanism designed 
  for just that reason:</p>
<pre class="code">
  program <&lt;!
  yes
  no
  maybe

  !
</pre>
<blockquote>
  <p>In the above example, &quot;program&quot; will receive four arguments via 
    STDIN: 'yes&lt;Enter&gt;', 'no&lt;Enter&gt;', 'maybe&lt;Enter&gt;', and the 
    &lt;Enter&gt; key all by itself.</p>
</blockquote>
<!-- end 1 -->
<!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->
<a NAME="mailbag.02"></a><hr WIDTH="75%" ALIGN="center">
<h3><img ALIGN=BOTTOM ALT="" SRC="../gx/envelope.gif"> <font color="navy">Help 
  with file transfer over parallel port.</font></h3>
<p>sam luther (smartysam2003 at yahoo.co.in)<br />
  Sat Mar 18 12:32:22 PST 2006</p>
<p><strong>I want to develop C code to transfer files from one PC to another PC 
  over the parallel ports(DB 25 on my machine) of linux machines. I got the 18 
  wire cable ready but not sure with the connections and how to open and control 
  the parallel port. Plz help...advices, sample codes, relevant material will 
  b very helpful. Thx </strong></p>
<p>[Thomas] - Well, if this is Linux -&gt; Linux, setup PLIP.</p>
<blockquote> 
  <p>(Searching linuxgazette.net for 'PLIP' will yield all the answers you need). 
    Having done that you can setup NFS or sshfs, or scp, in the normal way. </p>
</blockquote>
<p>[Jimmy] - Hmm. Advice, sample code, relevant material...</p>
<blockquote>
  <p><a href="../issue95/pramode.html">http://linuxgazette.net/issue95/pramode.html</a><br />
    <a href="../118/deak.html">http://linuxgazette.net/118/deak.html</a><br />
    <a href="../122/sreejith.html">http://linuxgazette.net/122/sreejith.html</a><br />
    <a href="../112/radcliffe.html">http://linuxgazette.net/112/radcliffe.html</a></p>
  <p>are just some of the articles published in previous issues of LG that discuss 
    doing various different things with the parallel port. The article in issue 
    122 also has diagrams, which may be of help.</p>
</blockquote>
<!-- end 2 -->
<!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->
<a NAME="mailbag.03"></a><hr WIDTH="75%" ALIGN="center">
<h3><img ALIGN=BOTTOM ALT="" SRC="../gx/envelope.gif"> <font color="navy">Can 
  a running command be modified?</font></h3>
<p>Brian Sydney Jathanna (briansydney at gmail.com)<br />
  Tue Mar 21 14:44:57 PST 2006</p>
<p> <strong>Is there a way to modify the commandline of a running process? By 
  looking at /proc/&lt;pid&gt;/cmdline it looks as though it is readonly even 
  to root user. It would be helpful to add options or change arguments to a running 
  command, if this was possible. Is there a way to get around with it? Thanks 
  in advance.</strong></p>
<p>[Thomas] - I don't see how. Most applications only parse what they're told 
  to at init time, via --command-line options. This means you would have to effectively 
  restart the application.</p>
<blockquote> 
  <p>However, if a said application receives its options via a config file, then 
    sending that application a HUP signal might help you -- providing the said 
    application supports the command-line options in the config file.</p>
</blockquote>
<p>[[Ben]] - Not that I can make a totally authoritative statement on this, but 
  I agree with Thomas: when the process is running, what you have is a memory 
  image of a program _after_ it has finished parsing all the command-line options 
  and doing all the branching and processing dependent on them; there's no reason 
  for those command-line parsing mechanisms to be active at that point. Applications 
  that need this kind of functionality - e.g., Apache - use the mechanism that 
  Thomas describes to achieve it, with a &quot;downtime&quot; of only a tiny fraction 
  of a second between runs.</p>
<!-- end 3 -->
<!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->
<a NAME="mailbag.04"></a><hr WIDTH="75%" ALIGN="center">
<h3><img ALIGN=BOTTOM ALT="" SRC="../gx/envelope.gif"> <font color="navy">I have 
  a question about rm command.</font> </h3>
<p>manne neelima (manne_neelima at yahoo.com)<br />
  Wed Mar 22 12:08:12 PST 2006</p>
<p> <strong>I have a question about rm command. Would you please tell me how to 
  remove all the files excepts certain Folder in Unix?</strong></p>
<p><strong>Thanks in Advance<br />
  Neelima</strong></p>
<p>[Thomas] - Given that the 'rm' command is picky about removing non-empty directories 
  anyway (unless it is used with the '-f' flag) I suspect your question is:</p>
<blockquote> 
  <p>&quot;How can I exclude some file from being removed?&quot;</p>
  <p>... to which the answer is:</p>
  <p>&quot;It depends on the file -- what the name is, whether it has an 'extension', 
    etc.&quot;</p>
  <p>Now, since you've provided next to nothing about any of that, here's a contrived 
    example. Let's assume you had a directory &quot;/tmp/foo&quot; with some files 
    in it:</p>
  <p>```<br />
    [n6tadam at workstation foo]$ ls<br />
    a b c<br />
    '''</p>
  <p>Now let us add another directory, and add some files into that:</p>
  <p>```<br />
    [n6tadam at workstation foo2]$ ls<br />
    c d e f g<br />
    '''</p>
  <p>Let's now assume you only wanted to remove all the files in foo:</p>
  <p>```<br />
    [n6tadam at workstation foo]$ rm -i /tmp/foo/*<br />
    '''</p>
  <p>Would remove the files 'a', 'b', and 'c'. It would not remove &quot;foo2&quot; 
    since that's a non-empty directory.</p>
  <p>Of course, the answer to your question is really one of globbing. I don't 
    know what kind of files you want removing, but for situations such as this, 
    the find(1) command works &quot;better&quot;:</p>
  <p>```<br />
    find /tmp/foo -type f -print0 | xargs -0 rm<br />
    '''</p>
  <p>... would remove all files in /tmp/foo _recursively_ which means the files 
    in /tmp/foo2 would also be removed. Woops. Note that earlier with the &quot;rm 
    -i *&quot; command, the glob only expands the top-level, as it ought to. You 
    can limit find's visibility, such that it will only remove the files from 
    /tmp/foo and nowhere else:</p>
  <p>```<br />
    find /tmp/foo -maxdepth 1 -type f -print0 | xargs -0 rm<br />
    '''</p>
  <p>Let's now assume you didn't want to remove file &quot;b&quot; from /tmp/foo, 
    but everything else. You could do:</p>
  <p>```<br />
    find /tmp/foo -maxdepth 1 -type f -not -name 'b' -print0 | xargs -0 rm<br />
    '''</p>
  <p>... etc.</p>
</blockquote>
<p>[Ben] - Well, first off, Unix doesn't have &quot;Folders&quot;; I presume that 
  you're talking about directories. Even so, the 'rm' command doesn't do that 
  - there's no &quot;selector&quot; mechanism built into it except the (somewhat 
  crude) &quot;-i&quot; (interactive) option. However, you can use shell constructs 
  or other methods to create a list of files to be supplied as an argument list 
  to 'rm', which would do what you want - or you could process the file list and 
  use a conditional operator to execute 'rm' based on some factor. Here are a 
  few examples:</p>
<blockquote> 
  <p># Delete all files except those that end in 'x', 'y', or 'z'<br />
    rm *[^xyz]</p>
  <p># Delete only the subdirectories in the current dir<br />
    for f in *; do [ -d &quot;$f&quot; ] &amp;&amp; rm -rf &quot;$f&quot;; done</p>
  <p># Delete all except regular files<br />
    find /bin/* ! -type f -exec /bin/rm -f {} \;</p>
</blockquote>
<p>[[Ben]] - Whoops - forgot to clean up after experimenting. :) That last should, 
  of course, be</p>
<blockquote>
  <p>find * ! -type f -exec /bin/rm -f {} \;</p>
</blockquote>
<p>[[[Francis]]] - My directory &quot;.evil&quot; managed to survive those last 
  few. And my file &quot;(surprise&quot; seemed to cause a small problem...</p>
<p>[[[[Ben]]]] - Heh. Too right; I got too focused on the &quot;except for&quot; 
  nature of the problem. Of course, if I wanted to do a real search-and-destroy 
  mission, I'd do something like</p>
<blockquote> 
  <pre class="code">   su -c 'chattr -i file1 file2 file3; rm -rf `pwd`; chattr +i *'</pre>
  <p>[evil grin]</p>
  <p>No problems with '(surprise', '.evil', or anything else.</p>
</blockquote>
<p>[[[[[Thomas]]]]] - ... that won't work across all filesystems, though.</p>
<p>[[[[[[Ben]]]]]] - OK, here's something that will:</p>
<blockquote>
  <p>1) Copy off the required files.<br />
    2) Throw away the hard drive, CD, whatever the medium.<br />
    3) Copy the files back to an identical medium.</p>
  <p>There, a nice portable solution. What, you have more objections? :)</p>
  <p> Note that I said &quot;if *I* wanted to do a real search-and-destroy mission&quot;. 
    I use ext3 almost exclusively, so It Works For Me. To anyone who wants to 
    include vfat, reiserfs, pcfs, iso9600, and malaysian_crack_monkey_of_the_week_fs, 
    I wish the best of luck and a good supply of their tranquilizer of choice.</p>
</blockquote>
<p>[[[Francis]]] - (Of course, you knew that.</p>
<p>[[[[Ben]]]] - Actually, I'd missed it while playing around with the other stuff, 
  so I'm glad you were there to back me up.</p>
<p>[[[Francis]]] - But if the OP cares about *really* all-bar-one, it's worth 
  keeping in mind that &quot;*&quot; tends not to match /^./, and also that &quot;*&quot; 
  is rarely as useful as &quot;./*&quot;, at least when you don't know what's 
  in the directory. I suspect this isn't their primary concern, though.)</p>
<p>[[[[Ben]]]] - Well, './*' won't match dot-files any better than '*' will, although 
  you can always futz around with the 'dotglob' setting:</p>
<blockquote>
  <pre class="code">   # Blows away everything in $PWD<br />   (GLOBIGNORE=1; rm *)</pre>
  <p>...but you knew that already. :)</p>
</blockquote>
<p>[Martin] - try this perl script... This one deletes all hidden files apart 
  from the ones in the hash.</p>
<blockquote> 
  <pre class="code">#!/usr/bin/perl -w
use strict;
use File::Path;

#These are the files you want to keep.

         my %keepfiles = (
	".aptitude" =&gt; 1,
	".DCOPserver_Anne__0" =&gt; 1,
	".DCOPserver_Anne_:0" =&gt; 1,
	".gconf" =&gt; 1,
	".gconfd" =&gt; 1,
	".gnome2" =&gt; 1,
	".gnome2_private" =&gt; 1,
	".gnupg" =&gt; 1,
	".kde" =&gt; 1,
	".kderc" =&gt; 1,
	".config" =&gt; 1,
	".local" =&gt; 1,
	".mozilla" =&gt; 1,
	".mozilla-thunderbird" =&gt; 1,
	".qt" =&gt; 1,
	".xmms" =&gt; 1,
	".bashrc" =&gt; 1,
	".prompt" =&gt; 1,
	".gtk_qt_engine_rc" =&gt; 1,
	".gtkrc-2.0" =&gt; 1,
	".bash_profile" =&gt; 1,
	".kderc" =&gt; 1,
	".ICEauthority" =&gt; 1,
	".hushlogin" =&gt; 1,
	".bash_history" =&gt; 1,		
);
         my $inputDir = ".";

         opendir(DIR,$inputDir) || die("somemessage $!\n");
         while (my $file = readdir(DIR)) {
             next if ($file =~ /^\.\.?$/); # skip . &amp; ..
             next if ($file !~ /^\./); #skip unless begins with .
             # carry on if it's a file you wanna keep
             next if ($keepfiles{$file});
             # Else wipe it
             #print STDERR "I would delete $inputDir/$file\n";

             # you should probably test for outcome of these
#operations...
             if (-d $inputDir . "/" . $file) {
                 #rmdir($inputDir . "/" . $file);
                 print STDERR "Deleteing Dir $file\n";
		rmtree($inputDir . "/" . $file);
             }
             else {
                 print STDERR "Deleting File $file\n";
		unlink($inputDir . "/" . $file);
             }
         }
         closedir(DIR);</pre>
</blockquote>
<p>[[Ben]] - All that, and a module, and 'opendir' too? Wow.</p>
<blockquote>
  <pre class="code">   perl -we'@k{qw/.foo .bar .zotz/}=();for(&lt;.*&gt;){unlink if -f&amp;&amp;!exists$k{$_}}'</pre>
  <p>:)</p>
</blockquote>
    <!-- end 4 -->
	<!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->
 

<a NAME="mailbag.05"></a><hr WIDTH="75%" ALIGN="center">
<h3><img ALIGN=BOTTOM ALT="" SRC="../gx/envelope.gif"> <font color="navy">writing 
  to an NFS share truncates files</font></h3>
<p>Ramon van Alteren (ramon at vanalteren.nl)<br />
  Wed Feb 8 15:44:14 PST 2006</p>
<p> <strong>Hi All,</strong></p>
<p><strong>I've recently built a 9Tb NAS for our serverpark out of 24 SATA disks 
  &amp; 2 3ware 9550SX controllers. Works like a charm, except....... NFS</strong></p>
<p><strong>We export the storage using nfs version 3 to our servers. Writing onto 
  the local filesystem on the NAS works fine, copying over the network with scp 
  and the like works fine as well.</strong></p>
<p><strong>However writing to a mounted nfs-share at a different machine truncates 
  files at random sizes which appear to be multiples of 16K. I can reproduce the 
  same behaviour with a nfs-share mounted via the loopback interface.</strong></p>
<p><strong>Following is output from a test-case:</strong></p>
<p>On the server in /etc/exports:</p>
  <pre class="code">
  /data/tools 10.10.0.0/24(rw,async,no_root_squash) 127.0.0.1/8
  (rw,async,no_root_squash)</pre>
<p>Kernelsymbols:</p>
<pre class="code">
   Linux spinvis 2.6.14.2 #1 SMP Wed Feb 8 23:58:06 CET 2006 i686 Intel (R) Xeon(TM) 
   CPU 2.80GHz GenuineIntel GNU/Linux</pre>
<p>Similar behaviour is observed with gentoo-sources-2.6.14-r5, same options.</p>
<pre class="code">
   CONFIG_NFS_FS=y
   CONFIG_NFS_V3=y
   CONFIG_NFS_V3_ACL=y
   # CONFIG_NFS_V4 is not set
   # CONFIG_NFS_DIRECTIO is not set
   CONFIG_NFSD=y
   CONFIG_NFSD_V2_ACL=y
   CONFIG_NFSD_V3=y
   CONFIG_NFSD_V3_ACL=y
   # CONFIG_NFSD_V4 is not set
   CONFIG_NFSD_TCP=y
   # CONFIG_ROOT_NFS is not set
   CONFIG_NFS_ACL_SUPPORT=y
   CONFIG_NFS_COMMON=y


   #root at cl36 ~ 20:29:44 &gt; mount
<partly snipped>
   10.10.0.80:/data/tools on /root/tools type nfs  
   (rw,intr,lock,tcp,nfsvers=3,addr=10.10.0.80)
   #root at cl36 ~ 20:29:56 &gt; for i in `seq 1 30`; do dd count=1000 if=/dev/ 
   zero of=/root/tools/test.tst; ls -la /root/tools/test.tst ; rm /root/ 
   tools/test.tst ; done
   1000+0 records in
   1000+0 records out
   dd: closing output file `/root/tools/test.tst': No space left on device
   -rw-r--r--  1 root root 163840 Feb  8 20:30 /root/tools/test.tst
   1000+0 records in
   1000+0 records out
   dd: closing output file `/root/tools/test.tst': No space left on device
   -rw-r--r--  1 root root 98304 Feb  8 20:30 /root/tools/test.tst
   1000+0 records in
   1000+0 records out
   dd: closing output file `/root/tools/test.tst': No space left on device
   -rw-r--r--  1 root root 98304 Feb  8 20:30 /root/tools/test.tst
   1000+0 records in
   1000+0 records out
   dd: closing output file `/root/tools/test.tst': No space left on device
   -rw-r--r--  1 root root 131072 Feb  8 20:30 /root/tools/test.tst
   1000+0 records in
   1000+0 records out
   dd: closing output file `/root/tools/test.tst': No space left on device
   -rw-r--r--  1 root root 163840 Feb  8 20:30 /root/tools/test.tst</pre>
<p><strong>&lt;similar thus snipped&gt;</strong></p>
<p><strong>I've so far found <a href="http://lwn.net/Articles/150580/">this</a>.</strong></p>
<p><strong>Which seems to indicate that RAID + LVM + complex storage and 4KSTACKS 
  can cause problems. However I can't find the 4KSTACK symbol anywhere in my config.</strong></p>
<p><strong>For those wondering.... no it's not out of space:</strong></p>
<pre class="code">  10.10.0.80:/data/tools 9.0T 204G 8.9T 3% / 
  root/tools</pre>
<p><strong>Any help would be much appreciated.......</strong></p>
<p>Forgot to mention: </p>
<p>There's nothing in syslog in either case (loopback mount or remote machine 
  mount or server)</p>
<p>We're using reiserfs 3 in case you're wondering. It's a raid-50 machine based 
  on two raid-50 arrays of 4,55 Tb handled by the hardware controller.</p>
<p>The two raid-50 arrays are &quot;glued&quot; together using LVM2:</p>
<pre class="code">--- Volume group ---
   VG Name               data-vg
   System ID
   Format                lvm2
   Metadata Areas        2
   Metadata Sequence No  2
   VG Access             read/write
   VG Status             resizable
   MAX LV                0
   Cur LV                1
   Open LV               1
   Max PV                0
   Cur PV                2
   Act PV                2
   VG Size               9.09 TB
   PE Size               4.00 MB
   Total PE              2384134
   Alloc PE / Size       2359296 / 9.00 TB
   Free  PE / Size       24838 / 97.02 GB
   VG UUID               dyDpX4-mnT5-hFS9-DX7P-jz63-KNli-iqNFTH

--- Physical volume ---
   PV Name               /dev/sda1
   VG Name               data-vg
   PV Size               4.55 TB / not usable 0
   Allocatable           yes (but full)
   PE Size (KByte)       4096
   Total PE              1192067
   Free PE               0
   Allocated PE          1192067
   PV UUID               rfOtx3-EIRR-iUx7-uCSl-h9kE-Sfgu-EJCHLR

   --- Physical volume ---
   PV Name               /dev/sdb1
   VG Name               data-vg
   PV Size               4.55 TB / not usable 0
   Allocatable           yes
   PE Size (KByte)       4096
   Total PE              1192067
   Free PE               24838
   Allocated PE          1167229
   PV UUID               5U0F3v-ZUag-pRcA-FHvo-OJeD-1q9g-IthGQg

--- Logical volume ---
   LV Name                /dev/data-vg/data-lv
   VG Name                data-vg
   LV UUID                0UUEX8-snHA-dYc8-0qLL-OSXP-kjoa-UyXtdI
   LV Write Access        read/write
   LV Status              available
   # open                 2
   LV Size                9.00 TB
   Current LE             2359296
   Segments               2
   Allocation             inherit
   Read ahead sectors     0
   Block device           253:3</pre>
[Kapil] - I haven't used NFS in such a massive context so this may not be the 
right question. 
<p>[[Ramon]] - Doesn't matter, I remember once explaining why I was still at work 
  and with what problem to the guy cleaning our office (because he asked). He 
  asked one question which put me on the right track solving the issue....in half 
  an hour after banging my head against it for two days ;-)</p>
<blockquote>
  <p>Not intending to compare you to a cleaner... sometimes it helps a lot if 
    you get questions from a different mindset.</p>
</blockquote>
<p>[Kapil] - Have you tested what happens with the user-space NFS daemon?</p>
<p>[[Ramon]] - Urhm, not clear what you mean.... Tested in what sense ?</p>
[[[Kapil] ]]] - Well. I noticed that you had compiled in the kernel NFS daemon. 
So I assumed that you were using the kernel NFS daemon rather than the user-space 
one. Does your problem persist when you use the user-space daemon? 
<p>[[[[Ramon]]]] - Thanx, no it doesn't.</p>
<p>[[[Kapil]]] - The reason I ask is that it may be the kernel NFS daemon that 
  is leading to too many indirections for the kernel stack to handle.</p>
<p>[[[[ Ramon]]]] - That appears to be the case. I'm writing a mail to lkml &amp; 
  nfs list right now to report on the bug.</p>
<p>[[[[[Ramon]]]]] - Turned out it did, but with a higher threshold. As soon as 
  we started testing with files &gt; 100Mb the same behaviour came up again.</p>
<blockquote>
  <p>It turned out to be another bug related to reiserfs.</p>
  <p>For those interested more data is <a href="http://sourceforge.net/mailarchive/forum.php?%20forum_id=4930&max_rows=25&style=flat&viewmonth=200511&viewday=1">here</a> 
    and <a href="http://marc.theaimsgroup.com/?l=reiserfs&m=112255940804474&w=2">here</a>.</p>
  <p>In short: Although reiserfs reports in its FAQ that it supports filesystems 
    up to 16Tb with the default options (4K blocks) it supports only 8Tb. It doesn't 
    fail however and appears to work correctly when using the local filesystem, 
    the problems start showing up when using NFS</p>
  <p>I fixed the problem by using another filesystem. Based on comments on the 
    nfs-ml and the excellent article in last months linuxgazette we switched to 
    jfs.<br />
    So far it's holding up very good. We haven't seen the problems reappearing 
    with files in excess of 1Gb</p>
  <p>Thanx for the help though.</p>
</blockquote>
  <!-- end 5 -->
  <!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     -->
<a NAME="mailbag.06"></a><hr WIDTH="75%" ALIGN="center">
<h3><img ALIGN=BOTTOM ALT="" SRC="../gx/envelope.gif"> <font COLOR="navy">Answer 
  Blog/Ad-hoc Wireless Network</font></h3>
<p>fahad saeed (fahadsaeed11 at yahoo.com )<br />
Thu Feb 9 20:22:37 PST 2006<br />
</p>
<p> <strong>Hello,<br />
  <br />
  I am an linux enthusiastic and I would like to be on the answer blog team. How 
  may this be possible. I have one linux article to my credit.<br />
  <br />
  <a href="http://new.linuxfocus.org/English/December2005/article390.html">http://new.linuxfocus.org/English/December2005/article390.html</a><br />
  <br />
  Regards<br />
  <br />
  FAHAD SAEED</strong></p>
<p>[Ben] - </p>
<blockquote> 
  <p>Hi, Saeed -</p>
  <p>Yep, I saw that - very good article and excellent work! Congratulations to 
    your entire team.</p>
  <p>You're welcome to join the Linux Gazette Answer Gang; simply go to <a href="http://lists.linuxgazette.net/mailman/listinfo/tag">http://lists.linuxgazette.net/mailman/listinfo/tag</a> 
    and sign up. As soon as you're approved, you can start participating.</p>
</blockquote>
<p>[Kapil] - </p>
<blockquote> 
  <p>Hello,</p>
  <p>On Fri, 10 Feb 2006, fahad saeed wrote:<br />
    &gt; &lt;html&gt;&lt;div style='background-color:'&gt;&lt;DIV class=RTE&gt;<br />
    &gt; &lt;P&gt;Thankyou all for the warm welcome.I will try to be of use.&lt;/P&gt;<br />
    &gt; &lt;P&gt;Kind Regards&lt;/P&gt;</p>
  <p>I somehow managed to read that but please don't send HTML mail!</p>
  <p>I started reading your article.</p>
  <p>Since I'm only learning the ropes with wireless could you send me some URL 
    indicating how the wireless Ad-Hoc network (the links) are set up? Just to 
    give you an idea of how clueless I am, I didn't get beyond &quot;iwconfig 
    wifi mode ad-hoc&quot;.</p>
  <p>Regards,</p>
  <p>Kapil.</p>
  <p>P.S. Its great to see such close neighbours here on TAG.</p>
</blockquote>
<p>[Kapil] - </p>
<blockquote> 
  <p>Dear Fahad Saeed,</p>
  <p>First of all you again sent HTML mail. You need to configure your webmail 
    account to send plain text mail or you will invite the wrath of Thomas and 
    Heather [<em>or Kat</em>] (who edit these mails for inclusion in LG) upon 
    you. This may just be a preference setting but do it right away!</p>
  <p>On Fri, 10 Feb 2006, fahad saeed wrote:<br />
    &gt; the command you entered is not very right i suppose.The cards are<br />
    &gt; usually configured( check it with ifconfig) as ath0 etc.The command<br />
    &gt; must be (assuming that the card configured is 'displayed' as ath0)<br />
    &gt; iwconfig ath0 mode ad-hoc.You can also do the same if u change the<br />
    &gt; entry in ifcfg-ath0 to ad-hoc.</p>
  <p>Actually, I just used the &quot;named-interface&quot; feature to call my 
    wireless interface &quot;wifi&quot;. So &quot;iwconfig wifi mode ad-hoc&quot; 
    is the same as &quot;iwconfig eth0 mode ad-hoc&quot; on my system.</p>
  <p>&gt; Hope this helps.I didnt get your question exactly.Please let me know<br />
    &gt; what exactly are you trying to do and looking so that i can be of<br />
    &gt; more specific help.</p>
  <p>My question was what one does after this. Specifically, is the IP address 
    of the interface configured statically via a command like ifconfig eth0 192.168.0.14 
    and if so what is the netmask setting?</p>
  <p>Just to be completely clear. I have not managed to get two laptops to communicate 
    with each other using ad-hoc mode. Both sides say the (wireless) link is up, 
    but I couldn't get them to send IP packets to each other. I have only managed 
    to get an IP link when there is a common access point (hub).</p>
  <p>The problem is that getting wireless cards to work with Linux has been such 
    a complicated issue in the past that most HOWTO's spend a lot of time in explaining 
    how to download and compile the relevant kernel modules and load firmware. 
    The authors are probably exhausted by the time they got to the details of 
    setting up networking :)</p>
</blockquote>
<p>[[Ben]] - That's something I'd really like to learn to do myself. I've thought about 
    it on occasion, and it always seemed like a doable thing - but I never got 
    any further than that, so a description of the actual setup would be a really 
    cool thing.</p>
<blockquote> 
  <p>When I read about those $100 laptops that Negroponte et al are cranking out, 
    I pictured a continent-wide wireless fabric of laptops stretching across, 
    say, Africa - with some sort of a clever NAT and bandwidth-metering setup 
    on each machine where any host within reach of an AP becomes a &quot;relay 
    station&quot; accessible to everyone on that WAN. Yeah, it would be dead slow 
    if there were only a few hosts within reach of APs... but the capabilities 
    of that kind of system would be awesome.</p>
  <p>I must say that, in this case, &quot;the Devil is not as bad as he's painted&quot;. 
    In my experience of wireless cards under Linux has consisted of</p>
  <p>1) Find the source on the Net and download it;<br />
    2) Unpack the archive in /usr/src/modules;<br />
    3) 'make; make install' the module and add it to the list in<br />
    &quot;/etc/modules&quot;.</p>
  <p>Oh, and run 'make; make install' every time you recompile the kernel. Not 
    what I'd call terribly difficult.</p>
</blockquote>
<p>[[[Martin]]] - When my Dad had a wireless card it wasn't that simple...</p>
<blockquote> 
  <p>It was a Netgear something or other USB - I don't think we ever got it work 
    in Linux in the end.</p>
  <p>Its not a problem now though as he is using Ethernet over Power and it's 
    working miles better in both Windows and Linux.</p>
</blockquote>
<p>[[[[Ben]]]] - Hmm, strange. Netgear and Intel are the only network hardware with which 
    I haven't had any problems - whatever the OS. Well, different folks, different 
    experiences...</p>

  
<p>[[[Saeed]]] - I would have to agree with Kapil here.Yes the configuration process 
  is sometimes extremely difficulty.As Benjamin potrayed it ...it seems pretty 
  easy and in theory it is. But when done practically it is not that straightforward. 
  The main problem is that the drivers available are for different chipsets.The 
  vendors do not care about the chipsets and change the chipsets without changing 
  the product ID. It happened in our case with WMP11 if I am remembering correctly.</p>
  
<blockquote>
  <p>Obviously once you get the correct sets of drivers, kernel and chipsets it 
    is straightforward.</p>
  <p>The lab setup that we did in UET LAHORE required the cards to work in ad-hoc 
    mode.We used madwifi drivers. Now as you may know that there is beacon problem 
    in the madwifi drivers and the ad-hoc mode itself does not work reliably.The 
    mode that we implemented was Ad-hoc mode Cluster Head Routing. In simple words 
    it meant that one of the PC's were configured to be in Master mode and there 
    were bunch of PCs around.It would have been really cool if we could get it 
    work in 'pure ad-hoc' mode nevertheless it served the LAB purposes.</p>
</blockquote>
<p>[[[Jason]]] - Huh. Weird. I've got an ad-hoc network set up with my PC and 
  my sister's laptop, and it &quot;just works&quot;. The network card in my PC 
  is a Netgear PCI MA311, with the &quot;Prism 2.5&quot; chipset. (&quot;orinoco_pci&quot; 
  is the name of the driver module.)</p>
<blockquote> 
  <pre class="code">   :r!lspci | grep -i prism
   0000:00:0e.0 Network controller: Intersil Corporation Prism 2.5 Wavelan chipset (rev 01)</pre>
  <p>The stanza in /etc/network/interfaces is:</p>
  <pre class="code">
    auto eth1
    iface eth1 inet static
    address 10.42.42.1
    netmask 255.255.255.0
    wireless-mode ad-hoc
    wireless-essid jason
    wireless-key XXXX-XXXX-XXXX-XXXX-XXXX-XXXX-XX</pre>
  <p>FWIW, the commands I was using to bring up the interface before I switched 
    to Debian were:</p>
  <pre class="code">   sbin/ifconfig eth1 10.42.42.1 netmask 255.255.255.0
   /usr/sbin/iwconfig eth1 mode Ad-Hoc
   /usr/sbin/iwconfig eth1 essid "jason"
   /usr/sbin/iwconfig eth1 key "XXXX-XXXX-XXXX-XXXX-XXXX-XXXX-XX"</pre>
  <p>I have dnsmasq providing DHCP and DNS. The laptop is running Windows 2000 
    with some off-brand PCMCIA wifi card.</p>
</blockquote>
<p>[[[[Kapil]]]] - I get it. While the link-layer can be setup in ad-hoc mode 
  by the the cards using some WEP/WPA mechanism, there has to be some other mechanism 
  to fix the IP addresses+netmasks. For example, one could use static IP addresses 
  of each of the machines as Fahad Saeed (or Jason) has done. Of course, in a 
  server-less network one doesn't want one machine running a DHCP server. Alles 
  ist klar.</p>
<blockquote> 
  <p>I will try this out the next time I have access to two laptops...</p>
</blockquote>
<p>[[Saeed]] - First of all I am sorry abt the html format thing.</p>
<blockquote> 
  <p> Dear Kapil what is your card's chipset type and what drivers you used to 
    configure them with linux.</p>
</blockquote>
<p>[[[Kapil]]] - The card is the Intel one and it works with the driver ipw2200 
  that is built into the default kernel along with the firmware from the Intel 
  site.</p>
<blockquote> 
  <p>In fact, I have had absolutely no complaints about getting the card to work 
    with wireless access stations with/without encryption and/or authentication. 
    But all these modes are &quot;Managed&quot; modes.</p>
  <p>I once tried to get the laptop to communicate with another laptop (a Mac) 
    in Ad-Hoc mode and was entirely unsuccessful. So when you said that you managed 
    to get an Ad-Hoc network configured for your Lab, I thought you had used the 
    cards in Ad-Hoc mode.</p>
  <p>However, from your previous mail it appears that you configured one card 
    in &quot;Master&quot; mode and the remaining cards in &quot;Managed&quot; 
    mode, so that is somehow different. In particular, I don't think the card 
    I have can be set up in &quot;Master&quot; mode at all.</p>
</blockquote>
<p>[[[[Saeed]]]] - You got it right; we did used the master mode type in the lab 
  for demonstration purposes because it was more reliable than the pure 'ad-hoc' 
  mode and it served the lab purposes.However we did use the ad-hoc mode in the 
  lab and it worked fine but wasn't reliable enough for lab purposes ...which 
  has to work reliably at all times.</p>


  <!-- end 6 -->
  <!--     .~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.~~.     --><hr>
<center><font face="Helvetica"><strong>
This page edited and maintained by the Editors of <i>Linux Gazette</i>
  </strong></font> 
</center>
<hr>

</p>

<p class="talkback">
Talkback: <a
href="mailto:tag@lists.linuxgazette.net?subject=Talkback:127/lg_mail.html">Discuss this article with The Answer Gang</a>
</p>

<!-- *** BEGIN author bio *** -->
<hr>
<p>
<img align="left" alt="[BIO]" src="../gx/authors/tanaka-okopnik.jpg" class="bio">
</p>

<em>
<p>
Kat likes to tell people she's one of the youngest people to have learned
to program using punchcards on a mainframe (back in '83); but the truth is
that since then, despite many hours in front of various computer screens,
she's a computer user rather than a computer programmer.
</p>

<p>
When away from the keyboard, her hands have been found full of knitting
needles, various pens, henna, red-hot welding tools, upholsterer's shears,
and a pneumatic scaler.
</p>
</em>

<br clear="all">


<!-- *** END author bio *** -->

<div id="articlefooter">

<p>
Copyright &copy; 2006, Kat Tanaka Okopnik. Released under the <a
href="http://linuxgazette.net/copying.html">Open Publication license</a>
unless otherwise noted in the body of the article. Linux Gazette is not
produced, sponsored, or endorsed by its prior host, SSC, Inc.
</p>

<p>
Published in Issue 127 of Linux Gazette, June 2006
</p>

</div>


<div id="previousnextbottom">
<A HREF="lg_talkback.html" >&lt;-- prev</A> | <A HREF="lg_mail2.html" >next --&gt;</A>
</div>


</div>






<div id="navigation">

<a href="../index.html">Home</a>
<a href="../faq/index.html">FAQ</a>
<a href="../lg_index.html">Site Map</a>
<a href="../mirrors.html">Mirrors</a>
<a href="../mirrors.html">Translations</a>
<a href="../search.html">Search</a>
<a href="../archives.html">Archives</a>
<a href="../authors/index.html">Authors</a>
<a href="../contact.html">Contact Us</a>

</div>



<div id="breadcrumbs">

<a href="../index.html">Home</a> &gt; 
<a href="index.html">June 2006 (#127)</a> &gt; 
Article

</div>





<img src="../gx/tux_86x95_indexed.png" id="tux" alt="Tux"/>




</body>
</html>

