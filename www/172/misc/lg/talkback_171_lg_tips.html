<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
		 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' lang='utf-8' xml:lang='utf-8'>
<head>
<title>Talkback:171/lg_tips.html</title>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
<link rel='stylesheet' type='text/css' href='../../../lg.css' />
</head>
<body>
<a href="../../../"><img alt="Linux Gazette" src="../../../gx/2003/newlogo-blank-200-gold2.jpg" id="logo" /></a><img alt="Tux" src="../../../gx/tux_86x95_indexed.png" id="tux" /><p id="fun">...making Linux just a little more fun!</p><div class='content articlecontent'><a name="top"></a><h3>Talkback:171/lg_tips.html</h3>
<p><b>[ In reference to "<a href='../../../171/lg_tips.html'>2-Cent Tips</a>" in LG#171 ]</b></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Sun, 31 Jan 2010 12:37:42 -0500</b>
</p>

<p>
On Sun, Jan 31, 2010 at 01:15:02PM +0000, Thomas Adam wrote:
</p>

<pre>
&gt; On Sun, Jan 31, 2010 at 04:39:55PM +0700, Mulyadi Santosa wrote:
&gt; &gt; Most CLI aficionados use this kind of construct when executing a
&gt; &gt; command over "find" results:
&gt; &gt; 
&gt; &gt; $ find ~ -type f -exec du -k {} \;
&gt; &gt; 
&gt; &gt; Nothing is wrong with that, except that "du" is repeatedly called with
&gt; &gt; single argument (that is the absolute path and the file name itself).
&gt; &gt; Fortunately, there is a way to cut down the number of execution:
&gt; &gt; 
&gt; &gt; $ find ~ -type f -exec du -k {} +
&gt; 
&gt; <a href='../../../111/tag/3.html'>http://linuxgazette.net/111/tag/3.html</a>
</pre>

<p>
What would be wrong with just using 'du -sk ~'?
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Mulyadi Santosa [mulyadi.santosa at gmail.com]

</p>
</b><br />
<b>Mon, 1 Feb 2010 09:27:01 +0700</b>
</p>

<p>
Hi Ben <img src="../gx/smile.png" alt=":)">
</p>

<p>
On Mon, Feb 1, 2010 at 12:37 AM, Ben Okopnik &lt;ben@linuxgazette.net&gt; wrote:
</p>

<pre>
&gt; What would be wrong with just using 'du -sk ~'?
</pre>

<p>
The above command would show the total size of current user's home
directory, while "find ~ -type f -exec du -k {} +" will show the size
of each file inside current user's home directory.
</p>


<pre>-- 
regards,
</pre>Freelance Linux trainer and consultant
</p>

<p>
blog: the-hydra.blogspot.com
training: mulyaditraining.blogspot.com
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Sun, 31 Jan 2010 21:49:23 -0500</b>
</p>

<p>
On Mon, Feb 01, 2010 at 09:27:01AM +0700, Mulyadi Santosa wrote:
</p>

<pre>
&gt; Hi Ben <img src="../gx/smile.png" alt=":)">
&gt; 
&gt; On Mon, Feb 1, 2010 at 12:37 AM, Ben Okopnik &lt;ben@linuxgazette.net&gt; wrote:
&gt; &gt; What would be wrong with just using 'du -sk ~'?
&gt; 
&gt; The above command would show the total size of current user's home
&gt; directory, while "find ~ -type f -exec du -k {} +" will show the size
&gt; of each file inside current user's home directory.
</pre>

<p>
You're right - I missed that. What is the point of using 'du -k' at all,
if all you're trying to do is get the size of the file? Seems to me
that 'find ~ -type f -ls' or maybe 'find ~ -type f -printf "%k\t%f\n"'
would do everything you need.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Neil Youngman [ny at youngman.org.uk]

</p>
</b><br />
<b>Mon, 1 Feb 2010 08:59:12 +0000</b>
</p>

<p>
On Monday 01 February 2010 02:49:23 Ben Okopnik wrote:
</p>

<pre>
&gt; You're right - I missed that. What is the point of using 'du -k' at all,
&gt; if all you're trying to do is get the size of the file? Seems to me
&gt; that 'find ~ -type f -ls' or maybe 'find ~ -type f -printf "%k\t%f\n"'
&gt; would do everything you need.
</pre>

<p>
Well du -k and find -ls will usually give completely numbers, e.g.
</p>

<p>
$ echo &gt; /tmp/junk.txt
 $ find /tmp -iname junk.txt -ls
981301    4 -rw-r--r--   1 neil     neil            1 Feb  1 
08:02 /tmp/junk.txt
$ du -k /tmp/junk.txt 
4       /tmp/junk.txt
neil ~ 08:02:45 505 $ 
</p>

<p>
In the above example "find -ls" shows that /tmp/junk.txt is a 1 byte file. On 
the other hand "du -k" reports that it's disk usage is 4kB. Both are correct, 
because they are measuring different things. If you want to know how much 
data is in your files, you need "ls -l" or equivalent. If you want to know 
how much disk space is taken up, you need "du". 
</p>

<p>
Experienced users will be aware that a file consists of a series of blocks and 
a whole block is allocated whenever there is insufficient space allocated for 
data written to the file. As a result, a whole block will be allocated on 
disk for a 1 byte file and as a block on my filesystem is 4kB that means that 
a single file uses up 4kB of disk space, as reported b "du -k", although it 
only contains 1 byte of data, as shown by "find -ls".
</p>

<p>
Neil
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Neil Youngman [ny at youngman.org.uk]

</p>
</b><br />
<b>Mon, 1 Feb 2010 09:08:01 +0000</b>
</p>

<p>
On Monday 01 February 2010 08:59:12 Neil Youngman wrote:
</p>

<pre>
&gt; Well du -k and find -ls will usually give completely numbers, e.g.
</pre>

<p>
That should read "completely different numbers".
</p>

<p>
Neil
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Mulyadi Santosa [mulyadi.santosa at gmail.com]

</p>
</b><br />
<b>Mon, 1 Feb 2010 19:18:32 +0700</b>
</p>

<p>
On Mon, Feb 1, 2010 at 4:08 PM, Neil Youngman &lt;ny@youngman.org.uk&gt; wrote:
</p>

<pre>
&gt; On Monday 01 February 2010 08:59:12 Neil Youngman wrote:
&gt;&gt; Well du -k and find -ls will usually give completely numbers, e.g.
&gt;
&gt; That should read "completely different numbers".
</pre>

<p>
Thanks a lot Neil.....you are faster than me on explaining that <img src="../gx/smile.png" alt=":)">
</p>

<pre>-- 
regards,
</pre>Freelance Linux trainer and consultant
</p>

<p>
blog: the-hydra.blogspot.com
training: mulyaditraining.blogspot.com
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Mon, 1 Feb 2010 11:04:27 -0500</b>
</p>

<p>
On Mon, Feb 01, 2010 at 08:59:12AM +0000, Neil Youngman wrote:
</p>

<pre>
&gt; On Monday 01 February 2010 02:49:23 Ben Okopnik wrote:
&gt; &gt; You're right - I missed that. What is the point of using 'du -k' at all,
&gt; &gt; if all you're trying to do is get the size of the file? Seems to me
&gt; &gt; that 'find ~ -type f -ls' or maybe 'find ~ -type f -printf "%k\t%f\n"'
&gt; &gt; would do everything you need.
&gt; 
&gt; Well du -k and find -ls will usually give completely numbers, e.g.
</pre>

<p>
I'm quite aware of that. That's why I gave the second solution - just in
case Mulyadi wanted the number of blocks instead of the filesize.
 
</p>

<pre>
&gt; Experienced users will be aware that a file consists of a series of blocks and 
&gt; a whole block is allocated whenever there is insufficient space allocated for 
&gt; data written to the file. As a result, a whole block will be allocated on 
&gt; disk for a 1 byte file and as a block on my filesystem is 4kB that means that 
&gt; a single file uses up 4kB of disk space, as reported b "du -k", although it 
&gt; only contains 1 byte of data, as shown by "find -ls".
</pre>

<p>
Please watch carefully; the special effects are quite expensive. <img src="../gx/smile.png" alt=":)">
</p>

<p>
<pre class='code'>
ben@Jotunheim:~$ mkdir /tmp/foo; echo &gt; /tmp/foo/x
ben@Jotunheim:~$ du -k /tmp/foo/x
4	/tmp/foo/x
ben@Jotunheim:~$ find /tmp/foo -name x -printf "%k\t%h/%f\n"
4	/tmp/foo/x
</pre>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Mon, 1 Feb 2010 11:15:12 -0500</b>
</p>

<p>
On Mon, Feb 01, 2010 at 11:04:27AM -0500, Benjamin Okopnik wrote:
</p>

<pre>
&gt; 
&gt; Please watch carefully; the special effects are quite expensive. <img src="../gx/smile.png" alt=":)">
&gt; 
&gt; ```
&gt; ben@Jotunheim:~$ mkdir /tmp/foo; echo &gt; /tmp/foo/x
&gt; ben@Jotunheim:~$ du -k /tmp/foo/x
&gt; 4	/tmp/foo/x
&gt; ben@Jotunheim:~$ find /tmp/foo -name x -printf "%k\t%h/%f\n"
&gt; 4	/tmp/foo/x
&gt; '''
</pre>

<p>
Oh, and - as a double-check:
</p>

<p>
<pre class='code'>
ben@Jotunheim:~$ find ~/tmp -type f -printf "%k\n"|awk '{a+=$1}END{print a}'
3460256
ben@Jotunheim:~$ find ~/tmp -type f -exec du -k {} +|awk '{a+=$1}END{print a}'
3460256
</pre>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Neil Youngman [ny at youngman.org.uk]

</p>
</b><br />
<b>Mon, 1 Feb 2010 16:18:57 +0000</b>
</p>

<p>
On Monday 01 February 2010 16:04:27 Ben Okopnik wrote:
</p>

<pre>
&gt; &gt; Well du -k and find -ls will usually give completely numbers, e.g.
&gt;
&gt; I'm quite aware of that. That's why I gave the second solution - just in
&gt; case Mulyadi wanted the number of blocks instead of the filesize.
</pre>

<p>
Yeah, I would have been surprised if you didn't know the difference, but I 
wouldn't say that your choice of words made it at all obvious for the casual 
reader. Hopefully I added a little clarity for our less experienced readers, 
if it gets into the Gazette.
</p>

<p>
I agree that I should have taken a closer look at your second option and 
acknowledged that it was a "simpler" way of getting the same result 
as "du -k".
</p>

<p>
Neil
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Mon, 1 Feb 2010 11:40:39 -0500</b>
</p>

<p>
On Mon, Feb 01, 2010 at 04:18:57PM +0000, Neil Youngman wrote:
</p>

<pre>
&gt; On Monday 01 February 2010 16:04:27 Ben Okopnik wrote:
&gt; &gt; &gt; Well du -k and find -ls will usually give completely numbers, e.g.
&gt; &gt;
&gt; &gt; I'm quite aware of that. That's why I gave the second solution - just in
&gt; &gt; case Mulyadi wanted the number of blocks instead of the filesize.
&gt; 
&gt; Yeah, I would have been surprised if you didn't know the difference, but I 
&gt; wouldn't say that your choice of words made it at all obvious for the casual 
&gt; reader.
</pre>

<p>
You might be right. Thanks for clarifying it!
</p>

<p>
I guess we're following the best of USENET tradition by doing it this
way: the best way to get a question answered there was always to make an
emphatic statement rather than asking. That way, you'd immediately get
several hundred opinions, in detail. You'd have to filter for flamage,
though. <img src="../gx/smile.png" alt=":)">
</p>


<pre>
&gt; Hopefully I added a little clarity for our less experienced readers, 
&gt; if it gets into the Gazette.
</pre>

<p>
Neil, other than filtering for flamage and spam, everything on this list
is grist for the LG mill. We've got a bunch of smart, focused people,
some of whom have been here for years, and most of what's said here
definitely deserves to be preserved as a community resource. You're a
big part of that.
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Mulyadi Santosa [mulyadi.santosa at gmail.com]

</p>
</b><br />
<b>Tue, 2 Feb 2010 01:13:17 +0700</b>
</p>

<p>
On Mon, Feb 1, 2010 at 11:18 PM, Neil Youngman &lt;ny@youngman.org.uk&gt; wrote:
</p>

<pre>
&gt; I agree that I should have taken a closer look at your second option and
&gt; acknowledged that it was a "simpler" way of getting the same result
&gt; as "du -k".
</pre>

<p>
Thanks for sharing the thoughts, Ben. Yes, personally I think your
solution is better than mine.
</p>

<pre>-- 
regards,
</pre>Freelance Linux trainer and consultant
</p>

<p>
blog: the-hydra.blogspot.com
training: mulyaditraining.blogspot.com
</p>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p><p>
<b><p>
Ben Okopnik [ben at linuxgazette.net]

</p>
</b><br />
<b>Mon, 1 Feb 2010 14:11:59 -0500</b>
</p>

<p>
On Tue, Feb 02, 2010 at 01:13:17AM +0700, Mulyadi Santosa wrote:
</p>

<pre>
&gt; On Mon, Feb 1, 2010 at 11:18 PM, Neil Youngman &lt;ny@youngman.org.uk&gt; wrote:
&gt; &gt; I agree that I should have taken a closer look at your second option and
&gt; &gt; acknowledged that it was a "simpler" way of getting the same result
&gt; &gt; as "du -k".
&gt; 
&gt; Thanks for sharing the thoughts, Ben. Yes, personally I think your
&gt; solution is better than mine.
</pre>

<p>
I didn't think that there was a contest in progress. <img src="../gx/smile.png" alt=":)"> Instead, as
often happens in TAG, several people suggest solutions and you (and
everyone else, which is the point) get to pick whatever is most
applicable to their situation. I'm glad I could help, though.
</p>

<p>
In addition, that '{} +' trick is one that I'd managed to miss in
'find'. Thanks for the great tip!
</p>


<pre>-- 
* Ben Okopnik * Editor-in-Chief, Linux Gazette * <a href='http://LinuxGazette.NET'>http://LinuxGazette.NET</a> *
</pre>

<p>

</p>
<br /><a href="#top">Top</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="../../lg_talkback.html#mb-talkback_171_lg_tips">Back</a><hr width="50%" align="left" /><p><br /></p></div>
</body>
</html>